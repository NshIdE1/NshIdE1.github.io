<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>HitCTF2025-ReverseÂ·VM | NshIdE&#39;s Home</title>
  <meta name="keywords" content=" CTF , RE , WritesUp , vm ">
  <meta name="description" content="HitCTF2025-ReverseÂ·VM | NshIdE&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="categories">
<meta property="og:url" content="https://nshide1.github.io/categories/">
<meta property="og:site_name" content="NshIdE&#39;s Home">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-03-04T12:19:41.475Z">
<meta property="article:modified_time" content="2025-03-04T12:19:41.475Z">
<meta property="article:author" content="NshIdE">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/logo.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/logo.jpg"/>
</a>
<div class="author">
    <span>NshIdE</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/NshIdE1/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://www.csdn.net/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=1621925986&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(42)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="å…¶ä»–">
            
            å…¶ä»–
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Android-RE">
            
            Android-RE
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Androidå­¦ä¹ ">
            
            Androidå­¦ä¹ 
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Angrå…¥é—¨">
            
            Angrå…¥é—¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="CTF">
            
            CTF
            <small>(16)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Fridaå…¥é—¨">
            
            Fridaå…¥é—¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Javaå­¦ä¹ ">
            
            Javaå­¦ä¹ 
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Unidbgå­¦ä¹ ">
            
            Unidbgå­¦ä¹ 
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="42">
<input type="hidden" id="yelog_site_word_count" value="231.8k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://bananashipsbbq.github.io/">bananaships</a></li>
            
            <li><a target="_blank" href="https://astralprisma.github.io/">AstralPrisma</a></li>
            
            <li><a target="_blank" href="https://monoceros406.github.io/">Monoceros406</a></li>
            
            <li><a target="_blank" href="https://github.com/Thir0th">Thir0th</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æŠ½è±¡</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ç¬¦å·æ‰§è¡Œ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å–è¯</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å®æˆ˜</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åº”æ€¥å“åº”</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Frida</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>go</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Harmony</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>il2Cpps</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>iOS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ISW</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SIMD</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unidbg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unity</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>WritesUp</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All CTF "
           href="/2026/01/04/HitCTF2025-Reverse%C2%B7VM/"
           data-tag="CTF,RE,WritesUp,vm"
           data-author="" >
            <span class="post-title" title="HitCTF2025-ReverseÂ·VM">HitCTF2025-ReverseÂ·VM</span>
            <span class="post-date" title="2026-01-04 16:19:02">2026/01/04</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/11/03/%E6%9F%90%E9%BB%91%E7%9B%92%20App%20%E7%99%BB%E5%BD%95%E5%8F%82%E6%95%B0%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"
           data-tag="Android,å®æˆ˜"
           data-author="" >
            <span class="post-title" title="æŸé»‘ç›’ App ç™»å½•å‚æ•°é€†å‘åˆ†æ">æŸé»‘ç›’ App ç™»å½•å‚æ•°é€†å‘åˆ†æ</span>
            <span class="post-date" title="2025-11-03 16:15:21">2025/11/03</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/10/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%BC%BA%E7%BD%91%C2%B7%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android,il2Cpps"
           data-author="" >
            <span class="post-title" title="ç¬¬å…«å±Šå¼ºç½‘Â·æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›">ç¬¬å…«å±Šå¼ºç½‘Â·æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›</span>
            <span class="post-date" title="2025-10-25 17:31:37">2025/10/25</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/10/22/Android%20APP%20%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android APP å¸¸è§æ¼æ´">Android APP å¸¸è§æ¼æ´</span>
            <span class="post-date" title="2025-10-22 17:06:07">2025/10/22</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/10/10/%E4%BB%8E%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20PackageInfo%20%E5%92%8C%20LoadedApk/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="ä»æºç åˆ†æ PackageInfo å’Œ LoadedApk">ä»æºç åˆ†æ PackageInfo å’Œ LoadedApk</span>
            <span class="post-date" title="2025-10-10 18:15:17">2025/10/10</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/09/09/2025%E5%B9%B4%E6%B9%BE%E5%8C%BA%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%88%9D%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025å¹´æ¹¾åŒºæ¯ç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›">2025å¹´æ¹¾åŒºæ¯ç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›</span>
            <span class="post-date" title="2025-09-09 09:34:17">2025/09/09</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/09/08/Android%20SO%20%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android SO æ–‡ä»¶åŠ è½½è¿‡ç¨‹">Android SO æ–‡ä»¶åŠ è½½è¿‡ç¨‹</span>
            <span class="post-date" title="2025-09-08 17:18:50">2025/09/08</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/25/Dex%20%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Dex æ–‡ä»¶ç»“æ„å­¦ä¹ ">Dex æ–‡ä»¶ç»“æ„å­¦ä¹ </span>
            <span class="post-date" title="2025-08-25 17:33:29">2025/08/25</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/ClassLoader%20%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="ClassLoader æœºåˆ¶">ClassLoader æœºåˆ¶</span>
            <span class="post-date" title="2025-08-19 17:42:51">2025/08/19</span>
        </a>
        
        
        <a  class="All Javaå­¦ä¹  "
           href="/2025/08/19/Java%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="Javaå­¦ä¹ ----åå°„æœºåˆ¶">Javaå­¦ä¹ ----åå°„æœºåˆ¶</span>
            <span class="post-date" title="2025-08-19 17:00:02">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/Android%20%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android åº”ç”¨å¯åŠ¨æµç¨‹">Android åº”ç”¨å¯åŠ¨æµç¨‹</span>
            <span class="post-date" title="2025-08-19 11:14:13">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/%E5%AE%89%E5%8D%93%E5%8A%A0%E5%9B%BA%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="å®‰å“åŠ å›ºå­¦ä¹ è®°å½•">å®‰å“åŠ å›ºå­¦ä¹ è®°å½•</span>
            <span class="post-date" title="2025-08-19 10:50:46">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/14/Android%20%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94NDK%20%E5%BC%80%E5%8F%91/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android å¼€å‘--NDK å¼€å‘">Android å¼€å‘--NDK å¼€å‘</span>
            <span class="post-date" title="2025-08-14 17:56:58">2025/08/14</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/08/10/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%85%AD)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å…­)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å…­)</span>
            <span class="post-date" title="2025-08-10 10:25:02">2025/08/10</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/08/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%94)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äº”)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äº”)</span>
            <span class="post-date" title="2025-08-08 17:45:59">2025/08/08</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/05/%E6%BC%AB%E8%B0%88%E5%94%AF%E4%B8%80%E8%AE%BE%E5%A4%87ID/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="æ¼«è°ˆå”¯ä¸€è®¾å¤‡ ID">æ¼«è°ˆå”¯ä¸€è®¾å¤‡ ID</span>
            <span class="post-date" title="2025-08-05 18:00:44">2025/08/05</span>
        </a>
        
        
        <a  class="All å…¶ä»– "
           href="/2025/07/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20Linux%20%E7%B3%BB%E7%BB%9F%E4%B8%8B%20proc%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"
           data-tag="Android,Linux"
           data-author="" >
            <span class="post-title" title="æµ…è°ˆ Linux ç³»ç»Ÿä¸‹ proc æ–‡ä»¶ç³»ç»Ÿå†…å®¹">æµ…è°ˆ Linux ç³»ç»Ÿä¸‹ proc æ–‡ä»¶ç³»ç»Ÿå†…å®¹</span>
            <span class="post-date" title="2025-07-24 17:56:57">2025/07/24</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/24/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%BA%8C%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(äºŒ)">Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(äºŒ)</span>
            <span class="post-date" title="2025-07-24 17:00:12">2025/07/24</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/07/23/2025%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B-%E5%88%9D%E8%B5%9B-%E5%AE%89%E5%8D%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E5%85%A8/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025ç¬¬åå±Šæ¸¸æˆå®‰å…¨ç«èµ›-åˆèµ›-å®‰å“å®¢æˆ·ç«¯å®‰å…¨">2025ç¬¬åå±Šæ¸¸æˆå®‰å…¨ç«èµ›-åˆèµ›-å®‰å“å®¢æˆ·ç«¯å®‰å…¨</span>
            <span class="post-date" title="2025-07-23 15:32:11">2025/07/23</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/19/%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%92%8C%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—">åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—</span>
            <span class="post-date" title="2025-07-19 15:14:29">2025/07/19</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/15/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%B8%80%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(ä¸€)">Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(ä¸€)</span>
            <span class="post-date" title="2025-07-15 16:52:06">2025/07/15</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%9B%9B)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å››)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å››)</span>
            <span class="post-date" title="2025-07-08 11:44:49">2025/07/08</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/01/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%89)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)</span>
            <span class="post-date" title="2025-07-01 15:29:42">2025/07/01</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/06/07/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmonyCTF/"
           data-tag="CTF,RE,WritesUp,Harmony"
           data-author="" >
            <span class="post-title" title="ç¬¬ä¸€å±ŠOpenHarmonyCTF">ç¬¬ä¸€å±ŠOpenHarmonyCTF</span>
            <span class="post-date" title="2025-06-07 13:32:45">2025/06/07</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/06/04/%E8%A1%A5%E5%BA%93%E5%87%BD%E6%95%B0%EF%BC%88%E4%BA%94%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="è¡¥åº“å‡½æ•°(äº”)">è¡¥åº“å‡½æ•°(äº”)</span>
            <span class="post-date" title="2025-06-04 19:07:56">2025/06/04</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/06/02/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%8C)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äºŒ)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äºŒ)</span>
            <span class="post-date" title="2025-06-02 15:33:15">2025/06/02</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/31/D%5E3CTF2025/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="D^3CTF2025">D^3CTF2025</span>
            <span class="post-date" title="2025-05-31 16:21:11">2025/05/31</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/05/28/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%80)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸€)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸€)</span>
            <span class="post-date" title="2025-05-28 16:39:23">2025/05/28</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/17/Parloo2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="Parloo RE">Parloo RE</span>
            <span class="post-date" title="2025-05-17 09:34:20">2025/05/17</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/05/07/%E8%AE%B0%E4%B8%80%E6%AC%A1APK%E5%88%86%E6%9E%90/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="è®°ä¸€æ¬¡APKåˆ†æ">è®°ä¸€æ¬¡APKåˆ†æ</span>
            <span class="post-date" title="2025-05-07 21:12:00">2025/05/07</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/26/%E4%B8%80%E9%81%93%E5%BE%88%E9%80%86%E5%A4%A9%E7%9A%84RC4/"
           data-tag="CTF,RE,WritesUp,æŠ½è±¡"
           data-author="" >
            <span class="post-title" title="æŠ½è±¡RC4">æŠ½è±¡RC4</span>
            <span class="post-date" title="2025-04-26 22:21:19">2025/04/26</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/24/%E5%BE%88%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜">å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜</span>
            <span class="post-date" title="2025-04-24 21:56:18">2025/04/24</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/23/%E4%BA%AC%E9%BA%92CTF2025%20%E7%83%AD%E8%BA%AB%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,iOS,SIMD"
           data-author="" >
            <span class="post-title" title="äº¬éº’CTF2025çƒ­èº«èµ›">äº¬éº’CTF2025çƒ­èº«èµ›</span>
            <span class="post-date" title="2025-04-23 13:33:59">2025/04/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/14/TGCTF2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TGCTF2025 RE">TGCTF2025 RE</span>
            <span class="post-date" title="2025-04-14 18:51:29">2025/04/14</span>
        </a>
        
        
        <a  class="All Angrå…¥é—¨ "
           href="/2025/04/14/Angr%E5%85%A5%E9%97%A8/"
           data-tag="ç¬¦å·æ‰§è¡Œ"
           data-author="" >
            <span class="post-title" title="Angrå…¥é—¨">Angrå…¥é—¨</span>
            <span class="post-date" title="2025-04-14 18:50:44">2025/04/14</span>
        </a>
        
        
        <a  class="All Fridaå…¥é—¨ "
           href="/2025/04/14/Frida%E5%85%A5%E9%97%A8/"
           data-tag="Android,Frida"
           data-author="" >
            <span class="post-title" title="Fridaå…¥é—¨">Fridaå…¥é—¨</span>
            <span class="post-date" title="2025-04-14 18:47:37">2025/04/14</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/12/TEXSAWCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TEXSAWCTF 2025">TEXSAWCTF 2025</span>
            <span class="post-date" title="2025-04-12 15:32:31">2025/04/12</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/23/NCTF2024/"
           data-tag="CTF,RE,WritesUp,vm,go"
           data-author="" >
            <span class="post-title" title="NCTF2024">NCTF2024</span>
            <span class="post-date" title="2025-03-23 11:58:53">2025/03/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/18/CISCN%20x%20CCB%20%E5%8D%8A%E5%86%B3%E8%B5%9B%202025%20ISW(%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94)/"
           data-tag="ISW,åº”æ€¥å“åº”,å–è¯"
           data-author="" >
            <span class="post-title" title="CISCN x CCB åŠå†³èµ› 2025 ISW(åº”æ€¥å“åº”)">CISCN x CCB åŠå†³èµ› 2025 ISW(åº”æ€¥å“åº”)</span>
            <span class="post-date" title="2025-03-18 10:24:23">2025/03/18</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/11/TPCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TPCTF 2025">TPCTF 2025</span>
            <span class="post-date" title="2025-03-11 21:41:19">2025/03/11</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/06/VishwaCTF2025/"
           data-tag="CTF,RE,WritesUp,Android,Unity"
           data-author="" >
            <span class="post-title" title="VishwaCTF2025">VishwaCTF2025</span>
            <span class="post-date" title="2025-03-06 21:52:51">2025/03/06</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/03/HGAME%20RE/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="HGAME-RE-WEEK1">HGAME-RE-WEEK1</span>
            <span class="post-date" title="2025-03-03 22:20:33">2025/03/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-HitCTF2025-ReverseÂ·VM" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">HitCTF2025-ReverseÂ·VM</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="CTF">CTF</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color4">CTF</a>
            
            <a class="color3">RE</a>
            
            <a class="color4">WritesUp</a>
            
            <a class="color3">vm</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2026-01-04 16:18:39'>2026-01-04 16:19</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:5.6k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HitCTF2025-Reverse%C2%B7VM"><span class="toc-text">HitCTF2025-ReverseÂ·VM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-text">ä¸€ã€å‰è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%BC%80%E5%A7%8B"><span class="toc-text">äºŒã€å¼€å§‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyVM"><span class="toc-text">easyVM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComplexVM"><span class="toc-text">ComplexVM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%BB%93%E8%AF%AD"><span class="toc-text">ä¸‰ã€ç»“è¯­</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="HitCTF2025-ReverseÂ·VM"><a href="#HitCTF2025-ReverseÂ·VM" class="headerlink" title="HitCTF2025-ReverseÂ·VM"></a>HitCTF2025-ReverseÂ·VM</h1><h3 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h3><p>â€‹	è¯´æ¥ä¹Ÿæ˜¯æç¬‘ï¼Œä»æ¥è§¦ REVERSE ä»¥æ¥ï¼Œå¹¶æ²¡æœ‰å¥½å¥½å»å­¦ä¹ æˆ–è€…å¤ç°è¿‡ vm é€†å‘ï¼Œæ¯æ¬¡æ‰“æ¯”èµ›é‡åˆ°äº†éƒ½é€‰æ‹©ç›´æ¥ rmâ€¦</p>
<p>â€‹	æ˜¨å¤©åˆšå¥½çœ‹åˆ° HitCTF2025 æœ‰ä¸¤é“ vm é€†å‘ï¼Œé‚å­¦ä¹ è®°å½•ä¸€ä¸‹ã€‚</p>
<h3 id="äºŒã€å¼€å§‹"><a href="#äºŒã€å¼€å§‹" class="headerlink" title="äºŒã€å¼€å§‹"></a>äºŒã€å¼€å§‹</h3><h3 id="easyVM"><a href="#easyVM" class="headerlink" title="easyVM"></a>easyVM</h3><p>â€‹	é™„ä»¶ä¸­æ˜¯ä¸€ä¸ª .exe æ–‡ä»¶ï¼Œida æ‰“å¼€ä¹‹åï¼Œmain å‡½æ•°ç¬¬ä¸€è¡Œå°±æ˜¯è¾“å‡ºï¼Œç„¶åå¯ä»¥çœ‹åˆ° <strong>sub_7FF779ED1270</strong> å‡½æ•°è¢«è°ƒç”¨ä¸¤æ¬¡ï¼Œä¸”åˆ†åˆ«ä¼ å…¥ä¸åŒçš„ä¸Šä¸‹æ–‡ç»“æ„ä½“ï¼Œé‚£ä¹ˆåŸºæœ¬å¯ä»¥ç¡®å®š sub_7FF779ED1270 å‡½æ•°å°±æ˜¯æ ¸å¿ƒå‡½æ•°ï¼Œå³ VM Engineï¼Œè·Ÿè¿› sub_7FF779ED1270 å‡½æ•°è¿›è¡Œåˆ†æã€‚</p>
<p>â€‹	å…¶ä¸­å°±æ˜¯ä¸€ä¸ª switch-case ç»“æ„ï¼Œæ ¹æ®åˆ†æå¯å¾—åˆ°å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>é¦–å…ˆçœ‹åˆ°<code>*(a1 + 1060)</code> è¢«é¢‘ç¹è¯»&#x2F;å†™ï¼Œè€Œä¸”æ¯æ¬¡å– opcode åéƒ½ <code>+1</code>ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç¡®å®šè¿™æ˜¯ æŒ‡ä»¤æŒ‡é’ˆï¼ˆIPï¼‰ï¼›</p>
</li>
<li><p>ç„¶åæ˜¯<code>*(a1 + 1072)</code>ï¼Œå‚ä¸<code>*(ip + base)</code>ï¼Œå¯ç¡®å®šæ˜¯å­—èŠ‚ç åŸºå€ï¼›</p>
</li>
<li><p><code>*(a1 + 1080)</code>ï¼šæ‹¿æ¥è·Ÿ IP æ¯”è¾ƒï¼Œè¯´æ˜å…¶æ˜¯ code_end&#x2F;code_lenï¼›</p>
</li>
<li><p><code>*(a1 + 4*i)</code>ï¼ši çš„èŒƒå›´æ£€æŸ¥æ˜¯ <code>&lt;8</code>ï¼Œå¯ç¡®å®šæœ‰å…«ä¸ªå¯„å­˜å™¨ï¼Œä¸”æ¯ä¸ªä¸ºå››å­—èŠ‚ï¼›</p>
</li>
<li><p>åœ¨ case16 ä¸­å¯ä»¥çœ‹åˆ° a1 + 1084 è¢« fgets å†™å…¥ï¼Œå¯ç¡®å®šå…¶æ˜¯ è¾“å…¥ç¼“å†²ï¼›</p>
</li>
<li><p>åœ¨ case17 ä¸­å¯ä»¥çœ‹åˆ° a1 + 1134 è¢« printf è¾“å‡ºï¼Œå¯ç¡®å®šå…¶æ˜¯ è¾“å‡ºç¼“å†²ï¼›</p>
</li>
<li><p>åœ¨ case14 ä¸­çœ‹åˆ° æ ¹æ®<code>*(a1 + 1064)</code>çš„å€¼è¿›è¡Œåˆ¤æ–­ç„¶åè·³è½¬ï¼Œé€»è¾‘å³ jnzï¼›</p>
</li>
<li><p><strong>sub_7FF779ED11E0</strong> å‡½æ•°å°±æ˜¯åœ¨æ›´æ–°æ ‡å¿—ä½</p>
</li>
</ul>
<pre><code class="language-c">char __fastcall sub_7FF779ED11E0(__int64 a1, int a2, int a3, int a4)
&#123;
  char v4; // al
  char v6; // al
  char v7; // cl
  char v8; // al
  bool v9; // sf
  char result; // al

  v4 = *(a1 + 1064);
  if ( a2 )                                     // ZF
    v6 = v4 &amp; 0xFE;
  else
    v6 = v4 | 1;
  *(a1 + 1064) = v6;
  if ( a2 &gt;= 0 )                                // SF
    v7 = v6 &amp; 0xFD;
  else
    v7 = v6 | 2;
  *(a1 + 1064) = v7;
  if ( a2 &gt;= a3 || a4 &lt;= 0 )                    // CF
    v8 = v7 &amp; 0xFB;
  else
    v8 = v7 | 4;
  *(a1 + 1064) = v8;
  v9 = a3 &lt; 0;
  if ( a3 &gt; 0 )                                 // OF
  &#123;
    if ( a4 &gt; 0 &amp;&amp; a2 &lt; 0 )
      goto LABEL_18;
    v9 = a3 &lt; 0;
  &#125;
  if ( v9 &amp;&amp; a4 &lt; 0 &amp;&amp; a2 &gt; 0 )
  &#123;
LABEL_18:
    result = v8 | 8;
    *(a1 + 1064) = result;
    return result;
  &#125;
  result = v8 &amp; 0xF7;
  *(a1 + 1064) = result;
  return result;
&#125;
</code></pre>
<p>â€‹	ç„¶åæ ¹æ®ä¸Šé¢çš„åˆ†æç»“æ„ï¼Œå¯¹ a1 è¿›è¡Œé‡å®šä¹‰ï¼Œå®šä¹‰ä¸º ç»“æ„ä½“ã€‚åœ¨ IDA ä¸Šæ–¹çš„èœå•æ ï¼Œä¾æ¬¡ç‚¹å‡» View -&gt; Open Subviews -&gt; Local typesï¼Œç„¶åå³é”®ç‚¹å‡» insertï¼Œè´´å…¥å¦‚ä¸‹ç»“æ„ä½“çš„ç”³æ˜</p>
<pre><code class="language-c">struct VMState
&#123;
  int regs[8];
  char _pad0[1028];
  int ip;
  int flags;
  char _pad1[4];
  unsigned __int8 *code;
  int code_end;
  char inbuf[50];
  char outbuf[128];
&#125;;
</code></pre>
<p>â€‹	æ¥ç€ç»“åˆåˆ†æï¼Œå¯æ¸…æ¥šå„æ“ä½œæ•°æ‰€å¯¹åº”çš„æ“ä½œ</p>
<pre><code class="language-c">__int64 __fastcall sub_7FF779ED1270(struct VMState *vm)
&#123;
  __int64 ip; // rdx
  unsigned __int8 *code; // r8
  int opcode; // ecx
  int v5; // edx
  int v6; // ecx
  unsigned __int8 n0x80; // r9
  char v8; // dl
  int v9; // ecx
  unsigned __int8 n8; // r9
  unsigned __int8 n0x32; // dl
  int v12; // ecx
  unsigned __int8 n8_1; // r9
  unsigned __int8 n8_2; // dl
  int v15; // ecx
  __int64 n8_3; // r9
  int v17; // edx
  int v18; // ecx
  unsigned __int8 n8_4; // r9
  unsigned __int8 n8_5; // dl
  int v21; // r8d
  int *v22; // rcx
  int v23; // r9d
  __int64 n8_6; // r10
  int v25; // r9d
  int v26; // r8d
  int v27; // ecx
  unsigned __int8 n8_7; // r9
  unsigned __int8 n8_8; // dl
  int v30; // r8d
  int *v31; // rcx
  int v32; // r9d
  __int64 n8_9; // r10
  int v34; // r9d
  int v35; // r8d
  unsigned __int8 n8_10; // r10
  unsigned __int8 n8_11; // r9
  int *v38; // rdx
  int v39; // ecx
  __int64 n8_12; // r9
  int v41; // edx
  int v42; // ecx
  unsigned __int8 n8_13; // r9
  unsigned __int8 n8_14; // dl
  __int64 n8_15; // r9
  int v46; // r10d
  bool v47; // zf
  int v48; // ecx
  FILE *v49; // rax
  __int64 v50; // rax

  if ( vm-&gt;ip &lt; vm-&gt;code_end )
  &#123;
    while ( 2 )
    &#123;
      ip = vm-&gt;ip;
      code = vm-&gt;code;
      opcode = code[ip];
      v5 = ip + 1;
      vm-&gt;ip = v5;
      switch ( opcode )
      &#123;
        case 0:
          return 0i64;
        case 1:                                 // MOVImm2outBuf
          v6 = v5 + 1;
          n0x80 = code[v5];
          vm-&gt;ip = v5 + 1;
          v8 = code[v5 + 1];
          vm-&gt;ip = v6 + 1;
          if ( n0x80 &gt;= 0x80u )
            return 0xFFFFFFFFi64;
          vm-&gt;outbuf[n0x80] = v8;
          goto LABEL_42;
        case 2:                                 // MOVinBuf2Reg
          v9 = v5 + 1;
          n8 = code[v5];
          vm-&gt;ip = v5 + 1;
          n0x32 = code[v5 + 1];
          vm-&gt;ip = v9 + 1;
          if ( n0x32 &gt;= 0x32u || n8 &gt;= 8u )
            return 0xFFFFFFFFi64;
          vm-&gt;regs[n8] = vm-&gt;inbuf[n0x32];
          goto LABEL_42;
        case 3:                                 // MOVReg2Reg
          v12 = v5 + 1;
          n8_1 = code[v5];
          vm-&gt;ip = v5 + 1;
          n8_2 = code[v5 + 1];
          vm-&gt;ip = v12 + 1;
          if ( n8_1 &gt;= 8u || n8_2 &gt;= 8u )
            return 0xFFFFFFFFi64;
          vm-&gt;regs[n8_1] = vm-&gt;regs[n8_2];
          goto LABEL_42;
        case 4:                                 // MOVImm2Reg
          v15 = v5 + 1;
          n8_3 = code[v5];
          vm-&gt;ip = v5 + 1;
          v17 = code[v5 + 1];
          vm-&gt;ip = v15 + 1;
          if ( n8_3 &gt;= 8 )
            return 0xFFFFFFFFi64;
          vm-&gt;regs[n8_3] = v17;
          goto LABEL_42;
        case 5:                                 // ADDReg&amp;Reg
          v18 = v5 + 1;
          n8_4 = code[v5];
          vm-&gt;ip = v5 + 1;
          n8_5 = code[v5 + 1];
          vm-&gt;ip = v18 + 1;
          if ( n8_4 &gt;= 8u || n8_5 &gt;= 8u )
            return 0xFFFFFFFFi64;
          v21 = vm-&gt;regs[n8_4];
          v22 = &amp;vm-&gt;regs[n8_4];
          v23 = vm-&gt;regs[n8_5];
          *v22 = v23 + v21;
          sub_7FF779ED11E0(vm, v23 + v21, v21, v23);
          goto LABEL_42;
        case 6:                                 // ADDReg&amp;Imm
          n8_6 = code[v5];
          vm-&gt;ip = v5 + 1;
          v25 = code[v5 + 1];
          vm-&gt;ip = v5 + 2;
          if ( n8_6 &gt;= 8 )
            return 0xFFFFFFFFi64;
          v26 = vm-&gt;regs[n8_6];
          vm-&gt;regs[n8_6] = v26 + v25;
          sub_7FF779ED11E0(vm, v26 + v25, v26, v25);
          goto LABEL_42;
        case 7:                                 // SUBReg&amp;Reg
          v27 = v5 + 1;
          n8_7 = code[v5];
          vm-&gt;ip = v5 + 1;
          n8_8 = code[v5 + 1];
          vm-&gt;ip = v27 + 1;
          if ( n8_7 &gt;= 8u || n8_8 &gt;= 8u )
            return 0xFFFFFFFFi64;
          v30 = vm-&gt;regs[n8_7];
          v31 = &amp;vm-&gt;regs[n8_7];
          v32 = vm-&gt;regs[n8_8];
          *v31 = v30 - v32;
          sub_7FF779ED11E0(vm, v30 - v32, v30, -v32);
          goto LABEL_42;
        case 8:                                 // SUBReg&amp;Imm
          n8_9 = code[v5];
          vm-&gt;ip = v5 + 1;
          v34 = code[v5 + 1];
          vm-&gt;ip = v5 + 2;
          if ( n8_9 &gt;= 8 )
            return 0xFFFFFFFFi64;
          v35 = vm-&gt;regs[n8_9];
          vm-&gt;regs[n8_9] = v35 - v34;
          sub_7FF779ED11E0(vm, v35 - v34, v35, -v34);
          goto LABEL_42;
        case 9:                                 // XORReg&amp;Reg
          n8_10 = code[v5];
          vm-&gt;ip = v5 + 1;
          n8_11 = code[v5 + 1];
          vm-&gt;ip = v5 + 2;
          if ( n8_10 &gt;= 8u || n8_11 &gt;= 8u )
            return 0xFFFFFFFFi64;
          v38 = &amp;vm-&gt;regs[n8_10];
          *v38 ^= vm-&gt;regs[n8_11];
          sub_7FF779ED11E0(vm, *v38, 0, 0);
          goto LABEL_42;
        case 10:                                // XORReg&amp;Imm
          v39 = v5 + 1;
          n8_12 = code[v5];
          vm-&gt;ip = v5 + 1;
          v41 = code[v5 + 1];
          vm-&gt;ip = v39 + 1;
          if ( n8_12 &gt;= 8 )
            return 0xFFFFFFFFi64;
          vm-&gt;regs[n8_12] ^= v41;
          sub_7FF779ED11E0(vm, vm-&gt;regs[n8_12], 0, 0);
          goto LABEL_42;
        case 11:                                // CMPReg&amp;Reg
          v42 = v5 + 1;
          n8_13 = code[v5];
          vm-&gt;ip = v5 + 1;
          n8_14 = code[v5 + 1];
          vm-&gt;ip = v42 + 1;
          if ( n8_13 &gt;= 8u || n8_14 &gt;= 8u )
            return 0xFFFFFFFFi64;
          sub_7FF779ED11E0(vm, vm-&gt;regs[n8_13] - vm-&gt;regs[n8_14], vm-&gt;regs[n8_13], -vm-&gt;regs[n8_14]);
          goto LABEL_42;
        case 12:                                // CMPReg&amp;Imm
          n8_15 = code[v5];
          vm-&gt;ip = v5 + 1;
          v46 = code[v5 + 1];
          vm-&gt;ip = v5 + 2;
          if ( n8_15 &gt;= 8 )
            return 0xFFFFFFFFi64;
          sub_7FF779ED11E0(vm, vm-&gt;regs[n8_15] - v46, vm-&gt;regs[n8_15], -v46);
LABEL_42:
          if ( vm-&gt;ip &gt;= vm-&gt;code_end )
            return 0i64;
          continue;
        case 13:                                // JMP
          vm-&gt;ip = code[v5];
          goto LABEL_42;
        case 14:                                // JNZ
          v47 = (vm-&gt;flags &amp; 1) == 0;
          v48 = code[v5];
          vm-&gt;ip = v5 + 1;
          if ( v47 )
            vm-&gt;ip = v48;
          goto LABEL_42;
        case 16:                                // READ
          v49 = _acrt_iob_func(0);
          common_fgets&lt;char&gt;(vm-&gt;inbuf, 50i64, v49);
          v50 = -1i64;
          do
            ++v50;
          while ( vm-&gt;inbuf[v50] );
          if ( v50 &amp;&amp; *(&amp;vm-&gt;code_end + v50 + 3) == 10 )
            *(&amp;vm-&gt;code_end + v50 + 3) = 0;
          goto LABEL_42;
        case 17:                                // PRINT
          printf(&quot;%s&quot;, vm-&gt;outbuf);
          goto LABEL_42;
        default:
          return 0xFFFFFFFFi64;
      &#125;
    &#125;
  &#125;
  return 0i64;
&#125;
</code></pre>
<p>â€‹	ç„¶åç¼–å†™è„šæœ¬æŠŠæ±‡ç¼–è¿›è¡Œè¾“å‡º</p>
<pre><code class="language-python">OPLEN = &#123;
    0x00: 1, 0x01: 3, 0x02: 3, 0x03: 3, 0x04: 3,
    0x05: 3, 0x06: 3, 0x07: 3, 0x08: 3, 0x09: 3,
    0x0A: 3, 0x0B: 3, 0x0C: 3, 0x0D: 2, 0x0E: 2,
    0x10: 1, 0x11: 1,
&#125;

def parse_hex(s: str) -&gt; bytes:
    s = s.replace(&quot;\n&quot;, &quot; &quot;).replace(&quot;\t&quot;, &quot; &quot;).strip()
    return bytes(int(x, 16) for x in s.split() if x)

def disasm(code: bytes) -&gt; None:
    ip = 0
    while ip &lt; len(code):
        op = code[ip]
        ln = OPLEN.get(op, 1)
        ins = code[ip:ip+ln]

        if op not in OPLEN:
            print(f&quot;&#123;ip:04x&#125;: db &#123;op:02x&#125;&quot;)
            ip += 1
            continue

        def b(i): return ins[i]

        if op == 0x00: print(f&quot;&#123;ip:04x&#125;: HALT&quot;)
        elif op == 0x01: print(f&quot;&#123;ip:04x&#125;: PUTC out[&#123;b(1)&#125;] = &#123;b(2):02x&#125; (&#39;&#123;chr(b(2))&#125;&#39;)&quot;)
        elif op == 0x02: print(f&quot;&#123;ip:04x&#125;: LOAD R&#123;b(1)&#125;, in[&#123;b(2)&#125;]&quot;)
        elif op == 0x03: print(f&quot;&#123;ip:04x&#125;: MOV  R&#123;b(1)&#125;, R&#123;b(2)&#125;&quot;)
        elif op == 0x04: print(f&quot;&#123;ip:04x&#125;: MOVI R&#123;b(1)&#125;, &#123;b(2)&#125;&quot;)
        elif op == 0x05: print(f&quot;&#123;ip:04x&#125;: ADD  R&#123;b(1)&#125;, R&#123;b(2)&#125;&quot;)
        elif op == 0x06: print(f&quot;&#123;ip:04x&#125;: ADDI R&#123;b(1)&#125;, &#123;b(2)&#125;&quot;)
        elif op == 0x07: print(f&quot;&#123;ip:04x&#125;: SUB  R&#123;b(1)&#125;, R&#123;b(2)&#125;&quot;)
        elif op == 0x08: print(f&quot;&#123;ip:04x&#125;: SUBI R&#123;b(1)&#125;, &#123;b(2)&#125;&quot;)
        elif op == 0x09: print(f&quot;&#123;ip:04x&#125;: XOR  R&#123;b(1)&#125;, R&#123;b(2)&#125;&quot;)
        elif op == 0x0A: print(f&quot;&#123;ip:04x&#125;: XORI R&#123;b(1)&#125;, &#123;b(2)&#125;&quot;)
        elif op == 0x0B: print(f&quot;&#123;ip:04x&#125;: CMP  R&#123;b(1)&#125;, R&#123;b(2)&#125;&quot;)
        elif op == 0x0C: print(f&quot;&#123;ip:04x&#125;: CMPI R&#123;b(1)&#125;, &#123;b(2)&#125;&quot;)
        elif op == 0x0D: print(f&quot;&#123;ip:04x&#125;: JMP  &#123;b(1):02x&#125;&quot;)
        elif op == 0x0E: print(f&quot;&#123;ip:04x&#125;: JNZ  &#123;b(1):02x&#125;&quot;)
        elif op == 0x10: print(f&quot;&#123;ip:04x&#125;: READ&quot;)
        elif op == 0x11: print(f&quot;&#123;ip:04x&#125;: PRINT&quot;)
        ip += ln

if __name__ == &quot;__main__&quot;:
    HEX = &quot;&quot;&quot;
    0D 3C 01 06 0A 01 02 6F 01 00 
    57 01 05 21 01 03 6E 01 01 72 
    01 04 67 01 07 00 11 00 01 04 
    65 01 05 63 01 09 00 01 01 6F 
    01 03 72 01 07 21 01 02 72 01 
    08 0A 01 00 43 01 06 74 11 00 
    10 02 00 00 0C 00 66 0E 02 02 
    00 01 03 01 00 06 01 01 0C 01 
    6D 0E 02 02 01 02 02 02 03 02 
    03 04 03 00 01 09 00 02 0C 00 
    06 0E 02 03 00 02 09 00 03 0C 
    00 1C 0E 02 03 00 01 09 00 03 
    0C 00 1A 0E 02 02 01 05 02 02 
    06 02 03 07 0C 02 69 0E 02 03 
    00 01 09 00 02 0C 00 21 0E 02 
    03 00 03 09 00 02 0C 00 3D 0E 
    02 02 04 08 02 05 09 02 06 0A 
    0B 05 03 0E 02 03 00 04 09 00 
    05 0C 00 17 0E 02 03 00 06 09 
    00 05 0C 00 12 0E 02 02 01 0B 
    02 02 0C 02 03 0D 02 04 0E 02 
    05 0F 02 06 10 02 07 11 0B 02 
    04 0E 02 03 00 01 05 00 00 0C 
    00 BE 0E 02 09 00 00 0B 00 07 
    0E 02 05 00 02 0C 00 32 0E 02 
    08 00 02 0C 00 30 0E 02 06 00 
    05 0B 00 05 0E 02 02 00 04 07 
    06 00 0C 06 02 0E 02 0D 1C 00
    &quot;&quot;&quot;
    code = parse_hex(HEX)
    disasm(code)
</code></pre>
<p>â€‹	å¾—åˆ°è¾“å‡º</p>
<pre><code class="language-shell">0000: JMP  3c
0002: PUTC out[6] = 0a (&#39;
&#39;)
0005: PUTC out[2] = 6f (&#39;o&#39;)
0008: PUTC out[0] = 57 (&#39;W&#39;)
000b: PUTC out[5] = 21 (&#39;!&#39;)
000e: PUTC out[3] = 6e (&#39;n&#39;)
0011: PUTC out[1] = 72 (&#39;r&#39;)
0014: PUTC out[4] = 67 (&#39;g&#39;)
0017: PUTC out[7] = 00 (&#39; &#39;)
001a: PRINT
001b: HALT
001c: PUTC out[4] = 65 (&#39;e&#39;)
001f: PUTC out[5] = 63 (&#39;c&#39;)
0022: PUTC out[9] = 00 (&#39; &#39;)
0025: PUTC out[1] = 6f (&#39;o&#39;)
0028: PUTC out[3] = 72 (&#39;r&#39;)
002b: PUTC out[7] = 21 (&#39;!&#39;)
002e: PUTC out[2] = 72 (&#39;r&#39;)
0031: PUTC out[8] = 0a (&#39;
&#39;)
0034: PUTC out[0] = 43 (&#39;C&#39;)
0037: PUTC out[6] = 74 (&#39;t&#39;)
003a: PRINT
003b: HALT
003c: READ
003d: LOAD R0, in[0]
0040: CMPI R0, 102
0043: JNZ  02
0045: LOAD R0, in[1]
0048: MOV  R1, R0
004b: ADDI R1, 1
004e: CMPI R1, 109
0051: JNZ  02
0053: LOAD R1, in[2]
0056: LOAD R2, in[3]
0059: LOAD R3, in[4]
005c: MOV  R0, R1
005f: XOR  R0, R2
0062: CMPI R0, 6
0065: JNZ  02
0067: MOV  R0, R2
006a: XOR  R0, R3
006d: CMPI R0, 28
0070: JNZ  02
0072: MOV  R0, R1
0075: XOR  R0, R3
0078: CMPI R0, 26
007b: JNZ  02
007d: LOAD R1, in[5]
0080: LOAD R2, in[6]
0083: LOAD R3, in[7]
0086: CMPI R2, 105
0089: JNZ  02
008b: MOV  R0, R1
008e: XOR  R0, R2
0091: CMPI R0, 33
0094: JNZ  02
0096: MOV  R0, R3
0099: XOR  R0, R2
009c: CMPI R0, 61
009f: JNZ  02
00a1: LOAD R4, in[8]
00a4: LOAD R5, in[9]
00a7: LOAD R6, in[10]
00aa: CMP  R5, R3
00ad: JNZ  02
00af: MOV  R0, R4
00b2: XOR  R0, R5
00b5: CMPI R0, 23
00b8: JNZ  02
00ba: MOV  R0, R6
00bd: XOR  R0, R5
00c0: CMPI R0, 18
00c3: JNZ  02
00c5: LOAD R1, in[11]
00c8: LOAD R2, in[12]
00cb: LOAD R3, in[13]
00ce: LOAD R4, in[14]
00d1: LOAD R5, in[15]
00d4: LOAD R6, in[16]
00d7: LOAD R7, in[17]
00da: CMP  R2, R4
00dd: JNZ  02
00df: MOV  R0, R1
00e2: ADD  R0, R0
00e5: CMPI R0, 190
00e8: JNZ  02
00ea: XOR  R0, R0
00ed: CMP  R0, R7
00f0: JNZ  02
00f2: ADD  R0, R2
00f5: CMPI R0, 50
00f8: JNZ  02
00fa: SUBI R0, 2
00fd: CMPI R0, 48
0100: JNZ  02
0102: ADDI R0, 5
0105: CMP  R0, R5
0108: JNZ  02
010a: LOAD R0, in[4]
010d: SUB  R6, R0
0110: CMPI R6, 2
0113: JNZ  02
0115: JMP  1c
0117: HALT
</code></pre>
<p>â€‹	å°±æ˜¯ä¸€äº›ç®€å•çš„çº¦æŸï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°æ€ä¹ˆæ±‚è§£äº†ï¼Œæœ€ç»ˆ flag å°±æ˜¯ flag{HiTCTF_2025}</p>
<hr>
<h3 id="ComplexVM"><a href="#ComplexVM" class="headerlink" title="ComplexVM"></a>ComplexVM</h3><p>â€‹	è¿™é“ vm æ¯”ä¸Šä¸€é“è¦å¤æ‚ä¸€äº›ã€‚main å‡½æ•°çš„å¼€å¤´éƒ¨åˆ†ç”³æ˜äº†ä¸€ä¸ªå¾ˆå¤§çš„ bufferï¼ˆv33ï¼‰ï¼Œæ˜æ˜¾è¢«å½“æˆ VM COntext &#x2F; å¯„å­˜å™¨å— + å­—èŠ‚ç åŒº ä½¿ç”¨ã€‚æ¥ç€åˆå§‹åŒ–ä¸€äº›å˜é‡ã€‚ç„¶å <strong>sub_140001210</strong> å‡½æ•°å°±æ˜¯è§£é‡Šå™¨ã€‚</p>
<p>â€‹	while å¾ªç¯ 1024 ä¸ª opcodeï¼Œå…¶ä¸­ <strong>sub_140004090</strong> å‡½æ•°ä¸€ç›´è·Ÿä¸‹å»æ˜¯åè°ƒè¯•çš„é€»è¾‘ã€‚ç¬¬ä¸€ä¸ª while å¾ªç¯å°±æ˜¯è¾“å‡º <code>Input your flag:</code> çš„ã€‚</p>
<p>â€‹	ç¬¬äºŒæ®µå°±å¾ˆé‡è¦äº†ã€‚æ„é€ äº†å¦ä¸€ä¸ª VM ä¸Šä¸‹æ–‡ <code>v36 + v40</code>ã€‚è·Ÿè¿› <strong>sub_1400048C0</strong> å‡½æ•°å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª fake flagã€‚</p>
<pre><code class="language-c">__int64 __fastcall sub_1400048C0(_BYTE *a1)
&#123;
  int n0x11; // r9d
  unsigned __int8 *i; // r8
  int v3; // edx
  int v4; // edx
  __int64 n0x11_1; // rax
  char flag_HITCTF_fake__[24]; // [rsp+0h] [rbp-28h] BYREF

  n0x11 = 0;
  strcpy(flag_HITCTF_fake__, &quot;flag&#123;HITCTF_fake&#125;&quot;);
  for ( i = a1 + 1052; ; ++i )
  &#123;
    v3 = i[flag_HITCTF_fake__ - a1 - 1052];
    a1[8] = v3;
    v4 = v3 - 1;
    n0x11_1 = *i;
    a1[9] = n0x11_1;
    if ( v4 )
      a1[16] &amp;= ~1u;
    else
      a1[16] |= 1u;
    if ( (v4 &amp; 0x80u) == 0 )
      a1[16] &amp;= ~4u;
    else
      a1[16] |= 4u;
    if ( v4 &gt;= 0 )
      a1[16] &amp;= ~2u;
    else
      a1[16] |= 2u;
    if ( (a1[16] &amp; 1) == 0 )
      break;
    ++n0x11;
    a1[15] = -86;
    n0x11_1 = n0x11;
    if ( n0x11 &gt;= 0x11 )
      return n0x11_1;
  &#125;
  a1[15] = -1;
  return n0x11_1;
&#125;
</code></pre>
<p>â€‹	å¹¶ä¸”æ ¹æ®ä¼ªä»£ç å¯çŸ¥è¯¥å‡½æ•°æ˜¯ä» a1 + 1052 å¼€å§‹å¾ªç¯çš„ï¼ŒåŒæ—¶å†çœ‹ v36 å’Œ v40 ä¹‹é—´çš„ç›¸å¯¹åç§»</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20260104144037928.png" alt="image-20260104144037928"></p>
<p>â€‹	å·®äº† 0x1Cï¼ˆ28ï¼‰å­—èŠ‚ï¼Œå³ a1 + 1052 æ­£å¥½è½åœ¨ v40 + 1024 è¿™ä¸ªä½ç½®ã€‚æ•…å¯çŸ¥ sub_1400048C0 å‡½æ•°å°±æ˜¯ä¸€ä¸ªå‡éªŒè¯é€»è¾‘ï¼šæ‹¿ flag{HITCTF_fake} å»å¯¹æ¯” æ•°æ®åŒºå¼€å¤´ï¼ˆv40 + 1024ï¼‰ï¼Œè€Œæ­¤æ—¶ <strong>memset(v40,0,sizeof(v40))</strong> åˆšæ¸…é›¶ï¼Œæ‰€ä»¥æ¯”è¾ƒè‚¯å®šå¤±è´¥ã€‚æ¥ä¸‹æ¥è¿›å…¥è§£é‡Šå™¨åˆ†æã€‚</p>
<p>â€‹	è¯¥ vm çš„å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<ul>
<li>a1 + 20ï¼šæŒ‡ä»¤æŒ‡é’ˆ IPï¼›</li>
<li>a1 + 16ï¼šæ ‡å¿—å¯„å­˜å™¨ Flagsï¼ˆZ&#x2F;N&#x2F;Cï¼‰ï¼›</li>
<li>a1 + 8ï¼šå¯„å­˜å™¨æ–‡ä»¶ regs[]ï¼›</li>
<li>a1 + 28ï¼šå­—èŠ‚ç &#x2F;å†…å­˜æ± men[]ã€‚å®ƒå³è¢« IP å½“ä½œâ€œå–æŒ‡&#x2F;å–æ“ä½œæ•°â€çš„æ¥æºï¼Œä¹Ÿè¢«å½“åšæ ˆæˆ–è€…ä¸­é—´å­˜å‚¨å†™å…¥ï¼›</li>
<li>a1 + 24ï¼šæ ˆæŒ‡é’ˆ&#x2F;æ ˆæ·± SPã€‚åå¤å‡ºç° <code>if (*(a1+24) &gt;= 0x3FF</code>ï¼›</li>
<li>a1 + 1052 &#x2F; a1 + 1180ï¼šè¾“å…¥ç¼“å†²åŒº &amp; è¾“å‡ºç¼“å†²åŒºã€‚</li>
</ul>
<p>â€‹	ç„¶åæ ¹æ®åˆ†æçš„å¸ƒå±€ï¼Œç”³æ˜ä¸€ä¸ªç»“æ„ä½“</p>
<pre><code class="language-c">typedef struct VMCTX
&#123;
  void **dispatch;        // 0x00: off_14001DCF8 è¿™ç±» handler è¡¨æŒ‡é’ˆ

  // 0x08..0x0F: 8ä¸ªâ€œè™šæ‹Ÿå¯„å­˜å™¨/æ§½ä½â€
  // ä½ çœ‹åˆ°çš„ a1[8], a1[9], a1[15] éƒ½è½åœ¨è¿™é‡Œï¼šreg[0]=a1[8], reg[1]=a1[9], ..., reg[7]=a1[15]
  unsigned __int8 reg[8]; // 0x08

  unsigned int flags;     // 0x10: a1[16] å®é™…å°±æ˜¯ flags çš„ä½å­—èŠ‚ (ZF/CF/SF ç­‰)
  unsigned int ip;        // 0x14: *(a1+20) ä½œä¸º operand è¯»å–/è·³è½¬ç”¨çš„ IP
  unsigned int sp;        // 0x18: *(a1+24) æ ˆæŒ‡é’ˆ/æ·±åº¦ï¼ˆä¸Šé™ 0x3FFï¼‰

  unsigned __int8 mem[0x400];  // 0x1C: v40[0..1023] å­—èŠ‚ç /å†…å­˜åŒºï¼ˆä½ å¤–å±‚å¾ªç¯å°±æ˜¯ä»è¿™é‡Œå– opcodeï¼‰
  char input[0x80];            // 0x41C: a1+1052ï¼Œfgets è¯»å…¥ï¼Œcase 31 ä»è¿™é‡Œå–å­—ç¬¦
  char output[0x80];           // 0x49C: a1+1180ï¼Œcase 32 å†™å…¥ï¼Œcase 29/30 printf è¾“å‡º
&#125; VMCTX;
</code></pre>
<p>â€‹	å¯ä»¥çœ‹åˆ°åœ¨ switch-case çš„ååŠéƒ¨åˆ†å…¨æ˜¯ç‰¹æ®Šçš„èµ‹å€¼æƒ…å†µï¼Œå…¶ä¸­ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ã€‚å³å–ä¸€ä¸ªç«‹å³æ•°ï¼Œç„¶åè¿›è¡ŒåŠ &#x2F;å‡ä¸€ä¸ªæ•°ï¼Œå†è¿›è¡Œèµ‹å€¼ã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20260104153727876.png" alt="image-20260104153727876"></p>
<p>â€‹	ç„¶åå‰åŠéƒ¨åˆ†å°±æ˜¯ä¸€äº›å¸¸è§çš„è¿ç®—èµ‹å€¼ç­‰æ“ä½œã€‚ç„¶åå°±å¯ä»¥ä½¿ç”¨è„šæœ¬è¿›è¡Œè¾“å‡ºæ±‡ç¼–æ“ä½œäº†</p>
<pre><code class="language-python">import sys
import argparse
import re

# operand kinds
R   = &quot;R&quot;     # 1 byte register index
I8  = &quot;I8&quot;    # 1 byte immediate
A16 = &quot;A16&quot;   # 2 byte address (big-endian)

# Base opcode table (ä½ å·²ç»éªŒè¯çš„ä¸€æ‰¹)
OPS = &#123;
    0x00: (&quot;NOP&quot;,  []),

    0x01: (&quot;MOV&quot;,  [R, R]),
    0x02: (&quot;ADD&quot;,  [R, R]),
    0x03: (&quot;SUB&quot;,  [R, R]),
    0x04: (&quot;AND&quot;,  [R, R]),
    0x05: (&quot;OR&quot;,   [R, R]),
    0x06: (&quot;XOR&quot;,  [R, R]),

    0x07: (&quot;MOVI&quot;, [R, I8]),
    0x08: (&quot;ADDI&quot;, [R, I8]),
    0x09: (&quot;SUBI&quot;, [R, I8]),
    0x0A: (&quot;ANDI&quot;, [R, I8]),
    0x0B: (&quot;ORI&quot;,  [R, I8]),
    0x0C: (&quot;XORI&quot;, [R, I8]),

    0x0D: (&quot;NOT&quot;,  [R]),
    0x0E: (&quot;SHL1&quot;, [R]),
    0x0F: (&quot;SHR1&quot;, [R]),

    0x10: (&quot;JMP&quot;,  [A16]),
    0x11: (&quot;JZ&quot;,   [A16]),
    0x12: (&quot;JNZ&quot;,  [A16]),
    0x13: (&quot;CALL&quot;, [A16]),
    0x14: (&quot;RET&quot;,  []),

    0x15: (&quot;PUSH&quot;, [R]),
    0x16: (&quot;POP&quot;,  [R]),

    0x17: (&quot;CMP&quot;,  [R, R]),
    0x18: (&quot;CMPI&quot;, [R, I8]),

    0x19: (&quot;INC&quot;,  [R]),
    0x1A: (&quot;DEC&quot;,  [R]),

    0x1B: (&quot;DAA&quot;,  []),

    0x1C: (&quot;READ&quot;, []),
    0x1D: (&quot;PRINT&quot;, []),
    0x1E: (&quot;PRINT2&quot;, []),

    0x1F: (&quot;LDI_IN&quot;,  [R, I8]),   # r = input[idx]
    0x20: (&quot;STO_OUT&quot;, [I8, R]),   # output[idx] = r
&#125;

# ä½ è´´å‡ºæ¥çš„ 0x21~0x25ï¼šæ ¼å¼éƒ½æ˜¯ [opcode][dst][imm]ï¼Œè¯­ä¹‰ reg[dst] = imm + adj
# case 0x21: imm - 54
# case 0x22: imm - 112
# case 0x23: imm + 68
# case 0x24: imm + 57
# case 0x25: imm + 78
LDC_ADJ = &#123;
    0x21: -54,
    0x22: -112,
    0x23: +68,
    0x24: +57,
    0x25: +78,
&#125;

def u16be(b0, b1):
    return ((b0 &amp; 0xFF) &lt;&lt; 8) | (b1 &amp; 0xFF)

def is_printable(x):
    return 0x20 &lt;= x &lt;= 0x7E

def decode_one(code, pc, guess_ldc=False):
    &quot;&quot;&quot;
    è¿”å› (next_pc, asm_line, jump_target_or_None)
    &quot;&quot;&quot;
    n = len(code)
    if pc &gt;= n:
        return pc + 1, &quot;%04X: &lt;eof&gt;&quot; % pc, None

    op = code[pc]

    # LDC å˜ä½“ï¼šå›ºå®š 3 å­—èŠ‚
    if op in LDC_ADJ:
        if pc + 3 &gt; n:
            raw = &quot; &quot;.join(&quot;%02X&quot; % b for b in code[pc:])
            return n, &quot;%04X: %s  ; truncated&quot; % (pc, raw), None
        dst = code[pc+1]
        imm = code[pc+2]
        adj = LDC_ADJ[op]
        val = (imm + adj) &amp; 0xFF
        ch = &quot; &#39;%s&#39;&quot; % chr(val) if is_printable(val) else &quot;&quot;
        raw = &quot;%02X %02X %02X&quot; % (op, dst, imm)
        sign = &quot;+&quot; if adj &gt;= 0 else &quot;-&quot;
        line = &quot;%04X: %-11s LDC     r%d, 0x%02X%s   ; imm=0x%02X %s %d&quot; % (
            pc, raw, dst, val, ch, imm, sign, abs(adj)
        )
        return pc + 3, line, None

    # å¦‚æœå¯ç”¨ guess_ldcï¼šæœªçŸ¥ä½†åœ¨ 0x21..0xFE ä¹ŸæŒ‰ 3 å­—èŠ‚åƒæ‰ï¼Œé¿å…å¤±æ­¥ï¼ˆå¯é€‰ï¼‰
    if guess_ldc and (0x21 &lt;= op &lt;= 0xFE) and (op not in OPS):
        if pc + 3 &gt; n:
            raw = &quot; &quot;.join(&quot;%02X&quot; % b for b in code[pc:])
            return n, &quot;%04X: %s  ; truncated&quot; % (pc, raw), None
        dst = code[pc+1]
        imm = code[pc+2]
        raw = &quot;%02X %02X %02X&quot; % (op, dst, imm)
        line = &quot;%04X: %-11s OP%02X   r%d, 0x%02X&quot; % (pc, raw, op, dst, imm)
        return pc + 3, line, None

    # æ™®é€šè¡¨é©±åŠ¨
    if op not in OPS:
        raw = &quot;%02X&quot; % op
        return pc + 1, &quot;%04X: %-11s DB      0x%02X   ; unknown&quot; % (pc, raw, op), None

    mnem, kinds = OPS[op]

    # è®¡ç®—æŒ‡ä»¤é•¿åº¦
    need = 1
    for k in kinds:
        need += 2 if k == A16 else 1
    if pc + need &gt; n:
        raw = &quot; &quot;.join(&quot;%02X&quot; % b for b in code[pc:])
        return n, &quot;%04X: %s  ; truncated&quot; % (pc, raw), None

    raw_bytes = code[pc:pc+need]
    raw = &quot; &quot;.join(&quot;%02X&quot; % b for b in raw_bytes)

    # è¯»æ“ä½œæ•°
    i = pc + 1
    ops_txt = []
    jmp_tgt = None
    for k in kinds:
        if k == A16:
            tgt = u16be(code[i], code[i+1])
            ops_txt.append(&quot;loc_%04X&quot; % tgt)
            jmp_tgt = tgt
            i += 2
        elif k == R:
            r = code[i]
            ops_txt.append(&quot;r%d&quot; % r)
            i += 1
        else:  # I8
            imm = code[i]
            ops_txt.append(&quot;0x%02X&quot; % imm)
            i += 1

    if ops_txt:
        line = &quot;%04X: %-11s %-7s %s&quot; % (pc, raw, mnem, &quot;, &quot;.join(ops_txt))
    else:
        line = &quot;%04X: %-11s %s&quot; % (pc, raw, mnem)

    return pc + need, line, jmp_tgt

def disasm(code, labels=False, guess_ldc=False):
    # pass1: æ”¶é›†è·³è½¬ç›®æ ‡ï¼ˆå¯é€‰ï¼‰
    targets = set()
    if labels:
        pc = 0
        while pc &lt; len(code):
            npc, line, tgt = decode_one(code, pc, guess_ldc=guess_ldc)
            if tgt is not None:
                targets.add(tgt)
            if npc &lt;= pc:
                break
            pc = npc

    # pass2: è¾“å‡º
    pc = 0
    while pc &lt; len(code):
        if labels and pc in targets:
            print(&quot;loc_%04X:&quot; % pc)
        npc, line, tgt = decode_one(code, pc, guess_ldc=guess_ldc)
        print(line)
        if npc &lt;= pc:
            break
        pc = npc

def read_hex_stream(text):
    # å…è®¸ç©ºæ ¼/æ¢è¡Œ
    parts = text.strip().split()
    if not parts:
        return b&quot;&quot;
    return bytes(int(x, 16) for x in parts)

def main():
    ap = argparse.ArgumentParser()
    ap.add_argument(&quot;--hexfile&quot;, help=&quot;hex bytes file (e.g. code.hex). If omitted, read from stdin.&quot;)
    ap.add_argument(&quot;--labels&quot;, action=&quot;store_true&quot;, help=&quot;print labels for jump targets&quot;)
    ap.add_argument(&quot;--guess-ldc&quot;, action=&quot;store_true&quot;,
                    help=&quot;treat unknown opcodes in 0x21..0xFE as 3-byte (opcode,dst,imm) to avoid desync&quot;)
    args = ap.parse_args()

    if args.hexfile:
        text = open(args.hexfile, &quot;r&quot;, encoding=&quot;utf-8&quot;, errors=&quot;ignore&quot;).read()
    else:
        text = sys.stdin.read()

    code = read_hex_stream(text)
    if not code:
        print(&quot;No input bytes. Usage: python vm_disasm.py --hexfile code.hex&quot;)
        return

    disasm(code, labels=args.labels, guess_ldc=args.guess_ldc)

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<p>â€‹	æ‹¿åˆ°è¾“å‡º</p>
<pre><code class="language-shell">0000: 13 00 75    CALL    loc_0075
0003: 06 05 05    XOR     r5, r5
0006: 07 01 72    MOVI    r1, 0x72
0009: 07 03 6E    MOVI    r3, 0x6E
000C: 07 02 6F    MOVI    r2, 0x6F
000F: 07 04 67    MOVI    r4, 0x67
0012: 07 00 57    MOVI    r0, 0x57
0015: 20 00 00    STO_OUT 0x00, r0
0018: 20 04 04    STO_OUT 0x04, r4
001B: 20 02 02    STO_OUT 0x02, r2
001E: 20 03 03    STO_OUT 0x03, r3
0021: 20 01 01    STO_OUT 0x01, r1
0024: 20 05 05    STO_OUT 0x05, r5
0027: 1E          PRINT2
0028: 00          NOP
0029: FF          DB      0xFF   ; unknown
002A: 07 01 6F    MOVI    r1, 0x6F
002D: 07 04 65    MOVI    r4, 0x65
0030: 07 02 72    MOVI    r2, 0x72
0033: 07 06 74    MOVI    r6, 0x74
0036: 07 00 43    MOVI    r0, 0x43
0039: 07 05 63    MOVI    r5, 0x63
003C: 07 03 72    MOVI    r3, 0x72
003F: 06 07 07    XOR     r7, r7
0042: 20 03 03    STO_OUT 0x03, r3
0045: 20 01 01    STO_OUT 0x01, r1
0048: 20 02 02    STO_OUT 0x02, r2
004B: 20 00 00    STO_OUT 0x00, r0
004E: 20 04 04    STO_OUT 0x04, r4
0051: 20 06 06    STO_OUT 0x06, r6
0054: 20 05 05    STO_OUT 0x05, r5
0057: 20 07 07    STO_OUT 0x07, r7
005A: 1E          PRINT2
005B: 00          NOP
005C: FF          DB      0xFF   ; unknown
005D: 07 00 FF    MOVI    r0, 0xFF
0060: 09 00 01    SUBI    r0, 0x01
0063: 12 00 60    JNZ     loc_0060
0066: 14          RET
0067: 00          NOP
0068: 00          NOP
0069: 07 00 AA    MOVI    r0, 0xAA
006C: 07 01 55    MOVI    r1, 0x55
006F: 06 00 01    XOR     r0, r1
0072: 14          RET
0073: 00          NOP
0074: 00          NOP
0075: 07 00 00    MOVI    r0, 0x00
0078: 13 00 69    CALL    loc_0069
007B: 07 01 FF    MOVI    r1, 0xFF
007E: 17 00 01    CMP     r0, r1
0081: 12 00 03    JNZ     loc_0003
0084: 1C          READ
0085: 00          NOP
0086: 00          NOP
0087: 1F 00 02    LDI_IN  r0, 0x02
008A: 18 00 61    CMPI    r0, 0x61
008D: 12 00 03    JNZ     loc_0003
0090: 1F 00 01    LDI_IN  r0, 0x01
0093: 18 00 6C    CMPI    r0, 0x6C
0096: 12 00 03    JNZ     loc_0003
0099: 1F 00 00    LDI_IN  r0, 0x00
009C: 18 00 66    CMPI    r0, 0x66
009F: 12 00 03    JNZ     loc_0003
00A2: 1F 00 03    LDI_IN  r0, 0x03
00A5: 18 00 67    CMPI    r0, 0x67
00A8: 12 00 03    JNZ     loc_0003
00AB: 1F 00 04    LDI_IN  r0, 0x04
00AE: 18 00 7B    CMPI    r0, 0x7B
00B1: 12 00 03    JNZ     loc_0003
00B4: 1F 00 07    LDI_IN  r0, 0x07
00B7: 18 00 54    CMPI    r0, 0x54
00BA: 12 00 03    JNZ     loc_0003
00BD: 1F 00 06    LDI_IN  r0, 0x06
00C0: 18 00 49    CMPI    r0, 0x49
00C3: 12 00 03    JNZ     loc_0003
00C6: 1F 00 05    LDI_IN  r0, 0x05
00C9: 18 00 48    CMPI    r0, 0x48
00CC: 12 00 03    JNZ     loc_0003
00CF: 1F 00 08    LDI_IN  r0, 0x08
00D2: 18 00 43    CMPI    r0, 0x43
00D5: 12 00 03    JNZ     loc_0003
00D8: 1F 00 0C    LDI_IN  r0, 0x0C
00DB: 18 00 30    CMPI    r0, 0x30
00DE: 12 00 03    JNZ     loc_0003
00E1: 1F 00 0A    LDI_IN  r0, 0x0A
00E4: 18 00 46    CMPI    r0, 0x46
00E7: 12 00 03    JNZ     loc_0003
00EA: 1F 00 0B    LDI_IN  r0, 0x0B
00ED: 18 00 32    CMPI    r0, 0x32
00F0: 12 00 03    JNZ     loc_0003
00F3: 1F 00 09    LDI_IN  r0, 0x09
00F6: 18 00 54    CMPI    r0, 0x54
00F9: 12 00 03    JNZ     loc_0003
00FC: 1F 00 0D    LDI_IN  r0, 0x0D
00FF: 18 00 32    CMPI    r0, 0x32
0102: 12 00 03    JNZ     loc_0003
0105: 1F 00 0E    LDI_IN  r0, 0x0E
0108: 18 00 35    CMPI    r0, 0x35
010B: 12 00 03    JNZ     loc_0003
010E: 1F 00 0F    LDI_IN  r0, 0x0F
0111: 18 00 5F    CMPI    r0, 0x5F
0114: 12 00 03    JNZ     loc_0003
0117: 1F 00 10    LDI_IN  r0, 0x10
011A: 1F 01 0B    LDI_IN  r1, 0x0B
011D: 17 00 01    CMP     r0, r1
0120: 12 00 03    JNZ     loc_0003
0123: 1F 00 11    LDI_IN  r0, 0x11
0126: 22 01 A8    LDC     r1, 0x38 &#39;8&#39;   ; imm=0xA8 - 112
0129: 17 01 00    CMP     r1, r0
012C: 12 00 03    JNZ     loc_0003
012F: 1F 00 12    LDI_IN  r0, 0x12
0132: 09 01 01    SUBI    r1, 0x01
0135: 17 01 00    CMP     r1, r0
0138: 12 00 03    JNZ     loc_0003
013B: 07 00 80    MOVI    r0, 0x80
013E: 15 00       PUSH    r0
0140: 00          NOP
0141: 13 00 5D    CALL    loc_005D
0144: 16 00       POP     r0
0146: 00          NOP
0147: 09 00 01    SUBI    r0, 0x01
014A: 12 01 3E    JNZ     loc_013E
014D: 1F 00 13    LDI_IN  r0, 0x13
0150: 06 01 00    XOR     r1, r0
0153: 18 01 52    CMPI    r1, 0x52
0156: 12 00 03    JNZ     loc_0003
0159: 1F 00 14    LDI_IN  r0, 0x14
015C: 1F 01 17    LDI_IN  r1, 0x17
015F: 06 00 01    XOR     r0, r1
0162: 12 00 03    JNZ     loc_0003
0165: 18 01 63    CMPI    r1, 0x63
0168: 12 00 03    JNZ     loc_0003
016B: 1F 00 15    LDI_IN  r0, 0x15
016E: 1F 01 16    LDI_IN  r1, 0x16
0171: 03 01 00    SUB     r1, r0
0174: 18 01 03    CMPI    r1, 0x03
0177: 12 00 03    JNZ     loc_0003
017A: 1F 01 10    LDI_IN  r1, 0x10
017D: 08 01 02    ADDI    r1, 0x02
0180: 17 01 00    CMP     r1, r0
0183: 12 00 03    JNZ     loc_0003
0186: 1F 00 18    LDI_IN  r0, 0x18
0189: 18 00 7D    CMPI    r0, 0x7D
018C: 12 00 03    JNZ     loc_0003
018F: 1F 00 19    LDI_IN  r0, 0x19
0192: 18 00 00    CMPI    r0, 0x00
0195: 12 00 03    JNZ     loc_0003
0198: 07 00 80    MOVI    r0, 0x80
019B: 15 00       PUSH    r0
019D: 00          NOP
019E: 13 00 5D    CALL    loc_005D
01A1: 16 00       POP     r0
01A3: 00          NOP
01A4: 09 00 01    SUBI    r0, 0x01
01A7: 12 01 9B    JNZ     loc_019B
01AA: 10 00 2A    JMP     loc_002A
01AD: FF          DB      0xFF   ; unknown
01AE: 00          NOP
01AF: 00          NOP
</code></pre>
<p>â€‹	å…·ä½“å¦‚ä½•è§£å¯†å‡º flag è¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œå¹¶ä¸å¤æ‚ã€‚flagï¼šflag{HITCTF2025_287ec47c}</p>
<h3 id="ä¸‰ã€ç»“è¯­"><a href="#ä¸‰ã€ç»“è¯­" class="headerlink" title="ä¸‰ã€ç»“è¯­"></a>ä¸‰ã€ç»“è¯­</h3><p>â€‹	ç»“åˆ AI å†™ä¸‹æ¥æ„Ÿè§‰ä¹Ÿè¿˜å¥½ï¼Œè¿™ä¸¤é¢˜è›®é€‚åˆ vm å…¥é—¨ã€‚</p>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 1621925986@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">ğŸ’°</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23lif2sndX4YqUPQwk',
            clientSecret: 'c76a4c487d51bf36e4dd1496b3f44bdbea037d50',
            repo: 'NshIdE1.github.io',
            owner: 'NshIdE1',
            admin: ['NshIdE1'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2024-2025 NshIdE
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">Ã—</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="æ‰«ç æ”¯æŒ">
            <img src="/img/weixin.jpg" class="weixin" title="æ‰«ç æ”¯æŒ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    

    
</style>







</html>
