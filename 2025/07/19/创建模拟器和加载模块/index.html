<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å— | NshIdE&#39;s Home</title>
  <meta name="keywords" content=" Unidbg ">
  <meta name="description" content="åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å— | NshIdE&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="categories">
<meta property="og:url" content="https://nshide1.github.io/categories/">
<meta property="og:site_name" content="NshIdE&#39;s Home">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-03-04T12:19:41.475Z">
<meta property="article:modified_time" content="2025-03-04T12:19:41.475Z">
<meta property="article:author" content="NshIdE">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/logo.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/logo.jpg"/>
</a>
<div class="author">
    <span>NshIdE</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/NshIdE1/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://www.csdn.net/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=1621925986&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(42)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="å…¶ä»–">
            
            å…¶ä»–
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Android-RE">
            
            Android-RE
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Androidå­¦ä¹ ">
            
            Androidå­¦ä¹ 
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Angrå…¥é—¨">
            
            Angrå…¥é—¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="CTF">
            
            CTF
            <small>(16)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Fridaå…¥é—¨">
            
            Fridaå…¥é—¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Javaå­¦ä¹ ">
            
            Javaå­¦ä¹ 
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Unidbgå­¦ä¹ ">
            
            Unidbgå­¦ä¹ 
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="42">
<input type="hidden" id="yelog_site_word_count" value="231.8k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://bananashipsbbq.github.io/">bananaships</a></li>
            
            <li><a target="_blank" href="https://astralprisma.github.io/">AstralPrisma</a></li>
            
            <li><a target="_blank" href="https://monoceros406.github.io/">Monoceros406</a></li>
            
            <li><a target="_blank" href="https://github.com/Thir0th">Thir0th</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æŠ½è±¡</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ç¬¦å·æ‰§è¡Œ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å–è¯</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å®æˆ˜</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åº”æ€¥å“åº”</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Frida</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>go</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Harmony</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>il2Cpps</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>iOS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ISW</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SIMD</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unidbg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unity</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>WritesUp</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All CTF "
           href="/2026/01/04/HitCTF2025-Reverse%C2%B7VM/"
           data-tag="CTF,RE,WritesUp,vm"
           data-author="" >
            <span class="post-title" title="HitCTF2025-ReverseÂ·VM">HitCTF2025-ReverseÂ·VM</span>
            <span class="post-date" title="2026-01-04 16:19:02">2026/01/04</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/11/03/%E6%9F%90%E9%BB%91%E7%9B%92%20App%20%E7%99%BB%E5%BD%95%E5%8F%82%E6%95%B0%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"
           data-tag="Android,å®æˆ˜"
           data-author="" >
            <span class="post-title" title="æŸé»‘ç›’ App ç™»å½•å‚æ•°é€†å‘åˆ†æ">æŸé»‘ç›’ App ç™»å½•å‚æ•°é€†å‘åˆ†æ</span>
            <span class="post-date" title="2025-11-03 16:15:21">2025/11/03</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/10/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%BC%BA%E7%BD%91%C2%B7%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android,il2Cpps"
           data-author="" >
            <span class="post-title" title="ç¬¬å…«å±Šå¼ºç½‘Â·æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›">ç¬¬å…«å±Šå¼ºç½‘Â·æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›</span>
            <span class="post-date" title="2025-10-25 17:31:37">2025/10/25</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/10/22/Android%20APP%20%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android APP å¸¸è§æ¼æ´">Android APP å¸¸è§æ¼æ´</span>
            <span class="post-date" title="2025-10-22 17:06:07">2025/10/22</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/10/10/%E4%BB%8E%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20PackageInfo%20%E5%92%8C%20LoadedApk/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="ä»æºç åˆ†æ PackageInfo å’Œ LoadedApk">ä»æºç åˆ†æ PackageInfo å’Œ LoadedApk</span>
            <span class="post-date" title="2025-10-10 18:15:17">2025/10/10</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/09/09/2025%E5%B9%B4%E6%B9%BE%E5%8C%BA%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%88%9D%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025å¹´æ¹¾åŒºæ¯ç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›">2025å¹´æ¹¾åŒºæ¯ç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›</span>
            <span class="post-date" title="2025-09-09 09:34:17">2025/09/09</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/09/08/Android%20SO%20%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android SO æ–‡ä»¶åŠ è½½è¿‡ç¨‹">Android SO æ–‡ä»¶åŠ è½½è¿‡ç¨‹</span>
            <span class="post-date" title="2025-09-08 17:18:50">2025/09/08</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/25/Dex%20%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Dex æ–‡ä»¶ç»“æ„å­¦ä¹ ">Dex æ–‡ä»¶ç»“æ„å­¦ä¹ </span>
            <span class="post-date" title="2025-08-25 17:33:29">2025/08/25</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/ClassLoader%20%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="ClassLoader æœºåˆ¶">ClassLoader æœºåˆ¶</span>
            <span class="post-date" title="2025-08-19 17:42:51">2025/08/19</span>
        </a>
        
        
        <a  class="All Javaå­¦ä¹  "
           href="/2025/08/19/Java%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="Javaå­¦ä¹ ----åå°„æœºåˆ¶">Javaå­¦ä¹ ----åå°„æœºåˆ¶</span>
            <span class="post-date" title="2025-08-19 17:00:02">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/Android%20%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android åº”ç”¨å¯åŠ¨æµç¨‹">Android åº”ç”¨å¯åŠ¨æµç¨‹</span>
            <span class="post-date" title="2025-08-19 11:14:13">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/%E5%AE%89%E5%8D%93%E5%8A%A0%E5%9B%BA%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="å®‰å“åŠ å›ºå­¦ä¹ è®°å½•">å®‰å“åŠ å›ºå­¦ä¹ è®°å½•</span>
            <span class="post-date" title="2025-08-19 10:50:46">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/14/Android%20%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94NDK%20%E5%BC%80%E5%8F%91/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android å¼€å‘--NDK å¼€å‘">Android å¼€å‘--NDK å¼€å‘</span>
            <span class="post-date" title="2025-08-14 17:56:58">2025/08/14</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/08/10/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%85%AD)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å…­)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å…­)</span>
            <span class="post-date" title="2025-08-10 10:25:02">2025/08/10</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/08/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%94)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äº”)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äº”)</span>
            <span class="post-date" title="2025-08-08 17:45:59">2025/08/08</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/05/%E6%BC%AB%E8%B0%88%E5%94%AF%E4%B8%80%E8%AE%BE%E5%A4%87ID/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="æ¼«è°ˆå”¯ä¸€è®¾å¤‡ ID">æ¼«è°ˆå”¯ä¸€è®¾å¤‡ ID</span>
            <span class="post-date" title="2025-08-05 18:00:44">2025/08/05</span>
        </a>
        
        
        <a  class="All å…¶ä»– "
           href="/2025/07/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20Linux%20%E7%B3%BB%E7%BB%9F%E4%B8%8B%20proc%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"
           data-tag="Android,Linux"
           data-author="" >
            <span class="post-title" title="æµ…è°ˆ Linux ç³»ç»Ÿä¸‹ proc æ–‡ä»¶ç³»ç»Ÿå†…å®¹">æµ…è°ˆ Linux ç³»ç»Ÿä¸‹ proc æ–‡ä»¶ç³»ç»Ÿå†…å®¹</span>
            <span class="post-date" title="2025-07-24 17:56:57">2025/07/24</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/24/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%BA%8C%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(äºŒ)">Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(äºŒ)</span>
            <span class="post-date" title="2025-07-24 17:00:12">2025/07/24</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/07/23/2025%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B-%E5%88%9D%E8%B5%9B-%E5%AE%89%E5%8D%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E5%85%A8/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025ç¬¬åå±Šæ¸¸æˆå®‰å…¨ç«èµ›-åˆèµ›-å®‰å“å®¢æˆ·ç«¯å®‰å…¨">2025ç¬¬åå±Šæ¸¸æˆå®‰å…¨ç«èµ›-åˆèµ›-å®‰å“å®¢æˆ·ç«¯å®‰å…¨</span>
            <span class="post-date" title="2025-07-23 15:32:11">2025/07/23</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/19/%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%92%8C%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—">åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—</span>
            <span class="post-date" title="2025-07-19 15:14:29">2025/07/19</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/15/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%B8%80%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(ä¸€)">Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(ä¸€)</span>
            <span class="post-date" title="2025-07-15 16:52:06">2025/07/15</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%9B%9B)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å››)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å››)</span>
            <span class="post-date" title="2025-07-08 11:44:49">2025/07/08</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/01/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%89)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)</span>
            <span class="post-date" title="2025-07-01 15:29:42">2025/07/01</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/06/07/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmonyCTF/"
           data-tag="CTF,RE,WritesUp,Harmony"
           data-author="" >
            <span class="post-title" title="ç¬¬ä¸€å±ŠOpenHarmonyCTF">ç¬¬ä¸€å±ŠOpenHarmonyCTF</span>
            <span class="post-date" title="2025-06-07 13:32:45">2025/06/07</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/06/04/%E8%A1%A5%E5%BA%93%E5%87%BD%E6%95%B0%EF%BC%88%E4%BA%94%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="è¡¥åº“å‡½æ•°(äº”)">è¡¥åº“å‡½æ•°(äº”)</span>
            <span class="post-date" title="2025-06-04 19:07:56">2025/06/04</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/06/02/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%8C)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äºŒ)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äºŒ)</span>
            <span class="post-date" title="2025-06-02 15:33:15">2025/06/02</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/31/D%5E3CTF2025/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="D^3CTF2025">D^3CTF2025</span>
            <span class="post-date" title="2025-05-31 16:21:11">2025/05/31</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/05/28/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%80)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸€)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸€)</span>
            <span class="post-date" title="2025-05-28 16:39:23">2025/05/28</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/17/Parloo2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="Parloo RE">Parloo RE</span>
            <span class="post-date" title="2025-05-17 09:34:20">2025/05/17</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/05/07/%E8%AE%B0%E4%B8%80%E6%AC%A1APK%E5%88%86%E6%9E%90/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="è®°ä¸€æ¬¡APKåˆ†æ">è®°ä¸€æ¬¡APKåˆ†æ</span>
            <span class="post-date" title="2025-05-07 21:12:00">2025/05/07</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/26/%E4%B8%80%E9%81%93%E5%BE%88%E9%80%86%E5%A4%A9%E7%9A%84RC4/"
           data-tag="CTF,RE,WritesUp,æŠ½è±¡"
           data-author="" >
            <span class="post-title" title="æŠ½è±¡RC4">æŠ½è±¡RC4</span>
            <span class="post-date" title="2025-04-26 22:21:19">2025/04/26</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/24/%E5%BE%88%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜">å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜</span>
            <span class="post-date" title="2025-04-24 21:56:18">2025/04/24</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/23/%E4%BA%AC%E9%BA%92CTF2025%20%E7%83%AD%E8%BA%AB%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,iOS,SIMD"
           data-author="" >
            <span class="post-title" title="äº¬éº’CTF2025çƒ­èº«èµ›">äº¬éº’CTF2025çƒ­èº«èµ›</span>
            <span class="post-date" title="2025-04-23 13:33:59">2025/04/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/14/TGCTF2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TGCTF2025 RE">TGCTF2025 RE</span>
            <span class="post-date" title="2025-04-14 18:51:29">2025/04/14</span>
        </a>
        
        
        <a  class="All Angrå…¥é—¨ "
           href="/2025/04/14/Angr%E5%85%A5%E9%97%A8/"
           data-tag="ç¬¦å·æ‰§è¡Œ"
           data-author="" >
            <span class="post-title" title="Angrå…¥é—¨">Angrå…¥é—¨</span>
            <span class="post-date" title="2025-04-14 18:50:44">2025/04/14</span>
        </a>
        
        
        <a  class="All Fridaå…¥é—¨ "
           href="/2025/04/14/Frida%E5%85%A5%E9%97%A8/"
           data-tag="Android,Frida"
           data-author="" >
            <span class="post-title" title="Fridaå…¥é—¨">Fridaå…¥é—¨</span>
            <span class="post-date" title="2025-04-14 18:47:37">2025/04/14</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/12/TEXSAWCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TEXSAWCTF 2025">TEXSAWCTF 2025</span>
            <span class="post-date" title="2025-04-12 15:32:31">2025/04/12</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/23/NCTF2024/"
           data-tag="CTF,RE,WritesUp,vm,go"
           data-author="" >
            <span class="post-title" title="NCTF2024">NCTF2024</span>
            <span class="post-date" title="2025-03-23 11:58:53">2025/03/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/18/CISCN%20x%20CCB%20%E5%8D%8A%E5%86%B3%E8%B5%9B%202025%20ISW(%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94)/"
           data-tag="ISW,åº”æ€¥å“åº”,å–è¯"
           data-author="" >
            <span class="post-title" title="CISCN x CCB åŠå†³èµ› 2025 ISW(åº”æ€¥å“åº”)">CISCN x CCB åŠå†³èµ› 2025 ISW(åº”æ€¥å“åº”)</span>
            <span class="post-date" title="2025-03-18 10:24:23">2025/03/18</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/11/TPCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TPCTF 2025">TPCTF 2025</span>
            <span class="post-date" title="2025-03-11 21:41:19">2025/03/11</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/06/VishwaCTF2025/"
           data-tag="CTF,RE,WritesUp,Android,Unity"
           data-author="" >
            <span class="post-title" title="VishwaCTF2025">VishwaCTF2025</span>
            <span class="post-date" title="2025-03-06 21:52:51">2025/03/06</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/03/HGAME%20RE/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="HGAME-RE-WEEK1">HGAME-RE-WEEK1</span>
            <span class="post-date" title="2025-03-03 22:20:33">2025/03/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="Unidbgå­¦ä¹ ">Unidbgå­¦ä¹ </a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color2">Unidbg</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-07-19 16:24:41'>2025-07-19 15:14</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:4.2k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%92%8C%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-text">åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80"><span class="toc-text">ä¸€ã€å¼•è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%8B%9F%E5%99%A8"><span class="toc-text">äºŒã€åˆ›å»ºæ¨¡æ‹Ÿå™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E4%BD%8D%E6%95%B0%E4%B8%8E%E6%9E%B6%E6%9E%84"><span class="toc-text">2.1 ä½æ•°ä¸æ¶æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E8%BF%9B%E7%A8%8B%E5%90%8D"><span class="toc-text">2.2 è¿›ç¨‹å</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%90%8E%E7%AB%AF"><span class="toc-text">2.3 åç«¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4%E6%A0%B9%E7%9B%AE%E5%BD%95"><span class="toc-text">2.4æ ¹ç›®å½•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-PID"><span class="toc-text">2.5 PID</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-%E5%BC%80%E5%90%AF%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="toc-text">2.6 å¼€å¯å¤šçº¿ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-text">ä¸‰ã€åŠ è½½æ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-text">3.1 åŠ è½½æ¨¡å—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-text">3.2åŠ è½½æ¨¡å—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E5%8A%A0%E8%BD%BD%E4%BE%9D%E8%B5%96%E6%A8%A1%E5%9D%97"><span class="toc-text">3.3 åŠ è½½ä¾èµ–æ¨¡å—</span></a></li></ol></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—"><a href="#åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—" class="headerlink" title="åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—"></a>åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—</h1><h3 id="ä¸€ã€å¼•è¨€"><a href="#ä¸€ã€å¼•è¨€" class="headerlink" title="ä¸€ã€å¼•è¨€"></a>ä¸€ã€å¼•è¨€</h3><p>æœ¬ç¯‡è®¨è®ºä¸¤ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„çŸ¥è¯†å’Œç”¨æ³•</p>
<h3 id="äºŒã€åˆ›å»ºæ¨¡æ‹Ÿå™¨"><a href="#äºŒã€åˆ›å»ºæ¨¡æ‹Ÿå™¨" class="headerlink" title="äºŒã€åˆ›å»ºæ¨¡æ‹Ÿå™¨"></a>äºŒã€åˆ›å»ºæ¨¡æ‹Ÿå™¨</h3><p>åœ¨åˆ›å»ºæ¨¡æ‹Ÿå™¨æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡å»ºé€ è€…æ¨¡å¼å¯¹æ¨¡æ‹Ÿå™¨çš„æ–¹æ–¹é¢é¢è¿›è¡Œé…ç½®ã€‚</p>
<pre><code class="language-Java">private static AndroidEmulator createARMEmulator() &#123;
    return AndroidEmulatorBuilder.for32Bit()
            .setProcessName(&quot;com.sun.jna&quot;)
            .addBackendFactory(new DynarmicFactory(true))
            .build();
&#125;
</code></pre>
<h4 id="2-1-ä½æ•°ä¸æ¶æ„"><a href="#2-1-ä½æ•°ä¸æ¶æ„" class="headerlink" title="2.1 ä½æ•°ä¸æ¶æ„"></a>2.1 ä½æ•°ä¸æ¶æ„</h4><p>Unidbg ä¸æ”¯æŒ X86 å’Œ Mipsæ¶æ„ï¼Œæ‰€ä»¥ <strong>for32Bit</strong> å’Œ <strong>for64Bit</strong> æ„å‘³ç€æ˜¯ ARM32 å’Œ ARM64.</p>
<pre><code class="language-Java">if (emulator.is32Bit() &amp;&amp; elfFile.arch != ElfFile.ARCH_ARM) &#123;
    throw new ElfException(&quot;Must be ARM arch.&quot;);
&#125;

if (emulator.is64Bit() &amp;&amp; elfFile.arch != ElfFile.ARCH_AARCH64) &#123;
    throw new ElfException(&quot;Must be ARM64 arch.&quot;);
&#125;
</code></pre>
<p>å¦‚æœæ ·æœ¬æ—¢æä¾›äº† ARM32ï¼Œä¹Ÿæä¾›äº† ARM64 çš„åŠ¨æ€åº“ï¼Œé‚£ä¹ˆä½ å¯ä»¥æ ¹æ®ä¸ªäººå–œå¥½åšé€‰æ‹©ã€‚ä»Unidbg çš„è§’åº¦è®²ï¼Œæœ‰ä¸¤ä¸ªå› ç´ ä½ å¯ä»¥è€ƒè™‘</p>
<ol>
<li>æ˜¯æ‰§è¡Œé€Ÿåº¦ï¼ŒARM64 ç›¸æ¯” ARE32 ä¼šå¿« 10% ä¸Šä¸‹ã€‚</li>
<li>æ˜¯å®Œå–„ç¨‹åº¦ï¼Œåœ¨è¿‡å»å‡ å¹´ï¼Œå‡ºäºèŠ‚çœåŒ…ä½“ç§¯ã€å…¼å®¹é€‚é…ç­‰åŸå› ï¼Œç»å¤§å¤šæ•°æ ·æœ¬åªæä¾› ARM32 çš„åŠ¨æ€åº“ï¼Œå¯¼è‡´ Unidbg å¯¹ ARM32 çš„å®Œå–„ç¨‹åº¦æ›´å¥½ä¸€äº›ï¼Œè¿™ä½“ç°åœ¨ JNI ç­‰å¤šæ–¹é¢ã€‚</li>
</ol>
<p>é¢å‘æœªæ¥å»ºè®®é€‰ ARM64 ï¼Œé¢å‘å½“ä¸‹é€‰ ARM32ã€‚</p>
<h4 id="2-2-è¿›ç¨‹å"><a href="#2-2-è¿›ç¨‹å" class="headerlink" title="2.2 è¿›ç¨‹å"></a>2.2 è¿›ç¨‹å</h4><p>setProcessName ç”¨äºè®¾ç½® App è¿›ç¨‹åï¼Œå¾ˆå¤šäººä¼šå¿½ç•¥è¿™ä¸€è®¾ç½®ï¼Œä½†æœ€å¥½è®¾ç½®ä¸€ä¸‹ï¼Œå¦åˆ™ä¼šå¸¦æ¥é£é™©ã€‚å› ä¸ºæ ·æœ¬å¯ä»¥åœ¨ä»£ç ä¸­é€šè¿‡ getProgname å‡½æ•°è·å–è¿›ç¨‹åã€‚</p>
<pre><code class="language-c">// function in libc.so
__int64 getprogname()
&#123;
  return _progname;
&#125;
</code></pre>
<p>å¦‚æœé€šè¿‡ setProcessName è®¾ç½®äº†è¿›ç¨‹åï¼Œé‚£ä¹ˆgetProgname ä¼šè¿”å›ä½ æ‰€è®¾ç½®çš„è¿›ç¨‹åï¼Œè€Œå¦‚æœä¸è®¾ç½®è¿›ç¨‹åï¼ŒUnidbg ä¼šè®¾ç½®è¿›ç¨‹åä¸ºè‡ªèº«ï¼Œè¿™å¯ä¸æ˜¯å¾ˆå¦™ã€‚</p>
<pre><code class="language-Java">this.processName = processName == null ? &quot;unidbg&quot; : processName;
</code></pre>
<h4 id="2-3-åç«¯"><a href="#2-3-åç«¯" class="headerlink" title="2.3 åç«¯"></a>2.3 åç«¯</h4><p><strong>addBackendFactory</strong> ç”¨äºè®¾ç½®åç«¯æ‰§è¡Œå¼•æ“ï¼Œä¸€èˆ¬è®¡ç®—æœºçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1663811081116-b380d5b8-bc2f-470b-8c7c-04d644ac8c2b.png" alt="image.png"></p>
<p>Unidbg ä¸­ç»“æ„å¦‚ä¸‹<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1663811101807-2f1e0030-eb9a-4169-ac60-cdacc1a7b442.png" alt="image.png"></p>
<p>Unidbg æ‰®æ¼”çš„è§’è‰²å°±æ˜¯æ“ä½œç³»ç»Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªå¾®å‹ã€æœ‰é™çš„ Linux æ“ä½œç³»ç»Ÿæ¨¡æ‹Ÿå™¨ã€‚</p>
<p>Backend æ‰®æ¼”çš„è§’è‰²æ˜¯å¤„ç†å™¨ï¼Œæ‰¿æ‹…æ¨¡æ‹Ÿæ‰§è¡Œæœºå™¨æŒ‡ä»¤çš„ä»»åŠ¡ã€‚<strong>addBackendFactory</strong> ç”¨äºè®¾ç½®ä½¿ç”¨å“ªä¸€ä¸ªåç«¯ï¼Œå› ä¸º Unidbg æ”¯æŒå¤šä¸ª Backendã€‚Backend çš„é€‰æ‹©ç›´æ¥å½±å“ç€ Unidbg çš„èƒ½åŠ›è¾¹ç•Œå’Œæ¨¡æ‹Ÿæ‰§è¡Œçš„æ•ˆç‡ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†å†…å®¹å¾ˆé‡è¦ï¼Œæˆ‘ä»¬éœ€è¦å¤šåšä¸€äº›äº†è§£ã€‚</p>
<p>Unidbg ç›®å‰æ”¯æŒäº”ä¸ª Backendï¼Œåˆ†åˆ«æ˜¯ Unicornã€Unicorn2ã€Dynarmicã€Hypervisorã€KVMã€‚å¦‚æœä¸æ·»åŠ BackendFactoryï¼Œé»˜è®¤ä½¿ç”¨ Unicorn Backendï¼Œä»£ç é€»è¾‘å¦‚ä¸‹</p>
<pre><code class="language-Java">public static Backend createBackend(Emulator&lt;?&gt; emulator, boolean is64Bit, Collection&lt;BackendFactory&gt; backendFactories) &#123;
    if (backendFactories != null) &#123;
        for (BackendFactory factory : backendFactories) &#123;
            Backend backend = factory.newBackend(emulator, is64Bit);
            if (backend != null) &#123;
                return backend;
            &#125;
        &#125;
    &#125;
    // é»˜è®¤ä½¿ç”¨ Unicornåç«¯
    return new UnicornBackend(emulator, is64Bit);
&#125;
</code></pre>
<p>â€‹      äº‹å®ä¸Šï¼ŒUnicorn ä¹Ÿæ˜¯ Unidbg æ—©å…ˆå”¯ä¸€çš„åç«¯ï¼ŒUnidbg è¿™ä¸€å‘½åç”šè‡³éƒ½å¯èƒ½æ˜¯ Unicorn Debugger çš„ç¼©å†™ã€‚ä¸‹é¢æˆ‘ä»¬ç®€å•è®¨è®º Unidbg Backend çš„å‘å±•å†å²ã€‚</p>
<p>â€‹       Unicorn ä½œä¸ºè¿™äº›å¹´æœ€ç‚™æ‰‹å¯çƒ­çš„ CPU æ¨¡æ‹Ÿå™¨ï¼Œå½“ä¹‹æ— æ„§æ˜¯æ‰€æœ‰åç«¯ä¸­åŠŸèƒ½æœ€å…¨é¢ä¹Ÿæ˜¯æœ€å¼ºå¤§çš„é‚£ä¸ªï¼Œåœ¨ Unicorn2 å‘å¸ƒåï¼Œè¿™ä¸€ç§°å·å°±åˆ°äº† Unicorn2 å¤´ä¸Šã€‚</p>
<p>â€‹        é‚£ä¹ˆä¸ºä»€ä¹ˆ Unidbg è¦å¼•å…¥å…¶ä»–åç«¯ï¼ŸèƒŒååŸå› ä¹Ÿå¾ˆç®€å•â€”â€”Unicorn æ‰§è¡Œé€Ÿåº¦å¤ªæ…¢äº†ã€‚Unidbg çš„è®¾è®¡åˆè¡·æ˜¯åˆ©ç”¨ Unicorn æ‰€æä¾›çš„å„ç§å¼ºå¤§ Hookï¼Œè¾…åŠ©å’ŒåŠ é€Ÿ Android Native ç®—æ³•åˆ†æï¼Œé‚£ä¹ˆæ‰§è¡Œç™¾ä¸‡è¡Œæ±‡ç¼–è€—æ—¶ 1s è¿˜æ˜¯ 1ms å®Œå…¨æ— è¶³è½»é‡ï¼Œè¿™ä¸ªæ—¶å€™ Unidbg çš„ä¸»è¦ç”¨å¤„å°±æ˜¯è°ƒè¯• SOï¼Œæ²¡æœ‰äººåœ¨æ„è°ƒè¯•å™¨çš„é€Ÿåº¦ã€‚</p>
<p>â€‹        ä½†åœ¨ Unidbg å¼€æºå¹¶å¾—åˆ°å¹¿æ³›å…³æ³¨åï¼Œè¿™ä¸€æƒ…å†µå‘ç”Ÿäº†æ”¹å˜ã€‚Unidbg å¯ä»¥å¾ˆå¥½çš„æ¨¡æ‹Ÿæ‰§è¡Œç›®æ ‡å‡½æ•°ï¼Œä¸ä¾èµ–äºçœŸå®è®¾å¤‡ï¼Œå‚æ•°å’Œè®¾å¤‡ä¿¡æ¯å¯ä»¥è½»æ¾é…ç½®ç­‰ç‰¹å¾ï¼Œå¸å¼•äº†å¤§æ‰¹çš„çˆ¬è™«ä¹ƒè‡³é»‘ç°äº§ä»ä¸šäººå‘˜ï¼Œä»–ä»¬å°† Unidbg å•çº¯ç”¨åœ¨è·‘ç®—æ³•ä¸Šã€‚ç›¸æ¯”åŸºäºçœŸæœºçš„å„ç§è¿œç¨‹è°ƒç”¨ï¼Œæ—¢ä¸éœ€è¦è´­ä¹°å¤§é‡çœŸæœº&#x2F;äº‘æ‰‹æœºï¼Œä¹Ÿä¸éœ€è¦è´­ä¹°ä¸€é”®æ–°æœºçš„è½¯ä»¶ï¼Œååˆ†å¥½ç”¨ã€‚</p>
<p>â€‹        è¿™ä¸€ç”¨é€”å¾ˆå¿«æˆä¸º Unidbg çš„æœ€ä¸»è¦ç”¨é€”ï¼Œé‚£ä¹ˆç›¸æ¯”äºåŸºäºçœŸæœº RPC çš„å„ç§æ–¹æ¡ˆï¼ŒUnidbg çš„æ‰§è¡Œé€Ÿåº¦å°±æˆäº†æœ€å¤§çš„çŸ­æ¿ï¼Œå¿«å’Œæ…¢çš„æºå¤´å°±æ˜¯åº•å±‚çš„æŒ‡ä»¤æ‰§è¡Œå¼•æ“ã€‚Unicorn Backend æ‰§è¡ŒæŒ‡ä»¤å®åœ¨å¤ªæ…¢äº†ï¼Œç”šè‡³éƒ½æ¯”ä¸è¿‡ Android 4.0 çš„è€è®¾å¤‡ï¼Œè¿™æ„å‘³ç€åœ¨æ¨¡æ‹Ÿæ‰§è¡Œå¤æ‚å‡½æ•°å’Œæµç¨‹æ—¶ï¼Œå•æ¬¡æ‰§è¡Œè€—æ—¶åœ¨æ•°ç§’ä»¥ä¸Šï¼Œè¿™ä¸¥é‡å½±å“äº† Unidbg åœ¨è¿™ä¸€ç”¨é€”ä¸Šçš„ä½¿ç”¨ã€‚</p>
<p>â€‹        å› æ­¤ Unidbg å¼•å…¥äº† <a target="_blank" rel="noopener" href="https://github.com/merryhime/dynarmic">Dynarmic</a> ä½œä¸ºå¯é€‰åç«¯ï¼Œå®ƒæ˜¯å¦ä¸€æ¬¾ CPU æ¨¡æ‹Ÿå™¨ï¼Œåœ¨æ‰§è¡Œé€Ÿåº¦ä¸Šæ¯” Unicorn å¿«äº†ä¸æ­¢ä¸€ä¸ªæ•°é‡çº§ã€‚ä½†å®ƒåœ¨å¯ä»¥å¯¹æ¯”çš„æ‰€æœ‰å…¶ä»–ç»´åº¦ä¸Šéƒ½æ¯” Unicorn å¼±ï¼Œæ¯”å¦‚ä¸æ”¯æŒå„ç§å„æ ·çš„ Hookï¼Œæ¯”å¦‚æ”¯æŒæŒ‡ä»¤çš„èŒƒå›´ã€æ¶æ„çš„å¹¿åº¦ç­‰ç­‰ã€‚ä½¿ç”¨ Dynarmic å¼•æ“ï¼ŒUnidbg åœ¨ debugger ä¸Šçš„èƒ½åŠ›åä¸ä½™ä¸€ï¼Œè¾…åŠ©ç®—æ³•åˆ†æçš„èƒ½åŠ›å¤§å¤§é™ä½ã€‚</p>
<p>â€‹       å¦‚æœä½ ä½¿ç”¨ Unidbg çš„æ„å›¾æ˜¯ç®—æ³•è¿˜åŸï¼Œé‚£ä¹ˆå»ºè®®ä½¿ç”¨ Unicorn2 åç«¯ã€‚</p>
<pre><code class="language-Java">emulator = AndroidEmulatorBuilder.for32Bit()
        .addBackendFactory(new Unicorn2Factory(false))
        .setProcessName(&quot;test&quot;)
        .build();
</code></pre>
<p>â€‹        å„ç§ BackendFactory çš„æ„é€ æ–¹æ³•éƒ½è¦ä¼ å…¥<strong>fallbackUnicorn</strong>å‚æ•°ï¼Œå®ƒè¡¨ç¤ºå¦‚æœè¿™ä¸ªåç«¯åˆ›å»ºå¤±è´¥æ—¶å¦‚ä½•å¤„ç†ã€‚</p>
<pre><code class="language-Java">private Backend newBackend(Emulator&lt;?&gt; emulator, boolean is64Bit) &#123;
    try &#123;
        return newBackendInternal(emulator, is64Bit);
    &#125; catch (Throwable e) &#123;
        if (fallbackUnicorn) &#123;
            return null;
        &#125; else &#123;
            throw e;
        &#125;
    &#125;
&#125;
</code></pre>
<p>â€‹        å¦‚æœè®¾ç½®ä¸º falseï¼Œé‚£ä¹ˆ backend åˆ›å»ºå¤±è´¥æ—¶ç›´æ¥æŠ¥é”™ï¼›è®¾ç½®ä¸º trueï¼Œè¿”å› nullï¼Œæœ€ç»ˆä½¿ç”¨é»˜è®¤çš„ Unicorn Backendã€‚</p>
<p>â€‹        ç›¸æ¯”è¾ƒ Unicorn åç«¯ï¼ŒUnidbg åŸºäº Unicorn2 åç«¯è®¾è®¡å’Œå¤„ç†äº†å¤šçº¿ç¨‹çš„ç›¸å…³é€»è¾‘ï¼Œå› æ­¤åœ¨ Unicorn å’Œ Unicorn2 ä¹‹é—´ï¼Œåº”è¯¥é€‰æ‹© Unicorn 2ã€‚</p>
<p>â€‹        å¦‚æœä½ ä½¿ç”¨ Unidbg çš„æ„å›¾æ˜¯æ¨¡æ‹Ÿæ‰§è¡Œï¼Œæ›¿ä»£ RPCï¼Œé‚£ä¹ˆä½ ä»ç„¶åº”è¯¥å…ˆè¯• Unicorn2 åç«¯ï¼Œå› ä¸º Unicorn2 åœ¨æ¨¡æ‹Ÿæ‰§è¡ŒæŒ‡ä»¤ä¸Šçš„èƒ½åŠ›æ›´å¼ºï¼Œå¦‚æœ Unicorn2 æœ€ç»ˆèƒ½é¡ºåˆ©è·‘é€šã€è·‘å‡ºé¢„æœŸç»“æœï¼Œå†åˆ‡æ¢ä¸º Dynarmic çœ‹æ˜¯å¦ä¹Ÿèƒ½å¤„ç†æˆåŠŸï¼Œå¦‚æœ Unicorn2 è·‘ä¸é€šï¼Œé‚£ä¹ˆ Dynarmic å¼•æ“ä¹Ÿå¿…ç„¶æ— æ³•æˆåŠŸã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œä½¿ç”¨ Dynarmic å¼•æ“æ—¶ï¼Œä¸å¯ä½¿ç”¨åŸºäº Unicorn çš„ å„ç§ Hookï¼Œè€Œåº”è¯¥ç”¨å†…ç½®é€‚é…çš„ HookZzã€xHook ç­‰æ¡†æ¶ã€‚</p>
<pre><code class="language-java">emulator = AndroidEmulatorBuilder.for32Bit()
    //.addBackendFactory(new Unicorn2Factory(false))
    .addBackendFactory(new DynarmicFactory(true))
    .setProcessName(&quot;test&quot;)
    .build();
</code></pre>
<p>â€‹        å…³äºæ‰§è¡Œé€Ÿåº¦å’Œåº”ç”¨å®è·µï¼Œè¿™é‡Œå†å¤šè°ˆä¸€äº›ã€‚é¦–å…ˆï¼ŒUnicorn å’Œ Unicorn2 åœ¨æ¨¡æ‹Ÿæ‰§è¡Œé€Ÿåº¦ä¸Šå·®å¼‚ä¸å¤§ï¼Œä½†å› ä¸ºå¤šçº¿ç¨‹ä»¥åŠç”¨æ–°ä¸ç”¨æ—§çš„åŸå› ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ Unicorn2ã€‚å…¶æ¬¡ï¼ŒUnicornã€Dynarmicã€çœŸæœºè¿™ä¸‰è€…åœ¨æ‰§è¡Œé€Ÿåº¦ä¸Šå·®å¼‚æœ‰å¤šå¤§ï¼Œè¯»è€…åº”è¯¥æœ‰ä¸€ä¸ªç›´è§‚çš„æ„Ÿå—ã€‚Unicorn æœ€æ…¢ï¼ŒDynarmic æ¯” Unicorn å¿« 50 - 100 å€ï¼ŒçœŸæœºæ¯” Dynarmic å¿« 5 - 30 å€ï¼Œå› æ­¤æµ‹è¯•æœºæ€§èƒ½å·®å¼‚å¾ˆå¤§ã€‚æœ€åï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œå…‰ç”¨ Dynarmic æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜ä¼šæ­é… unidbg-boot-serverã€‚</p>
<p>â€‹       è¯´å®Œ Unicorn&#x2F;Unicorn2&#x2F;Dynarmic è¿™ä¸‰ä¸ª Backendï¼Œæˆ‘ä»¬å†ç®€å•ä»‹ç»å…¶ä»–ä¸¤ä¸ªã€‚KVM å’Œ Hypervisor éƒ½æ˜¯è™šæ‹ŸåŒ–è€Œéæ¨¡æ‹Ÿæ‰§è¡Œæ–¹æ¡ˆï¼Œæ‰€ä»¥å¯¹å®¿ä¸»æœºæœ‰è¾ƒé«˜è¦æ±‚ï¼ŒKVM å¯ç”¨äº Raspberry Pi B4 ç­‰ç¯å¢ƒ ï¼Œé€Ÿåº¦å¿«ã€‚Hypervisor æ˜¯ Mac M1ä¸Šçš„è™šæ‹ŸåŒ–æ–¹æ¡ˆï¼Œæ˜¯ Unidbg ä¸Šæœ€å¿«çš„åç«¯ã€‚KVM å’Œ Hypervisor éƒ½å¾ˆå¿«å¾ˆå¿«ï¼Œä½†å—åˆ¶äºå®¿ä¸»æœºè®¾å¤‡é™åˆ¶ï¼Œåœ¨ Unidbg å®é™…ä½¿ç”¨ä¸­ä¸å¤šè§ã€‚</p>
<h4 id="2-4æ ¹ç›®å½•"><a href="#2-4æ ¹ç›®å½•" class="headerlink" title="2.4æ ¹ç›®å½•"></a>2.4æ ¹ç›®å½•</h4><p><strong>setRootDir</strong> ç”¨äºè®¾ç½®è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ï¼Œåœ¨ä½œç”¨ä¸Šå®ƒç­‰ä»·äº Android çš„æ ¹ç›®å½•</p>
<pre><code class="language-Java">emulator = AndroidEmulatorBuilder.for32Bit()
        .setProcessName(executable.getName())
        .setRootDir(new File(&quot;target/rootfs&quot;))
        .addBackendFactory(new DynarmicFactory(true))
        .build();
</code></pre>
<p>â€‹       å¦‚æœä½ è®¤ä¸ºç›®æ ‡å‡½æ•°å¯èƒ½ä¼šåšæ–‡ä»¶è®¿é—®æˆ–è¯»å†™æ“ä½œï¼Œé‚£ä¹ˆå»ºè®®ä¸»åŠ¨è®¾ç½®æ ¹ç›®å½•ã€‚å› ä¸ºå¦‚æœä¸åŠ ä»¥è®¾ç½®ï¼ŒUnidbg ä¼šåœ¨æœ¬æœºæŸä¸ªä¸´æ—¶ç›®å½•ä¸‹åˆ›å»ºæ ¹ç›®å½•ï¼Œåœ¨å°†é¡¹ç›®è¿ç§»åˆ°å…¶ä»–ç”µè„‘ä¸Šæ—¶å°±æ¯”è¾ƒéº»çƒ¦ã€‚æˆ‘ä»¬ä¸€èˆ¬å°†æ ¹ç›®å½•è®¾ç½®ä¸º target&#x2F;rootfs è¿™ä¸ªç›¸å¯¹è·¯å¾„ï¼Œä½¿å¾—æ½œåœ¨çš„æ–‡ä»¶ä¾èµ–ç¯å¢ƒåœ¨å½“å‰ Unidbg é¡¹ç›®é‡Œã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250719155217809.png" alt="image-20250719155217809"></p>
<h4 id="2-5-PID"><a href="#2-5-PID" class="headerlink" title="2.5 PID"></a>2.5 PID</h4><p>åœ¨ Unidbg ä¸­ï¼Œè¿›ç¨‹çš„ pid è¢«é»˜è®¤è®¾ç½®ä¸ºå½“å‰çš„ JVM çš„ IDã€‚çº¦æŸå…¶ä¸å¤§äº 0x7FFFï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å¯¹è€æ—§çš„è§„å®šï¼Œä½†æ— å…³ç—›ç—’ã€‚</p>
<pre><code class="language-Java">String name = ManagementFactory.getRuntimeMXBean().getName();
String pid = name.split(&quot;@&quot;)[0];
this.pid = Integer.parseInt(pid) &amp; 0x7fff;
</code></pre>
<p>ç†è®ºä¸Šï¼ŒUnidbg æœ€å¥½åœ¨åˆå§‹åŒ–æ—¶æä¾›ä¸€ä¸ª <strong>setPid</strong> æ–¹æ³•ï¼Œè®©ä½¿ç”¨è€…å¯ä»¥è®¾ç½® pidï¼Œè¿™ä¼šæœ‰åŠ©äºå¤„ç†è¿›ç¨‹ç›¸å…³çš„æ–‡ä»¶è®¿é—®ï¼Œä½†ç›®å‰ Unidbg å¹¶æ²¡æœ‰è¿™ä¹ˆåšã€‚</p>
<h4 id="2-6-å¼€å¯å¤šçº¿ç¨‹"><a href="#2-6-å¼€å¯å¤šçº¿ç¨‹" class="headerlink" title="2.6 å¼€å¯å¤šçº¿ç¨‹"></a>2.6 å¼€å¯å¤šçº¿ç¨‹</h4><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¼€å¯å¤šçº¿ç¨‹å¯ä»¥æ›´å¥½çš„å¤„ç†ç¨‹åºé€»è¾‘ã€‚Unidbg åªåœ¨ Unicorn2 Backend ä¸Šå®ç°äº†ç›¸å¯¹å®Œå–„çš„å¤šçº¿ç¨‹å¤„ç†é€»è¾‘ï¼Œé™¤äº†å°† Backend è®¾ç½®ä¸º Unicorn2 å¤–ï¼Œä½ è¿˜éœ€è¦åƒä¸‹é¢ä»£ç è¿™æ ·ï¼Œå¼€å¯è°ƒåº¦ä»¥åŠè®¾ç½®å¤šå°‘è¡Œåˆ‡æ¢ä¸€æ¬¡</p>
<pre><code class="language-Java">emulator = AndroidEmulatorBuilder.for32Bit()
        .addBackendFactory(new Unicorn2Factory(false))
        .setProcessName(&quot;test&quot;)
        .build();
// è®¾ç½®æ‰§è¡Œå¤šå°‘æ¡æŒ‡ä»¤åˆ‡æ¢ä¸€æ¬¡çº¿ç¨‹
emulator.getBackend().registerEmuCountHook(10000);
// å¼€å¯æ—¥å¿—
emulator.getSyscallHandler().setVerbose(true);
// å¼€å¯çº¿ç¨‹è°ƒåº¦å™¨
emulator.getSyscallHandler().setEnableThreadDispatcher(true);
</code></pre>
<h3 id="ä¸‰ã€åŠ è½½æ¨¡å—"><a href="#ä¸‰ã€åŠ è½½æ¨¡å—" class="headerlink" title="ä¸‰ã€åŠ è½½æ¨¡å—"></a>ä¸‰ã€åŠ è½½æ¨¡å—</h3><h4 id="3-1-åŠ è½½æ¨¡å—"><a href="#3-1-åŠ è½½æ¨¡å—" class="headerlink" title="3.1 åŠ è½½æ¨¡å—"></a>3.1 åŠ è½½æ¨¡å—</h4><p>Unidbg åœ¨åˆ›å»ºè™šæ‹Ÿæœºå¯¹è±¡çš„æ—¶å€™ï¼Œå¯ä»¥ä¼ å…¥ç”šè‡³æ˜¯å»ºè®®ä¼ å…¥ apk æ–‡ä»¶ï¼Œ</p>
<pre><code class="language-Java">//åˆ›å»ºè™šæ‹Ÿæœº
VM dalvikVM = emulator.createDalvikVM();
//åˆ›å»ºè™šæ‹Ÿæœºå¹¶æŒ‡å®šAPKæ–‡ä»¶
VM dalvikVM = emulator.createDalvikVM(new File(&quot;apk file path&quot;));
</code></pre>
<p>è¿™ä¸€è¡Œè®©å¾ˆå¤šäººè¯¯ä»¥ä¸º Unidbg ä¸æ˜¯ä¸€ä¸ª so æ¨¡æ‹Ÿå™¨ï¼Œè€Œæ˜¯ä¸€ä¸ª APK æ¨¡æ‹Ÿå™¨ï¼Œå°±åƒé›·ç”µæˆ–è€…å¤œç¥æ¨¡æ‹Ÿå™¨ã€‚å®é™…ä¸Šï¼Œ Unidbg åŠ è½½ apk å¹¶éè¦å»æ‰§è¡Œ dex ç”šè‡³ apk è¿™æ ·çš„å¤§äº‹ï¼Œç›¸åï¼Œå®ƒåªæ˜¯åœ¨åšä¸€äº›å°è€Œç¾çš„äº‹ã€‚</p>
<p>ä¸€æ˜¯è§£æ apk ä¿¡æ¯ï¼Œå‡å°‘ä½¿ç”¨è€…åœ¨è¡¥ JNI ç¯å¢ƒä¸Šçš„å·¥ä½œé‡ã€‚Unidbg ä¼šè§£æç‰ˆæœ¬åã€ç‰ˆæœ¬å·ã€åŒ…åç­‰ä¿¡æ¯ï¼Œå¦‚æœæ ·æœ¬ JNI è®¿é—®å’Œè·å–è¿™äº›ä¿¡æ¯ï¼ŒUnidbg ä¼šæ›¿æˆ‘ä»¬å¤„ç†ï¼Œä¸éœ€è¦æˆ‘ä»¬çƒ¦å¿ƒã€‚</p>
<pre><code class="language-Java">// versionName
if (&quot;android/content/pm/PackageInfo-&gt;versionName:Ljava/lang/String;&quot;.equals(signature) &amp;&amp;
        dvmObject instanceof PackageInfo) &#123;
    PackageInfo packageInfo = (PackageInfo) dvmObject;
    if (packageInfo.getPackageName().equals(vm.getPackageName())) &#123;
        String versionName = vm.getVersionName();
        if (versionName != null) &#123;
            return new StringObject(vm, versionName);
        &#125;
    &#125;
&#125;

// versionCode
if (&quot;android/content/pm/PackageInfo-&gt;versionCode:I&quot;.equals(signature)) &#123;
    return (int) vm.getVersionCode();
&#125;

// packageName
case &quot;android/app/Application-&gt;getPackageName()Ljava/lang/String;&quot;:
case &quot;android/content/ContextWrapper-&gt;getPackageName()Ljava/lang/String;&quot;:
case &quot;android/content/Context-&gt;getPackageName()Ljava/lang/String;&quot;: &#123;
    String packageName = vm.getPackageName();
    if (packageName != null) &#123;
        return new StringObject(vm, packageName);
    &#125;
    break;
&#125;
</code></pre>
<p>è¿›ä¸€æ­¥ï¼ŒUnidbg è¿˜ä¼šè§£æ APK ç­¾åï¼Œå¤„ç†ç­¾åæ ¡éªŒç›¸å…³çš„ JNI è°ƒç”¨ã€‚</p>
<pre><code class="language-Java">@Override
public CertificateMeta[] getSignatures() &#123;
    if (signatures != null) &#123;
        return signatures;
    &#125;

    try (net.dongliu.apk.parser.ApkFile apkFile = new net.dongliu.apk.parser.ApkFile(this.apkFile)) &#123;
        List&lt;CertificateMeta&gt; signatures = new ArrayList&lt;&gt;(10);
        for (ApkSigner signer : apkFile.getApkSingers()) &#123;
            signatures.addAll(signer.getCertificateMetas());
        &#125;
        this.signatures = signatures.toArray(new CertificateMeta[0]);
        return this.signatures;
    &#125; catch (IOException | CertificateException e) &#123;
        throw new IllegalStateException(e);
    &#125;
&#125;
</code></pre>
<p>å¤„ç† JNI ä¸­è·å–ç­¾åä¿¡æ¯çš„ API (åªä¸¾ä¾‹ä¸€å¤„)</p>
<pre><code class="language-Java">if (&quot;android/content/pm/PackageInfo-&gt;signatures:[Landroid/content/pm/Signature;&quot;.equals(signature) &amp;&amp;
        dvmObject instanceof PackageInfo) &#123;
    PackageInfo packageInfo = (PackageInfo) dvmObject;
    if (packageInfo.getPackageName().equals(vm.getPackageName())) &#123;
        CertificateMeta[] metas = vm.getSignatures();
        if (metas != null) &#123;
            Signature[] signatures = new Signature[metas.length];
            for (int i = 0; i &lt; metas.length; i++) &#123;
                signatures[i] = new Signature(vm, metas[i]);
            &#125;
            return new ArrayObject(signatures);
        &#125;
    &#125;
&#125;
</code></pre>
<p>å¦‚æœæ²¡æœ‰åŠ è½½ apkï¼Œè¿™äº› JNI è°ƒç”¨å°±éœ€è¦æˆ‘ä»¬å»è¡¥ï¼Œå¹³æ·»ä¸å°‘å·¥ä½œé‡ã€‚</p>
<p>äºŒæ˜¯å¯¹èµ„æºæ–‡ä»¶çš„å¤„ç†ï¼Œå¦‚æœåŠ è½½äº† apkï¼Œå°±å¯ä»¥åœ¨ Unidbg ä¸­è®¿é—® apk assets ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</p>
<pre><code class="language-Java">@Override
public byte[] openAsset(String fileName) &#123;
    try (net.dongliu.apk.parser.ApkFile apkFile = new net.dongliu.apk.parser.ApkFile(this.apkFile)) &#123;
        return apkFile.getFileData(&quot;assets/&quot; + fileName);
    &#125; catch (IOException e) &#123;
        throw new IllegalStateException(e);
    &#125;
&#125;
</code></pre>
<p>æ ·æœ¬é€šè¿‡ AAssetManager_open ç­‰ API  è®¿é—® apk çš„èµ„æºæ—¶ï¼Œå°±ä¾èµ–äºè¿™äº› API ä»¥åŠè½½å…¥çš„ apk æ–‡ä»¶ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œå»ºè®®åˆ›å»ºè™šæ‹Ÿæœºæ—¶é€‰æ‹©åŠ è½½ apkã€‚</p>
<p>å€¼å¾—ä¸€æçš„ï¼ŒUnidbg ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/hsiafan/apk-parser">apk-parser</a> å®Œæˆç›¸å…³è§£æå·¥ä½œï¼Œè¯»è€…ä¹Ÿå¯ä»¥åœ¨è‡ªå·±çš„é¡¹ç›®é‡Œä½¿ç”¨å®ƒæ¥è§£æ apkã€‚</p>
<pre><code class="language-Java">&lt;dependency&gt;
    &lt;groupId&gt;net.dongliu&lt;/groupId&gt;
    &lt;artifactId&gt;apk-parser&lt;/artifactId&gt;
    &lt;version&gt;2.6.10&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="3-2åŠ è½½æ¨¡å—"><a href="#3-2åŠ è½½æ¨¡å—" class="headerlink" title="3.2åŠ è½½æ¨¡å—"></a>3.2åŠ è½½æ¨¡å—</h4><p>å¦‚ä½•åŠ è½½ so åˆ° Unidbg é‡Œï¼Ÿéœ€è¦é€šè¿‡ loadLibrary APIï¼Œå®ƒçš„å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-Java">//å‚æ•°ä¸€: åŠ¨æ€åº“æˆ–å¯æ‰§è¡ŒELFæ–‡ä»¶
//å‚æ•°äºŒ: æ˜¯å¦å¼ºåˆ¶æ‰§è¡Œ init_procã€init_array åˆå§‹åŒ–ç³»åˆ—å‡½æ•°
DalvikModule loadLibrary(File elfFile, boolean forceCallInit);

//å‚æ•°ä¸€ï¼šåŠ¨æ€åº“æˆ–å¯æ‰§è¡ŒELFæ–‡ä»¶åï¼Œæ¯”å¦‚ libkwsgmain.so å…¶åå°±æ˜¯ kwsgmainï¼Œ
//Unibdg ä¼šåœ¨ apk lib ç›®å½•ä¸‹æ‰¾åˆ°å’ŒåŠ è½½å®ƒ
//å‚æ•°äºŒ: æ˜¯å¦å¼ºåˆ¶æ‰§è¡Œ init_procã€init_array åˆå§‹åŒ–ç³»åˆ—å‡½æ•°
DalvikModule loadLibrary(String libname, boolean forceCallInit);
</code></pre>
<p>å»ºè®®ä½¿ç”¨ç¬¬äºŒä¸ªé‡è½½ï¼Œè¿™ä¸ª API åœ¨ä½¿ç”¨ä¸Šè¿‘ä¼¼äº Java çš„ System.loadLibrary(soName)ï¼Œæ¯”å¦‚libkwsgmain.so å¯¹åº”ä¸º kwsgmain ï¼Œæå¤´å»å°¾ã€‚</p>
<pre><code class="language-Java">vm.loadLibrary(&quot;kwsgmain&quot;, true);
</code></pre>
<p>å¯¹åº”çš„åŠ è½½ä»£ç å¦‚ä¸‹</p>
<pre><code class="language-Java">@Override
public final DalvikModule loadLibrary(String libname, boolean forceCallInit) &#123;
    String soName = &quot;lib&quot; + libname + &quot;.so&quot;;
    LibraryFile libraryFile = findLibrary(soName);
    if (libraryFile == null) &#123;
        throw new IllegalStateException(&quot;load library failed: &quot; + libname);
    &#125;
    Module module = emulator.getMemory().load(libraryFile, forceCallInit);
    return new DalvikModule(this, module);
&#125;
</code></pre>
<p>å®ƒéœ€è¦åŠ è½½ APK æ‰å¯ä»¥ä½¿ç”¨ï¼Œç„¶ååœ¨ apk çš„ lib ç›®å½•ä¸‹æ‰¾ä½ æƒ³è¦åŠ è½½çš„ SOã€‚</p>
<p>32 ä½ä»£ç å¦‚ä¸‹</p>
<pre><code class="language-Java">byte[] loadLibraryData(Apk apk, String soName) &#123;
    byte[] soData = apk.getFileData(&quot;lib/armeabi-v7a/&quot; + soName);
    if (soData != null) &#123;
        if (log.isDebugEnabled()) &#123;
            log.debug(&quot;resolve armeabi-v7a library: &quot; + soName);
        &#125;
        return soData;
    &#125;
    soData = apk.getFileData(&quot;lib/armeabi/&quot; + soName);
    if (soData != null &amp;&amp; log.isDebugEnabled()) &#123;
        log.debug(&quot;resolve armeabi library: &quot; + soName);
    &#125;
    return soData;
&#125;
</code></pre>
<p>64 ä½ä»£ç å¦‚ä¸‹</p>
<pre><code class="language-Java">byte[] loadLibraryData(Apk apk, String soName) &#123;
    byte[] soData = apk.getFileData(&quot;lib/arm64-v8a/&quot; + soName);
    if (soData != null) &#123;
        if (log.isDebugEnabled()) &#123;
            log.debug(&quot;resolve arm64-v8a library: &quot; + soName);
        &#125;
        return soData;
    &#125; else &#123;
        return null;
    &#125;
&#125;
</code></pre>
<p>å¦‚æœä½¿ç”¨ç¬¬ä¸€ä¸ªé‡è½½ï¼Œè‡ªå·±ä¼ å…¥ SO æ–‡ä»¶ï¼Œä¸å¿…åŠ è½½ apkã€‚</p>
<pre><code class="language-Java">vm.loadLibrary(new File(&quot;unidbg-android/src/test/resources/example_binaries/armeabi-v7a/libsignutil.so&quot;), true);
</code></pre>
<p>é™¤äº†è¿™ä¸¤ä¸ªï¼ŒUnidbg è¿˜æœ‰ä¸€ä¸ªç”¨äºåŠ è½½ SO å­—èŠ‚æ•°ç»„çš„é‡è½½æ–¹æ³•ã€‚</p>
<pre><code class="language-Java">loadLibrary(String libname, byte[] raw, boolean forceCallInit)
</code></pre>
<p>å®ƒçš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ä½¿ç”¨ Unidbg åŠ è½½ dump memoryï¼Œä½†äº‹å®ä¸Šï¼Œè¿™ä¸ª API ç¼ºå°‘ç»´æŠ¤ï¼Œå®é™…å¹¶ä¸å¯ç”¨ã€‚</p>
<h4 id="3-3-åŠ è½½ä¾èµ–æ¨¡å—"><a href="#3-3-åŠ è½½ä¾èµ–æ¨¡å—" class="headerlink" title="3.3 åŠ è½½ä¾èµ–æ¨¡å—"></a>3.3 åŠ è½½ä¾èµ–æ¨¡å—</h4><p>â€‹       è¿™é‡Œæˆ‘ä»¬è¦èŠèŠåŠ è½½ä¾èµ– SO çš„é—®é¢˜ï¼Œç›®æ ‡ SO æ€»ä¼šä¾èµ–ä¸€äº›å¤–éƒ¨ SOï¼Œå…·ä½“åˆ†ä¸ºç³»ç»Ÿåº“å’Œè‡ªèº«åº“ã€‚ç³»ç»Ÿåº“æ¯”å¦‚ libc.soï¼Œliblog.soï¼Œå®ƒä»¬æä¾›äº†å®ç°å„ç§ä»£ç é€»è¾‘å¿…ä¸å¯å°‘çš„åŸºç¡€å‡½æ•°ã€‚è‡ªèº«åº“åˆ™æŒ‡çš„æ˜¯ç›®æ ‡å‡½æ•°å¯èƒ½ä¾èµ–äºè‡ªèº«å¦å¤–ä¸€ä¸ªåº“çš„å¯¼å‡ºå‡½æ•°æˆ–ç¬¦å·ã€‚</p>
<p>â€‹       åœ¨ IDA çš„å¤´éƒ¨å¯ä»¥çœ‹åˆ°è¿™äº›ä¾èµ–åº“ä¿¡æ¯ï¼Œæˆ–ä½¿ç”¨è¯¸å¦‚ objdumpã€readelf ä»»æ„å·¥å…·ä¹Ÿå¯ä»¥è·å–è¿™ä¸€ä¿¡æ¯ã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1664461303595-3029a567-ace5-4724-8d75-11903f071888.png" alt="image.png"></p>
<p>â€‹       åœ¨çœŸå® Android ç³»ç»Ÿçš„åŠ è½½é€»è¾‘ä¸­ï¼Œä¼šè§£æä¾èµ–åº“ï¼Œåˆ¤æ–­è¿™äº›ä¾èµ–åº“æ˜¯å¦å·²åŠ è½½åˆ°å†…å­˜ï¼Œå¦‚æœæ²¡æœ‰åŠ è½½åˆ°å†…å­˜ï¼Œå°±åˆ°è¯¸å¦‚ &#x2F;vendor&#x2F;lib è¿™æ ·çš„ç³»ç»Ÿåº“è·¯å¾„ä»¥åŠ &#x2F;data&#x2F;app&#x2F;packageName&#x2F;base.apk!&#x2F;lib&#x2F;armeabi-v7a è¿™æ ·çš„ç”¨æˆ·åº“è·¯å¾„ä¸‹æ‰¾æ‰€ä¾èµ–çš„ SO å…¶æ–‡ä»¶ã€‚</p>
<p>â€‹        åœ¨ Unidbg çš„é€»è¾‘é‡Œï¼Œå¤„ç†ä¹Ÿç±»ä¼¼ï¼Œä½†ä»£ç é€»è¾‘è¦ç®€å•éå¸¸å¤šã€‚æˆ‘ä»¬åªéœ€è¦é€šè¿‡ setLibraryResolver ç¡®è®¤ä½¿ç”¨å“ªä¸€ç§æ–‡ä»¶ï¼Œå‚æ•°å¯é€‰ 23 å’Œ 19ã€‚ </p>
<p>â€‹        åˆ†åˆ«å¯¹åº”äº sdk23ï¼ˆAndroid 6ï¼‰ å’Œ sdk19ï¼ˆAndroid 4.4ï¼‰ã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250719162055695.png"></p>
<p>â€‹       å¦‚æœä½ è®¾ç½®ä¸º 64 ä½æ¨¡æ‹Ÿå™¨ï¼Œé‚£ä¹ˆ sdk19 æ— æ³•æ»¡è¶³ä½ ï¼Œå› ä¸º Android 4.4 çš„å½¼æ—¶æ²¡æœ‰å¯¹åº” 64 ä½çš„ç³»ç»Ÿåº“ã€‚</p>
<p>â€‹       æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ sdk23ï¼Œè¯»è€…å¯èƒ½è®¤ä¸º Android 6.0 çš„è¿è¡Œåº“ç¯å¢ƒå¤ªä½äº†ï¼Œä½†äº‹å®ä¸Šï¼Œå¯¹äº Native Runtime è€Œè¨€ï¼Œä¼¼ä¹å·²ç„¶å¤Ÿç”¨ï¼Œå¦‚æœè¯»è€…å¸Œæœ›ä½¿ç”¨æ›´é«˜çš„ç‰ˆæœ¬ï¼Œå¹¶éå°†çœŸæœºçš„ SO æ”¾åˆ° Unidbg å°±å¤§åŠŸå‘Šæˆï¼ŒUnidbg ä¸ºè¿™ä¸¤ä¸ª SDK ç¯å¢ƒåšäº†ä¸€äº›ä¼˜åŒ–å’Œ patch å¤„ç†ï¼Œä½ ä¹Ÿéœ€è¦åšå¯¹åº”çš„å¤„ç†æ‰èƒ½è®©æ–°ç¯å¢ƒæ­£å¸¸å¯ç”¨ã€‚</p>
<p>â€‹        å¯»æ‰¾ä¾èµ– SO çš„é€»è¾‘å¦‚ä¸‹</p>
<pre><code class="language-Java">LibraryFile neededLibraryFile = libraryFile.resolveLibrary(emulator, neededLibrary);
if (libraryResolver != null &amp;&amp; neededLibraryFile == null) &#123;
    neededLibraryFile = libraryResolver.resolveLibrary(emulator, neededLibrary);
&#125;
</code></pre>
<p>â€‹          ç¬¬äºŒå¤„ resolveLibrary æ˜¯å¯»æ‰¾æˆ‘ä»¬æ‰€è®¾ç½®çš„ç³»ç»Ÿåº“è·¯å¾„ä¸‹æ˜¯å¦æœ‰å¯¹åº”çš„ SOã€‚</p>
<pre><code class="language-Java">protected static LibraryFile resolveLibrary(Emulator&lt;?&gt; emulator, String libraryName, int sdk, Class&lt;?&gt; resClass) &#123;
    final String lib = emulator.is32Bit() ? &quot;lib&quot; : &quot;lib64&quot;;
    String name = &quot;/android/sdk&quot; + sdk + &quot;/&quot; + lib + &quot;/&quot; + libraryName.replace(&#39;+&#39;, &#39;p&#39;);
    URL url = resClass.getResource(name);
    if (url != null) &#123;
        return new URLibraryFile(url, libraryName, sdk, emulator.is64Bit());
    &#125;
    return null;
&#125;
</code></pre>
<p>â€‹        ç¬¬ä¸€å¤„æ˜¯å¯»æ‰¾ç”¨æˆ·åº“ä¸‹æ˜¯å¦æœ‰ä¾èµ– SOï¼Œå¦‚æœåŠ è½½ç›®æ ‡ SO æ—¶é‡‡ç”¨æ–‡ä»¶æ–¹å¼ï¼Œé‚£ä¹ˆå®ƒä¼šåœ¨æ–‡ä»¶æ‰€å¤„çš„æ–‡ä»¶å¤¹ä¸‹å¯»æ‰¾ã€‚</p>
<pre><code class="language-Java">@Override
public LibraryFile resolveLibrary(Emulator&lt;?&gt; emulator, String soName) &#123;
    File file = new File(elfFile.getParentFile(), soName);
    return file.canRead() ? new ElfLibraryFile(file, is64Bit) : null;
&#125;
</code></pre>
<p>å¦‚æœåŠ è½½ç›®æ ‡ SO æ—¶é‡‡ç”¨ apk å†…éƒ¨ lib ä¸‹å¯»æ‰¾çš„æ–¹å¼ï¼Œé‚£ä¹ˆå¯»æ‰¾ä¾èµ–åº“æ—¶ä¹Ÿä¼šåŒç†ã€‚</p>
<pre><code class="language-Java">@Override
public LibraryFile resolveLibrary(Emulator&lt;?&gt; emulator, String soName) &#123;
    byte[] libData = baseVM.loadLibraryData(apk, soName);
    return libData == null ? null : new ApkLibraryFile(baseVM, this.apk, soName, libData, packageName, is64Bit);
&#125;

// 32 ä½
byte[] loadLibraryData(Apk apk, String soName) &#123;
    byte[] soData = apk.getFileData(&quot;lib/armeabi-v7a/&quot; + soName);
    if (soData != null) &#123;
        if (log.isDebugEnabled()) &#123;
            log.debug(&quot;resolve armeabi-v7a library: &quot; + soName);
        &#125;
        return soData;
    &#125;
    soData = apk.getFileData(&quot;lib/armeabi/&quot; + soName);
    if (soData != null &amp;&amp; log.isDebugEnabled()) &#123;
        log.debug(&quot;resolve armeabi library: &quot; + soName);
    &#125;
    return soData;
&#125;
</code></pre>
<p>â€‹       ç®€è€Œè¨€ä¹‹ï¼Œç®€ç›´åŠ è½½ apkï¼Œç®€ç›´ loadlibrary ä¼ å…¥ SO åè€Œé SO æ–‡ä»¶ï¼Œä¸ç®¡æ˜¯å†…éƒ¨é€»è¾‘è¿˜æ˜¯å®é™…åœºæ™¯ä¸Šï¼Œéƒ½æ›´ç¨³å¦¥å¥½ç”¨ã€‚</p>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 1621925986@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">ğŸ’°</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23lif2sndX4YqUPQwk',
            clientSecret: 'c76a4c487d51bf36e4dd1496b3f44bdbea037d50',
            repo: 'NshIdE1.github.io',
            owner: 'NshIdE1',
            admin: ['NshIdE1'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2024-2025 NshIdE
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">Ã—</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="æ‰«ç æ”¯æŒ">
            <img src="/img/weixin.jpg" class="weixin" title="æ‰«ç æ”¯æŒ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    

    
</style>







</html>
