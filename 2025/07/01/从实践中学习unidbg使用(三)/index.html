<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰) | NshIdE&#39;s Home</title>
  <meta name="keywords" content=" Unidbg ">
  <meta name="description" content="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰) | NshIdE&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="categories">
<meta property="og:url" content="https://nshide1.github.io/categories/">
<meta property="og:site_name" content="NshIdE&#39;s Home">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-03-04T12:19:41.475Z">
<meta property="article:modified_time" content="2025-03-04T12:19:41.475Z">
<meta property="article:author" content="NshIdE">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/logo.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/logo.jpg"/>
</a>
<div class="author">
    <span>NshIdE</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/NshIdE1/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://www.csdn.net/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=1621925986&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(42)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="å…¶ä»–">
            
            å…¶ä»–
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Android-RE">
            
            Android-RE
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Androidå­¦ä¹ ">
            
            Androidå­¦ä¹ 
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Angrå…¥é—¨">
            
            Angrå…¥é—¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="CTF">
            
            CTF
            <small>(16)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Fridaå…¥é—¨">
            
            Fridaå…¥é—¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Javaå­¦ä¹ ">
            
            Javaå­¦ä¹ 
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Unidbgå­¦ä¹ ">
            
            Unidbgå­¦ä¹ 
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="42">
<input type="hidden" id="yelog_site_word_count" value="231.8k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://bananashipsbbq.github.io/">bananaships</a></li>
            
            <li><a target="_blank" href="https://astralprisma.github.io/">AstralPrisma</a></li>
            
            <li><a target="_blank" href="https://monoceros406.github.io/">Monoceros406</a></li>
            
            <li><a target="_blank" href="https://github.com/Thir0th">Thir0th</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æŠ½è±¡</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ç¬¦å·æ‰§è¡Œ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å–è¯</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å®æˆ˜</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åº”æ€¥å“åº”</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Frida</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>go</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Harmony</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>il2Cpps</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>iOS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ISW</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SIMD</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unidbg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unity</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>WritesUp</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All CTF "
           href="/2026/01/04/HitCTF2025-Reverse%C2%B7VM/"
           data-tag="CTF,RE,WritesUp,vm"
           data-author="" >
            <span class="post-title" title="HitCTF2025-ReverseÂ·VM">HitCTF2025-ReverseÂ·VM</span>
            <span class="post-date" title="2026-01-04 16:19:02">2026/01/04</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/11/03/%E6%9F%90%E9%BB%91%E7%9B%92%20App%20%E7%99%BB%E5%BD%95%E5%8F%82%E6%95%B0%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"
           data-tag="Android,å®æˆ˜"
           data-author="" >
            <span class="post-title" title="æŸé»‘ç›’ App ç™»å½•å‚æ•°é€†å‘åˆ†æ">æŸé»‘ç›’ App ç™»å½•å‚æ•°é€†å‘åˆ†æ</span>
            <span class="post-date" title="2025-11-03 16:15:21">2025/11/03</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/10/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%BC%BA%E7%BD%91%C2%B7%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android,il2Cpps"
           data-author="" >
            <span class="post-title" title="ç¬¬å…«å±Šå¼ºç½‘Â·æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›">ç¬¬å…«å±Šå¼ºç½‘Â·æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›</span>
            <span class="post-date" title="2025-10-25 17:31:37">2025/10/25</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/10/22/Android%20APP%20%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android APP å¸¸è§æ¼æ´">Android APP å¸¸è§æ¼æ´</span>
            <span class="post-date" title="2025-10-22 17:06:07">2025/10/22</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/10/10/%E4%BB%8E%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20PackageInfo%20%E5%92%8C%20LoadedApk/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="ä»æºç åˆ†æ PackageInfo å’Œ LoadedApk">ä»æºç åˆ†æ PackageInfo å’Œ LoadedApk</span>
            <span class="post-date" title="2025-10-10 18:15:17">2025/10/10</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/09/09/2025%E5%B9%B4%E6%B9%BE%E5%8C%BA%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%88%9D%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025å¹´æ¹¾åŒºæ¯ç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›">2025å¹´æ¹¾åŒºæ¯ç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›</span>
            <span class="post-date" title="2025-09-09 09:34:17">2025/09/09</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/09/08/Android%20SO%20%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android SO æ–‡ä»¶åŠ è½½è¿‡ç¨‹">Android SO æ–‡ä»¶åŠ è½½è¿‡ç¨‹</span>
            <span class="post-date" title="2025-09-08 17:18:50">2025/09/08</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/25/Dex%20%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Dex æ–‡ä»¶ç»“æ„å­¦ä¹ ">Dex æ–‡ä»¶ç»“æ„å­¦ä¹ </span>
            <span class="post-date" title="2025-08-25 17:33:29">2025/08/25</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/ClassLoader%20%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="ClassLoader æœºåˆ¶">ClassLoader æœºåˆ¶</span>
            <span class="post-date" title="2025-08-19 17:42:51">2025/08/19</span>
        </a>
        
        
        <a  class="All Javaå­¦ä¹  "
           href="/2025/08/19/Java%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="Javaå­¦ä¹ ----åå°„æœºåˆ¶">Javaå­¦ä¹ ----åå°„æœºåˆ¶</span>
            <span class="post-date" title="2025-08-19 17:00:02">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/Android%20%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android åº”ç”¨å¯åŠ¨æµç¨‹">Android åº”ç”¨å¯åŠ¨æµç¨‹</span>
            <span class="post-date" title="2025-08-19 11:14:13">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/%E5%AE%89%E5%8D%93%E5%8A%A0%E5%9B%BA%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="å®‰å“åŠ å›ºå­¦ä¹ è®°å½•">å®‰å“åŠ å›ºå­¦ä¹ è®°å½•</span>
            <span class="post-date" title="2025-08-19 10:50:46">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/14/Android%20%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94NDK%20%E5%BC%80%E5%8F%91/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android å¼€å‘--NDK å¼€å‘">Android å¼€å‘--NDK å¼€å‘</span>
            <span class="post-date" title="2025-08-14 17:56:58">2025/08/14</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/08/10/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%85%AD)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å…­)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å…­)</span>
            <span class="post-date" title="2025-08-10 10:25:02">2025/08/10</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/08/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%94)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äº”)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äº”)</span>
            <span class="post-date" title="2025-08-08 17:45:59">2025/08/08</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/05/%E6%BC%AB%E8%B0%88%E5%94%AF%E4%B8%80%E8%AE%BE%E5%A4%87ID/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="æ¼«è°ˆå”¯ä¸€è®¾å¤‡ ID">æ¼«è°ˆå”¯ä¸€è®¾å¤‡ ID</span>
            <span class="post-date" title="2025-08-05 18:00:44">2025/08/05</span>
        </a>
        
        
        <a  class="All å…¶ä»– "
           href="/2025/07/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20Linux%20%E7%B3%BB%E7%BB%9F%E4%B8%8B%20proc%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"
           data-tag="Android,Linux"
           data-author="" >
            <span class="post-title" title="æµ…è°ˆ Linux ç³»ç»Ÿä¸‹ proc æ–‡ä»¶ç³»ç»Ÿå†…å®¹">æµ…è°ˆ Linux ç³»ç»Ÿä¸‹ proc æ–‡ä»¶ç³»ç»Ÿå†…å®¹</span>
            <span class="post-date" title="2025-07-24 17:56:57">2025/07/24</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/24/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%BA%8C%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(äºŒ)">Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(äºŒ)</span>
            <span class="post-date" title="2025-07-24 17:00:12">2025/07/24</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/07/23/2025%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B-%E5%88%9D%E8%B5%9B-%E5%AE%89%E5%8D%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E5%85%A8/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025ç¬¬åå±Šæ¸¸æˆå®‰å…¨ç«èµ›-åˆèµ›-å®‰å“å®¢æˆ·ç«¯å®‰å…¨">2025ç¬¬åå±Šæ¸¸æˆå®‰å…¨ç«èµ›-åˆèµ›-å®‰å“å®¢æˆ·ç«¯å®‰å…¨</span>
            <span class="post-date" title="2025-07-23 15:32:11">2025/07/23</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/19/%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%92%8C%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—">åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—</span>
            <span class="post-date" title="2025-07-19 15:14:29">2025/07/19</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/15/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%B8%80%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(ä¸€)">Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(ä¸€)</span>
            <span class="post-date" title="2025-07-15 16:52:06">2025/07/15</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%9B%9B)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å››)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å››)</span>
            <span class="post-date" title="2025-07-08 11:44:49">2025/07/08</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/01/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%89)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)</span>
            <span class="post-date" title="2025-07-01 15:29:42">2025/07/01</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/06/07/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmonyCTF/"
           data-tag="CTF,RE,WritesUp,Harmony"
           data-author="" >
            <span class="post-title" title="ç¬¬ä¸€å±ŠOpenHarmonyCTF">ç¬¬ä¸€å±ŠOpenHarmonyCTF</span>
            <span class="post-date" title="2025-06-07 13:32:45">2025/06/07</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/06/04/%E8%A1%A5%E5%BA%93%E5%87%BD%E6%95%B0%EF%BC%88%E4%BA%94%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="è¡¥åº“å‡½æ•°(äº”)">è¡¥åº“å‡½æ•°(äº”)</span>
            <span class="post-date" title="2025-06-04 19:07:56">2025/06/04</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/06/02/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%8C)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äºŒ)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äºŒ)</span>
            <span class="post-date" title="2025-06-02 15:33:15">2025/06/02</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/31/D%5E3CTF2025/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="D^3CTF2025">D^3CTF2025</span>
            <span class="post-date" title="2025-05-31 16:21:11">2025/05/31</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/05/28/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%80)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸€)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸€)</span>
            <span class="post-date" title="2025-05-28 16:39:23">2025/05/28</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/17/Parloo2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="Parloo RE">Parloo RE</span>
            <span class="post-date" title="2025-05-17 09:34:20">2025/05/17</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/05/07/%E8%AE%B0%E4%B8%80%E6%AC%A1APK%E5%88%86%E6%9E%90/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="è®°ä¸€æ¬¡APKåˆ†æ">è®°ä¸€æ¬¡APKåˆ†æ</span>
            <span class="post-date" title="2025-05-07 21:12:00">2025/05/07</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/26/%E4%B8%80%E9%81%93%E5%BE%88%E9%80%86%E5%A4%A9%E7%9A%84RC4/"
           data-tag="CTF,RE,WritesUp,æŠ½è±¡"
           data-author="" >
            <span class="post-title" title="æŠ½è±¡RC4">æŠ½è±¡RC4</span>
            <span class="post-date" title="2025-04-26 22:21:19">2025/04/26</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/24/%E5%BE%88%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜">å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜</span>
            <span class="post-date" title="2025-04-24 21:56:18">2025/04/24</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/23/%E4%BA%AC%E9%BA%92CTF2025%20%E7%83%AD%E8%BA%AB%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,iOS,SIMD"
           data-author="" >
            <span class="post-title" title="äº¬éº’CTF2025çƒ­èº«èµ›">äº¬éº’CTF2025çƒ­èº«èµ›</span>
            <span class="post-date" title="2025-04-23 13:33:59">2025/04/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/14/TGCTF2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TGCTF2025 RE">TGCTF2025 RE</span>
            <span class="post-date" title="2025-04-14 18:51:29">2025/04/14</span>
        </a>
        
        
        <a  class="All Angrå…¥é—¨ "
           href="/2025/04/14/Angr%E5%85%A5%E9%97%A8/"
           data-tag="ç¬¦å·æ‰§è¡Œ"
           data-author="" >
            <span class="post-title" title="Angrå…¥é—¨">Angrå…¥é—¨</span>
            <span class="post-date" title="2025-04-14 18:50:44">2025/04/14</span>
        </a>
        
        
        <a  class="All Fridaå…¥é—¨ "
           href="/2025/04/14/Frida%E5%85%A5%E9%97%A8/"
           data-tag="Android,Frida"
           data-author="" >
            <span class="post-title" title="Fridaå…¥é—¨">Fridaå…¥é—¨</span>
            <span class="post-date" title="2025-04-14 18:47:37">2025/04/14</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/12/TEXSAWCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TEXSAWCTF 2025">TEXSAWCTF 2025</span>
            <span class="post-date" title="2025-04-12 15:32:31">2025/04/12</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/23/NCTF2024/"
           data-tag="CTF,RE,WritesUp,vm,go"
           data-author="" >
            <span class="post-title" title="NCTF2024">NCTF2024</span>
            <span class="post-date" title="2025-03-23 11:58:53">2025/03/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/18/CISCN%20x%20CCB%20%E5%8D%8A%E5%86%B3%E8%B5%9B%202025%20ISW(%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94)/"
           data-tag="ISW,åº”æ€¥å“åº”,å–è¯"
           data-author="" >
            <span class="post-title" title="CISCN x CCB åŠå†³èµ› 2025 ISW(åº”æ€¥å“åº”)">CISCN x CCB åŠå†³èµ› 2025 ISW(åº”æ€¥å“åº”)</span>
            <span class="post-date" title="2025-03-18 10:24:23">2025/03/18</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/11/TPCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TPCTF 2025">TPCTF 2025</span>
            <span class="post-date" title="2025-03-11 21:41:19">2025/03/11</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/06/VishwaCTF2025/"
           data-tag="CTF,RE,WritesUp,Android,Unity"
           data-author="" >
            <span class="post-title" title="VishwaCTF2025">VishwaCTF2025</span>
            <span class="post-date" title="2025-03-06 21:52:51">2025/03/06</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/03/HGAME%20RE/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="HGAME-RE-WEEK1">HGAME-RE-WEEK1</span>
            <span class="post-date" title="2025-03-03 22:20:33">2025/03/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="Unidbgå­¦ä¹ ">Unidbgå­¦ä¹ </a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color2">Unidbg</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-08-11 15:35:18'>2025-07-01 15:29</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:8.7k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8-%E4%B8%89"><span class="toc-text">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80"><span class="toc-text">ä¸€ã€å¼•è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BB%BB%E5%8A%A1%E6%8F%8F%E8%BF%B0"><span class="toc-text">äºŒã€ä»»åŠ¡æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">ä¸‰ã€åˆå§‹åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%8F%91%E8%B5%B7%E8%B0%83%E7%94%A8"><span class="toc-text">å››ã€å‘èµ·è°ƒç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E8%A1%A5JNI%E7%8E%AF%E5%A2%83"><span class="toc-text">äº”ã€è¡¥JNIç¯å¢ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-%E5%BC%82%E5%B8%B8"><span class="toc-text">5.1 å¼‚å¸¸</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-%E8%A1%A5%E7%8E%AF%E5%A2%83%E5%8E%9F%E5%9B%A0"><span class="toc-text">5.2 è¡¥ç¯å¢ƒåŸå› </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-%E5%9F%BA%E6%9C%AC%E8%A7%84%E8%8C%83"><span class="toc-text">5.3 åŸºæœ¬è§„èŒƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-%E5%BC%80%E5%A7%8B%E8%A1%A5%E7%8E%AF%E5%A2%83"><span class="toc-text">5.4 å¼€å§‹è¡¥ç¯å¢ƒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%B0%BE%E5%A3%B0"><span class="toc-text">å…­ã€å°¾å£°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%8F%82%E8%80%83"><span class="toc-text">ä¸ƒã€å‚è€ƒ</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨-ä¸‰"><a href="#ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨-ä¸‰" class="headerlink" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)"></a>ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)</h1><h3 id="ä¸€ã€å¼•è¨€"><a href="#ä¸€ã€å¼•è¨€" class="headerlink" title="ä¸€ã€å¼•è¨€"></a>ä¸€ã€å¼•è¨€</h3><p>æœ¬ç¯‡ä¸­çš„APKè¯¦è§å‚è€ƒæ–‡ç« ä¸­</p>
<p>ç›®æ ‡APKï¼šright573.apk</p>
<p>ç›®æ ‡æ–¹æ³•å®ç°ï¼šlibnet_crypto.so</p>
<p>æœ¬ç¯‡å°†å¼€å§‹è®¨è®ºè¡¥ç¯å¢ƒã€‚</p>
<h3 id="äºŒã€ä»»åŠ¡æè¿°"><a href="#äºŒã€ä»»åŠ¡æè¿°" class="headerlink" title="äºŒã€ä»»åŠ¡æè¿°"></a>äºŒã€ä»»åŠ¡æè¿°</h3><p>JADXåç¼–è¯‘right573.apkï¼Œæ‰¾åˆ°com.izuiyou.networkï¼Œæˆ‘ä»¬å…³æ³¨äºNetCryptoç±»é‡Œçš„signæ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ã€‚</p>
<pre><code class="language-Java">package com.izuiyou.network;

import android.app.ContextProvider;
import com.meituan.robust.ChangeQuickRedirect;
import com.meituan.robust.PatchProxy;
import com.meituan.robust.PatchProxyResult;
import defpackage.we5;

/* loaded from: classes4.dex */
public class NetCrypto &#123;
    public static ChangeQuickRedirect changeQuickRedirect;

    static &#123;
        we5.a(ContextProvider.get(), &quot;net_crypto&quot;);
        native_init();
    &#125;

    public static String a(String str, byte[] bArr) &#123;
        String str2;
        PatchProxyResult proxy = PatchProxy.proxy(new Object[]&#123;str, bArr&#125;, null, changeQuickRedirect, true, 47387, new Class[]&#123;String.class, byte[].class&#125;, String.class);
        if (proxy.isSupported) &#123;
            return (String) proxy.result;
        &#125;
        String sign = sign(str, bArr);
        if (str.contains(&quot;?&quot;)) &#123;
            str2 = &quot;&amp;sign=&quot; + sign;
        &#125; else &#123;
            str2 = &quot;?sign=&quot; + sign;
        &#125;
        return str + str2;
    &#125;

    public static native byte[] decodeAES(byte[] bArr, boolean z);

    public static native byte[] encodeAES(byte[] bArr);

    public static native String generateSign(byte[] bArr);

    public static native String getProtocolKey();

    public static native void native_init();

    public static native boolean registerDID(byte[] bArr);

    public static native void setProtocolKey(String str);

    public static native String sign(String str, byte[] bArr);
&#125;
</code></pre>
<p>è¿™æ®µä»£ç ä¸»è¦è´Ÿè´£å¤„ç†ç½‘è·¯é€šä¿¡ä¸­çš„åŠ è§£å¯†å’Œç­¾åç›¸å…³é€»è¾‘ã€‚å®ƒç»“åˆäº†åŸç”Ÿæ–¹æ³•(é€šè¿‡nativeå…³é”®å­—)ä»¥åŠç¾å›¢çš„çƒ­ä¿®å¤æ¡†æ¶Robustã€‚ä¸»è¦æ–¹æ³•å°±æ˜¯aæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºåœ¨URLä¸Šæ‹¼æ¥ç­¾åçš„å·¥å…·æ–¹æ³•ï¼Œå…ˆé€šè¿‡PathProxyæ£€æŸ¥æ˜¯å¦éœ€è¦è¢«çƒ­æ›´æ–°æ›¿æ¢ã€‚å¦åˆ™æ‰§è¡Œé»˜è®¤é€»è¾‘ï¼šâ‘ è°ƒç”¨åŸç”Ÿæ–¹æ³•sign(str, bArr)ç”Ÿæˆç­¾åï¼›â‘¡åˆ¤æ–­URLä¸­æ˜¯å¦å·²æœ‰å‚æ•° ? ï¼Œç„¶åæ‹¼æ¥signå‚æ•°è¿”å›ã€‚è¿™ä¸ªç±»çš„ä¸»è¦ç”¨é€”å°±æ˜¯åŠ è§£å¯†ç½‘ç»œæ•°æ®ï¼›ä¸ºURLæˆ–è¯·æ±‚ç”Ÿæˆç­¾åï¼›ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œé˜²ç¯¡æ”¹ï¼›æ”¯æŒçƒ­æ›´æ–°ï¼Œå…è®¸åœ¨ä¸é‡æ–°å‘å¸ƒAPKçš„æƒ…å†µä¸‹ä¿®å¤æ–¹æ³•é€»è¾‘ï¼›å€ŸåŠ©åŸç”Ÿåº“æå‡åŠ å¯†æ•ˆç‡æˆ–å®‰å…¨æ€§ã€‚</p>
<p>å…ˆç”¨Fridaé™„åŠ ç›®æ ‡è¿›ç¨‹åšä¸»åŠ¨è°ƒç”¨ï¼Œå¯å‚è€ƒå¦‚ä¸‹ä»£ç </p>
<pre><code class="language-js">function callSign()&#123;
  Java.perform(function() &#123;
    function stringToBytes(str) &#123;
      var javaString = Java.use(&#39;java.lang.String&#39;);
      return javaString.$new(str).getBytes();
    &#125;

    let NetCrypto = Java.use(&quot;com.izuiyou.network.NetCrypto&quot;);
    let arg1 = &quot;hello world&quot;;
    let arg2 = &quot;V I 50&quot;;
    let ret = NetCrypto.sign(arg1, stringToBytes(arg2));
    console.log(&quot;ret:&quot;+ret);
  &#125;)
&#125;
callSign();
</code></pre>
<p>è¾“å‡ºæ˜¯</p>
<pre><code class="language-shell">ret:v2-b94195d5f3c2ad3a876f13346fa283a0
</code></pre>
<p>æœ¬ç¯‡çš„ç›®æ ‡å°±æ˜¯ä½¿ç”¨Unidbgå¤ç°å¯¹signçš„è°ƒç”¨ã€‚</p>
<h3 id="ä¸‰ã€åˆå§‹åŒ–"><a href="#ä¸‰ã€åˆå§‹åŒ–" class="headerlink" title="ä¸‰ã€åˆå§‹åŒ–"></a>ä¸‰ã€åˆå§‹åŒ–</h3><p>åœ¨Unidbgçš„unidbg-android&#x2F;src&#x2F;test&#x2F;javaä¸‹æ–°å»ºåŒ…å’Œç±»ã€‚</p>
<pre><code class="language-Java">package com.test2;

import com.github.unidbg.AndroidEmulator;
import com.github.unidbg.arm.backend.Unicorn2Factory;
import com.github.unidbg.linux.android.AndroidEmulatorBuilder;
import com.github.unidbg.linux.android.AndroidResolver;
import com.github.unidbg.linux.android.dvm.AbstractJni;
import com.github.unidbg.linux.android.dvm.DalvikModule;
import com.github.unidbg.linux.android.dvm.DvmClass;
import com.github.unidbg.linux.android.dvm.VM;
import com.github.unidbg.memory.Memory;

import java.io.File;

public class TEST2 extends AbstractJni &#123;
    private final AndroidEmulator emulator;
    private final DvmClass NetCrypto;
    private final VM vm;

    public TEST2() &#123;
        emulator = AndroidEmulatorBuilder
                .for32Bit()
                .addBackendFactory(new Unicorn2Factory(true))
                .setProcessName(&quot;cn.xiaochuankeji.tieba&quot;)
                .build();
        Memory memory = emulator.getMemory();
        memory.setLibraryResolver(new AndroidResolver(23));
        vm = emulator.createDalvikVM(new File(&quot;D:\\Compilation_Enviroment\\unidbg-master\\unidbg-android\\src\\test\\java\\com\\test2\\right573.apk&quot;));
        vm.setJni(this);
        vm.setVerbose(true);
        DalvikModule dm = vm.loadLibrary(&quot;net_crypto&quot;, true);
        NetCrypto = vm.resolveClass(&quot;com.izuiyou.network.NetCrypto&quot;);
        dm.callJNI_OnLoad(emulator);
    &#125;

    public static void main(String[] args) &#123;
        TEST2 test = new TEST2();
    &#125;


&#125;
</code></pre>
<p>ç”±äºæ ·æœ¬ç›®å½•ä¸‹åªåŒ…å«armeabi-v7açš„åŠ¨æ€æ–‡ä»¶ï¼Œå› æ­¤åªèƒ½é€‰æ‹©32ä½ï¼Œè¿è¡Œä»£ç ï¼Œå‘ç°æŠ¥é”™ã€‚</p>
<pre><code class="language-shell">[10:34:53 630]  INFO [com.github.unidbg.linux.AndroidElfLoader] (AndroidElfLoader:481) - libnet_crypto.so load dependency libandroid.so failed
JNIEnv-&gt;FindClass(com/izuiyou/network/NetCrypto) was called from RX@0x12049fc5[libnet_crypto.so]0x49fc5
JNIEnv-&gt;RegisterNatives(com/izuiyou/network/NetCrypto, RW@0x121c9010[libnet_crypto.so]0x1c9010, 8) was called from RX@0x12049fd7[libnet_crypto.so]0x49fd7
RegisterNative(com/izuiyou/network/NetCrypto, native_init()V, RX@0x1204a069[libnet_crypto.so]0x4a069)
RegisterNative(com/izuiyou/network/NetCrypto, encodeAES([B)[B, RX@0x1204a0b9[libnet_crypto.so]0x4a0b9)
RegisterNative(com/izuiyou/network/NetCrypto, decodeAES([BZ)[B, RX@0x1204a14d[libnet_crypto.so]0x4a14d)
RegisterNative(com/izuiyou/network/NetCrypto, sign(Ljava/lang/String;[B)Ljava/lang/String;, RX@0x1204a28d[libnet_crypto.so]0x4a28d)
RegisterNative(com/izuiyou/network/NetCrypto, getProtocolKey()Ljava/lang/String;, RX@0x1204a419[libnet_crypto.so]0x4a419)
RegisterNative(com/izuiyou/network/NetCrypto, setProtocolKey(Ljava/lang/String;)V, RX@0x1204a479[libnet_crypto.so]0x4a479)
RegisterNative(com/izuiyou/network/NetCrypto, registerDID([B)Z, RX@0x1204a4f5[libnet_crypto.so]0x4a4f5)
RegisterNative(com/izuiyou/network/NetCrypto, generateSign([B)Ljava/lang/String;, RX@0x1204a587[libnet_crypto.so]0x4a587)
</code></pre>
<p>ç¬¬ä¸€è¡Œæ—¥å¿—æç¤ºï¼Œlibnet_crypto.soæ–‡ä»¶è¯•å›¾åŠ è½½libandroid.soè¿™ä¸ªä¾èµ–åº“ï¼Œä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼Œæ¥ä¸‹æ¥æ¢ç©¶è¿™ä¸ªé—®é¢˜çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆã€‚</p>
<p>é¦–å…ˆæ˜¯åŸå› ï¼Œå‰æ–‡æˆ‘ä»¬è¯´ï¼ŒUnidbgçš„So Loaderæä¾›äº†ç±»ä¼¼Android Linkerçš„å¤„ç†æœºåˆ¶ï¼Œå¯¹æ‰€ä¾èµ–çš„ç”¨æˆ·åº“ä»¥åŠç³»ç»Ÿåº“è¿›è¡ŒåŠ è½½ï¼Œè¿™é‡ŒåŠ è½½å¤±è´¥çš„libandroid.soå°±æ˜¯ä¸€ä¸ªç³»ç»Ÿåº“ï¼Œå®ƒæä¾›äº†å¤§é‡çš„Androidç›¸å…³çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è®¿é—®APKçš„èµ„æºæ–‡ä»¶ç­‰ç­‰ã€‚å…·ä½“å¯çœ‹è¿™ç¯‡[æ–‡ç« ](<a target="_blank" rel="noopener" href="https://www.cnblogs.com/willhua/p/9692529.html">Android: åœ¨nativeä¸­è®¿é—®assetså…¨è§£æ - willhua - åšå®¢å›­</a>)ã€‚</p>
<p>é‚£ä¹ˆï¼ŒUnidbgçš„libç›®å½•ä¸‹ä¸ºä»€ä¹ˆæ²¡æœ‰åŒ…å«è¿™ä¸ªåŠ¨æ€åº“ï¼Ÿ<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705111108967.png" alt="image-20250705111108967"></p>
<p>ä¹Ÿå¯ä»¥è¯´ï¼ŒAndroid FrameWorkæä¾›äº†æ•°åä¸Šç™¾ä¸ªåŠ¨æ€åº“ï¼Œä¸ºä»€ä¹ˆUnidbgåªåœ¨libé‡Œæ”¾äº†è¿™ä¹ˆå‡ ä¸ªï¼Ÿè¿™æ˜¯å› ä¸ºå¹¶éæ‰€æœ‰çš„Soéƒ½å¯ä»¥è¢«Unidbgå®Œå¤‡çš„åŠ è½½å’Œå¤„ç†ã€‚</p>
<p>ä»¥å½“å‰çš„libandroid.soä¸ºä¾‹ï¼Œå®ƒä¾èµ–äºç›¸å½“å¤šçš„ç±»åº“ï¼Œå…¶ä¸­è®¸å¤šçš„Androidç³»ç»Ÿã€è½¯ç¡¬ä»¶ã€å¤§é‡çš„ç³»ç»Ÿè°ƒç”¨ç´§å¯†ç›¸å…³ã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1667897135718-a799b44f-812a-40cf-b31f-067eae755f20.png" alt="img"></p>
<p>è¿™ä½¿å¾—Unidbgå¾ˆéš¾å¯¹å®ƒä»¬åšå¦¥å–„ã€å®Œå¤‡çš„å¤„ç†ï¼Œå› ä¸ºUnidbgå¹¶ä¸æ˜¯çœŸæ­£å®Œå–„å¥å…¨çš„æ¨¡æ‹Ÿå™¨ï¼Œæˆ–è€…è¯´æ¨¡æ‹Ÿå™¨å°±å¾ˆéš¾åƒçœŸæœºä¸€æ ·å®Œå–„ã€‚é™¤äº†libandroid.soå¤–ï¼Œlibstart.soã€libjnigraphics.soç­‰åº“éƒ½å› ä¸ºè¿™ä¸ªåŸå› æ²¡æ³•å®ŒæˆåŠ è½½ã€‚å› æ­¤Unidbgåªé»˜è®¤åŠ è½½äº†ä¾èµ–æœ€å°‘ï¼Œä½¿ç”¨åˆæœ€å¤šçš„ä¸€æ‰¹åº“å‡½æ•°ã€‚</p>
<p>å¯æ˜¯æ¯”å¦‚libandroid.soè¿™æ ·çš„ç³»ç»Ÿåº“å‡ºç°é¢‘ç‡å¾ˆé«˜ï¼Œæ€»ä¸èƒ½é‡åˆ°å®ƒä»¬å°±æ­‡ç«ã€‚å› æ­¤Unidbgæä¾›äº†ä¸€ç§å«è™šæ‹Ÿæ¨¡å—çš„æœºåˆ¶ï¼Œæä¾›å¯¹è¿™äº›soæ–‡ä»¶ä¸€éƒ¨åˆ†å‡½æ•°çš„æ¨¡æ‹Ÿå®ç°ã€‚</p>
<p>ç›®å‰Unidbgæä¾›äº†libandroid.soã€libjnigraphics.soã€libmediandk.soä¸‰ä¸ªåº“çš„è™šæ‹Ÿæ¨¡å—ã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705112633520.png" alt="image-20250705112633520"></p>
<p>ä½¿ç”¨å®ƒä»¬ç›¸å½“ç®€å•ï¼Œæ¯”å¦‚æ­¤å¤„ç¼ºå°‘libandroid.soï¼Œåªéœ€è¦åœ¨<strong>æ—©äº</strong>ç›®æ ‡soæ–‡ä»¶åŠ è½½çš„æ—¶æœºï¼Œæ·»åŠ ä¸‹é¢è¿™è¡Œä»£ç å³å¯ã€‚</p>
<pre><code class="language-Java">new AndroidModule(emulator, vm).register(memory);
</code></pre>
<p>å°±åƒä¸‹é¢è¿™æ ·</p>
<pre><code class="language-Java">    public TEST2() &#123;
        emulator = AndroidEmulatorBuilder
                .for32Bit()
                .addBackendFactory(new Unicorn2Factory(true))
                .setProcessName(&quot;cn.xiaochuankeji.tieba&quot;)
                .build();
        Memory memory = emulator.getMemory();
        memory.setLibraryResolver(new AndroidResolver(23));
        vm = emulator.createDalvikVM(new File(&quot;D:\\Compilation_Enviroment\\unidbg-master\\unidbg-android\\src\\test\\java\\com\\test2\\right573.apk&quot;));
        vm.setJni(this);
        vm.setVerbose(true);

        // ä½¿ç”¨libandroid.soè™šæ‹Ÿæ¨¡å—
        new AndroidModule(emulator, vm).register(memory);

        DalvikModule dm = vm.loadLibrary(&quot;net_crypto&quot;, true);
        NetCrypto = vm.resolveClass(&quot;com.izuiyou.network.NetCrypto&quot;);
        dm.callJNI_OnLoad(emulator);
    &#125;
</code></pre>
<p>è™šæ‹Ÿæ¨¡å—åœ¨æœ¬è´¨ä¸Šå°±æ˜¯æŒ‰æ¨¡å—å»Hookå’Œå®ç°ä¸€äº›å‡½æ•°ï¼Œåªä¸è¿‡åœ¨å½¢å¼å’Œå¤„ç†ä¸Šæ›´ä¼˜é›…ï¼Œåº”è¯¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è®¾è®¡ã€‚</p>
<p>å®ƒä¹Ÿå¹¶éä¸‡å…¨ä¹‹ç­–ï¼Œä»¥libandroid.soä¸ºä¾‹ï¼ŒAndroidModuleè™šæ‹Ÿæ¨¡å—é‡Œä¸€å…±å®ç°äº†ä¸‹é¢å‡ ä¸ªå‡½æ•°ã€‚</p>
<ul>
<li>AAssetManager_fromJava</li>
<li>AAsset_close</li>
<li>AAsset_getBuffer</li>
<li>AAsset_getLength</li>
<li>AAsset_read</li>
</ul>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705114440593.png" alt="image-20250705114440593"></p>
<p>å’Œlibandroid.soæ‰€å…·æœ‰çš„æ•°ç™¾ä¸ªå¯¼å‡ºå‡½æ•°ç›¸æ¯”ï¼Œåªæ˜¯æå°çš„ä¸€éƒ¨åˆ†ã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1667898041325-6e2aa628-67bb-48a2-acc8-bc9d35af4305.png" alt="img"></p>
<p>å³ä½¿åªè€ƒè™‘å·²å¤„ç†çš„äº”ä¸ªå‡½æ•°ï¼Œå®ƒä¹Ÿè¿œç§°ä¸ä¸Šå®Œå–„ï¼Œåªæ˜¯ä¸€ç§ç®€å•çš„æ¨¡æ‹Ÿã€‚libjnigraphics.soã€libmediandk.so ä¹Ÿéƒ½å­˜åœ¨åŒæ ·çš„é—®é¢˜ã€‚</p>
<p>ä½†åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œå·²ç»æ˜¯æœ€å¥½çš„åŠæ³•ã€‚</p>
<h3 id="å››ã€å‘èµ·è°ƒç”¨"><a href="#å››ã€å‘èµ·è°ƒç”¨" class="headerlink" title="å››ã€å‘èµ·è°ƒç”¨"></a>å››ã€å‘èµ·è°ƒç”¨</h3><p>å¯å‚è€ƒçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-Java">package com.test2;

import com.github.unidbg.AndroidEmulator;
import com.github.unidbg.arm.backend.Unicorn2Factory;
import com.github.unidbg.linux.android.AndroidEmulatorBuilder;
import com.github.unidbg.linux.android.AndroidResolver;
import com.github.unidbg.linux.android.dvm.AbstractJni;
import com.github.unidbg.linux.android.dvm.DalvikModule;
import com.github.unidbg.linux.android.dvm.DvmClass;
import com.github.unidbg.linux.android.dvm.VM;
import com.github.unidbg.memory.Memory;
import com.github.unidbg.virtualmodule.android.AndroidModule;

import java.io.File;
import java.nio.charset.StandardCharsets;

public class TEST2 extends AbstractJni &#123;
    private final AndroidEmulator emulator;
    private final DvmClass NetCrypto;
    private final VM vm;

    public TEST2() &#123;
        emulator = AndroidEmulatorBuilder
                .for32Bit()
                .addBackendFactory(new Unicorn2Factory(true))
                .setProcessName(&quot;cn.xiaochuankeji.tieba&quot;)
                .build();
        Memory memory = emulator.getMemory();
        memory.setLibraryResolver(new AndroidResolver(23));
        vm = emulator.createDalvikVM(new File(&quot;D:\\Compilation_Enviroment\\unidbg-master\\unidbg-android\\src\\test\\java\\com\\test2\\right573.apk&quot;));
        vm.setJni(this);
        vm.setVerbose(true);

        // ä½¿ç”¨libandroid.soè™šæ‹Ÿæ¨¡å—
        new AndroidModule(emulator, vm).register(memory);

        DalvikModule dm = vm.loadLibrary(&quot;net_crypto&quot;, true);
        NetCrypto = vm.resolveClass(&quot;com.izuiyou.network.NetCrypto&quot;);
        dm.callJNI_OnLoad(emulator);
    &#125;

    public String callSign() &#123;
        String arg1 = &quot;hello world&quot;;
        byte[] arg2 = &quot;V I 50&quot;.getBytes(StandardCharsets.UTF_8);
        String ret = NetCrypto.callStaticJniMethodObject(emulator, &quot;sign(Ljava/lang/String;[B)Ljava/lang/String;&quot;, arg1, arg2).getValue().toString();
        return ret;
    &#125;



    public static void main(String[] args) &#123;
        TEST2 test = new TEST2();
        String result = test.callSign();
        System.out.println(&quot;call s result: &quot; + result);
    &#125;


&#125;
</code></pre>
<p>å› ä¸ºæ˜¯é™æ€å‡½æ•°ï¼Œè€Œä¸”è¿”å›å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥é‡‡ç”¨<strong>callStaticJniMethodObject</strong>å‘èµ·è°ƒç”¨ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œå‚æ•°1 å’Œ 2 æ˜¯å­—ç¬¦ä¸²å’Œå­—èŠ‚æ•°ç»„ç±»å‹ï¼Œéƒ½å±äºUnidbgä¼šæ›¿æˆ‘ä»¬å¤„ç†ç±»å‹è½¬æ¢çš„ç±»å‹ã€‚</p>
<h3 id="äº”ã€è¡¥JNIç¯å¢ƒ"><a href="#äº”ã€è¡¥JNIç¯å¢ƒ" class="headerlink" title="äº”ã€è¡¥JNIç¯å¢ƒ"></a>äº”ã€è¡¥JNIç¯å¢ƒ</h3><p>æœ¬ç¯‡å¼€å§‹è¿›å…¥JNIè¡¥ç¯å¢ƒçš„å¤„ç†é€»è¾‘ï¼Œè¿™é‡Œä¼šç•™å¥½å‡ ä¸ªå‘ï¼Œæ”¾åˆ°åæ–‡å†è®²ï¼Œè¯·è¯»è€…ç¨å®‰å‹¿èºã€‚</p>
<p>è¿è¡Œä»£ç ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p>
<pre><code class="language-shell">JNIEnv-&gt;GetStringUtfChars(&quot;hello world&quot;) was called from RX@0x12066b07[libnet_crypto.so]0x66b07
JNIEnv-&gt;ReleaseStringUTFChars(&quot;hello world&quot;) was called from RX@0x12066b23[libnet_crypto.so]0x66b23
JNIEnv-&gt;FindClass(com/izuiyou/common/base/BaseApplication) was called from RX@0x1204da21[libnet_crypto.so]0x4da21
JNIEnv-&gt;GetStaticMethodID(com/izuiyou/common/base/BaseApplication.getAppContext()Landroid/content/Context;) =&gt; 0x2157b33c was called from RX@0x1204da57[libnet_crypto.so]0x4da57
[15:23:19 214]  WARN [com.github.unidbg.linux.ARM32SyscallHandler] (ARM32SyscallHandler:538) - handleInterrupt intno=2, NR=-452987556, svcNumber=0x170, PC=unidbg@0xfffe0794, LR=RX@0x1204db2f[libnet_crypto.so]0x4db2f, syscall=null
java.lang.UnsupportedOperationException: com/izuiyou/common/base/BaseApplication-&gt;getAppContext()Landroid/content/Context;
	at com.github.unidbg.linux.android.dvm.AbstractJni.callStaticObjectMethodV(AbstractJni.java:504)
	at com.github.unidbg.linux.android.dvm.AbstractJni.callStaticObjectMethodV(AbstractJni.java:438)
	at com.github.unidbg.linux.android.dvm.DvmMethod.callStaticObjectMethodV(DvmMethod.java:59)
	at com.github.unidbg.linux.android.dvm.DalvikVM$113.handle(DalvikVM.java:1815)
	at com.github.unidbg.linux.ARM32SyscallHandler.hook(ARM32SyscallHandler.java:131)
	at com.github.unidbg.arm.backend.Unicorn2Backend$11.hook(Unicorn2Backend.java:352)
	at com.github.unidbg.arm.backend.unicorn.Unicorn$NewHook.onInterrupt(Unicorn.java:109)
	at com.github.unidbg.arm.backend.unicorn.Unicorn.emu_start(Native Method)
	at com.github.unidbg.arm.backend.unicorn.Unicorn.emu_start(Unicorn.java:312)
	at com.github.unidbg.arm.backend.Unicorn2Backend.emu_start(Unicorn2Backend.java:389)
	at com.github.unidbg.AbstractEmulator.emulate(AbstractEmulator.java:378)
	at com.github.unidbg.thread.Function32.run(Function32.java:39)
	at com.github.unidbg.thread.MainTask.dispatch(MainTask.java:19)
	at com.github.unidbg.thread.UniThreadDispatcher.run(UniThreadDispatcher.java:165)
	at com.github.unidbg.thread.UniThreadDispatcher.runMainForResult(UniThreadDispatcher.java:97)
	at com.github.unidbg.AbstractEmulator.runMainForResult(AbstractEmulator.java:341)
	at com.github.unidbg.arm.AbstractARMEmulator.eFunc(AbstractARMEmulator.java:255)
	at com.github.unidbg.Module.emulateFunction(Module.java:163)
	at com.github.unidbg.linux.android.dvm.DvmObject.callJniMethod(DvmObject.java:135)
	at com.github.unidbg.linux.android.dvm.DvmClass.callStaticJniMethodObject(DvmClass.java:316)
	at com.test2.TEST2.callSign(TEST2.java:47)
	at com.test2.TEST2.main(TEST2.java:58)
</code></pre>
<p>é¦–å…ˆï¼Œè¯»è€…éœ€è¦æ„è¯†åˆ°ï¼Œè¿™å¹¶ä¸æ˜¯çœŸæ­£çš„â€œæŠ¥é”™â€ï¼Œè€Œæ˜¯Unidbgä¸ºäº†æé†’æˆ‘ä»¬è¡¥JNIç¯å¢ƒï¼Œä¸»åŠ¨æŠ›å‡ºçš„å¼‚å¸¸ã€‚æ¥ä¸‹æ¥é¦–å…ˆè®¨è®ºå¼‚å¸¸ã€‚</p>
<h4 id="5-1-å¼‚å¸¸"><a href="#5-1-å¼‚å¸¸" class="headerlink" title="5.1 å¼‚å¸¸"></a>5.1 å¼‚å¸¸</h4><p>æŠ¥é”™å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†</p>
<p>ç¬¬ä¸€éƒ¨åˆ†</p>
<pre><code class="language-shell">[15:23:19 214]  WARN [com.github.unidbg.linux.ARM32SyscallHandler] (ARM32SyscallHandler:538) - handleInterrupt intno=2, NR=-452987556, svcNumber=0x170, PC=unidbg@0xfffe0794, LR=RX@0x1204db2f[libnet_crypto.so]0x4db2f, syscall=null
</code></pre>
<p>æ—¥å¿—è¾“å‡ºçš„ä½ç½®æ˜¯**[com.github.unidbg.linux.ARM32SyscallHandler] (ARM32SyscallHandler:538)**<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705152744055.png" alt="image-20250705152744055"></p>
<p>å¯èƒ½ä¼šæ„Ÿåˆ°ç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆå¤„ç†JNIçš„é€»è¾‘ï¼Œå…¶æŠ¥é”™åœ¨ <strong>Arm32SyscallHandler</strong>ï¼Œè¿™ä¼¼ä¹æ˜¯ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†æ¨¡å—å§ï¼Ÿ</p>
<p>äº‹å®ä¸Šï¼ŒUnidbgæ­£æ˜¯å‡­æ­¤å®ç°äº†å¯¹JNIçš„ä»£ç†ï¼Œé¦–å…ˆå®ƒæ„é€ äº†<strong>JNIEnv</strong>å’Œ<strong>JavaVM</strong>è¿™ä¸¤ä¸ªJNIä¸­çš„å…³é”®ç»“æ„ï¼Œå®ƒä»¬æ˜¯æŒ‡å‘JNIå‡½æ•°è¡¨çš„äºŒçº§æŒ‡é’ˆã€‚åœ¨å¤„ç†å‡½æ•°è¡¨æ—¶ï¼ŒUnidbgå°†å‡½æ•°éƒ½å¯¼å‘ä¸€ä¸ªå…«å­—èŠ‚çš„è·³æ¿å‡½æ•°ã€‚</p>
<pre><code class="language-c">svc #imm;
bx lr;
</code></pre>
<p>æ¯”å¦‚æ ·æœ¬ä¸­soæ–‡ä»¶çš„<strong>ReleaseStringUTFChars</strong>å‡½æ•°<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705153939780.png" alt="image-20250705153939780"></p>
<p>æ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-c">.text:00066B14                 LDR             R0, [R6]
.text:00066B16                 LDR.W           R3, [R0,#0x2A8]
.text:00066B1A                 MOV             R0, R6
.text:00066B1C                 MOV             R1, R5
.text:00066B1E                 MOV             R2, R4
.text:00066B20                 BLX             R3
</code></pre>
<p>åœ¨çœŸå®çš„Androidç¯å¢ƒä¸­ï¼Œè¿™é‡Œé€šè¿‡R3è·³åˆ°äº†<strong>ReleaseStringUTFChars</strong>ä½äºlibart.soçš„çœŸæ­£å®ç°ä¸Šã€‚</p>
<p>åœ¨Unidbgé‡Œï¼Œåˆ™æ˜¯è½åˆ°æˆ‘ä»¬çš„è·³æ¿å‡½æ•°ä¸Šã€‚</p>
<p>å¯¹äºæ­¤å¤„çš„<strong>ReleaseStringUTFChars</strong>å‡½æ•°ï¼Œæ˜¯ä¸‹é¢ä¸¤æ¡</p>
<pre><code class="language-c">svc #0x1a1;
bx lr;
</code></pre>
<blockquote>
<p><strong>SVC</strong>æ˜¯è½¯ä¸­æ–­ï¼ŒUnicornç­‰CPUæ¨¡æ‹Ÿå™¨ä¼šæ‹¦æˆªè¿™äº›ä¸­æ–­ï¼Œè¿›è€ŒUnidbgå¯ä»¥æ¥ç®¡è¿™äº›ä¸­æ–­ï¼Œå¹¶å¯¹JNIè°ƒç”¨åšæ¨¡æ‹Ÿã€‚å¯æ˜¯Unidbgå¦‚ä½•åˆ†è¾¨ç³»ç»Ÿè°ƒç”¨å’ŒJNIè°ƒç”¨ï¼Ÿæ¯•ç«Ÿç³»ç»Ÿè°ƒç”¨ä¹Ÿæ˜¯é€šè¿‡<strong>SVC</strong>è½¯ä¸­æ–­å‘èµ·ã€‚è¿™å°±ä¾èµ–äº<strong>SVC</strong>åé¢è·Ÿç€çš„æ•°å­—ï¼Œè¿™é‡Œæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>imm</strong>ã€‚</p>
</blockquote>
<p>åœ¨ç³»ç»Ÿè°ƒç”¨çš„è°ƒç”¨çº¦å®šé‡Œï¼Œ<strong>imm</strong>æ— å®é™…æ„ä¹‰ï¼Œè€Œä¸”é»˜è®¤ä¼šä½¿ç”¨0ï¼Œå³<strong>SVC 0</strong>ï¼Œå°±åƒä¸‹é¢è¿™æ ·</p>
<pre><code class="language-c">.text:0004147C                 MOV             R12, R7
.text:00041480                 LDR             R7, =0x142
.text:00041484                 SVC             0
</code></pre>
<p>å› æ­¤ï¼Œæ ¹æ® <strong>imm</strong> æ˜¯å¦ä¸º0ï¼ŒUnidbgç¡®è®¤é€»è¾‘åº”è¯¥å¯¼å‘æ¨¡æ‹Ÿçš„JNIå‡½æ•°è¿˜æ˜¯æ¨¡æ‹Ÿçš„ç³»ç»Ÿè°ƒç”¨ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œåœ¨Unidbgä¸­ï¼ŒJNIå‡½æ•°è¢«æå‡åˆ°äº†å’Œç³»ç»Ÿè°ƒç”¨ç›¸åŒçš„å±‚çº§ï¼Œå› æ­¤JNIæŠ¥é”™ä¹Ÿå‘ç”Ÿåœ¨syscallHandleré‡Œé¢ã€‚</p>
<p>å¯¹äºæŠ¥é”™çš„è¿™ç¬¬ä¸€éƒ¨åˆ†ï¼Œæœ‰æ„ä¹‰çš„æ˜¯ <strong>LR</strong>ï¼Œå®ƒå³JNIè·³æ¿å‡½æ•°çš„è¿”å›åœ°å€ï¼Œå¯¹åº”äºæ ·æœ¬å‘èµ·JNIè°ƒç”¨çš„ä½ç½®ã€‚</p>
<pre><code class="language-shell">[15:23:19 214]  WARN [com.github.unidbg.linux.ARM32SyscallHandler] (ARM32SyscallHandler:538) - handleInterrupt intno=2, NR=-452987556, svcNumber=0x170, PC=unidbg@0xfffe0794, LR=RX@0x1204db2f[libnet_crypto.so]0x4db2f, syscall=null
</code></pre>
<p>ç¬¬äºŒéƒ¨åˆ†æ˜¯å…¶ä½™éƒ¨åˆ†</p>
<pre><code class="language-shell">java.lang.UnsupportedOperationException: com/izuiyou/common/base/BaseApplication-&gt;getAppContext()Landroid/content/Context;
	at com.github.unidbg.linux.android.dvm.AbstractJni.callStaticObjectMethodV(AbstractJni.java:504)
	at com.github.unidbg.linux.android.dvm.AbstractJni.callStaticObjectMethodV(AbstractJni.java:438)
	at com.github.unidbg.linux.android.dvm.DvmMethod.callStaticObjectMethodV(DvmMethod.java:59)
</code></pre>
<p>é¦–å…ˆæ˜¯Unidbgæ— æ³•å¤„ç†çš„å‡½æ•°å…¶ç­¾å<strong>com&#x2F;izuiyou&#x2F;common&#x2F;base&#x2F;BaseApplication-&gt;getAppContext()Landroid&#x2F;content&#x2F;Context;</strong>ï¼Œè¿™ä¸ªæ ¼å¼å¾ˆæ¸…æ™°ï¼Œå³<strong>com&#x2F;izuiyou&#x2F;common&#x2F;base&#x2F;BaseApplication</strong>ç±»çš„<strong>getAppContext</strong>æ–¹æ³•ã€‚</p>
<p>å†çœ‹å®ƒçš„è°ƒç”¨æ ˆï¼Œæ¥è‡ªäº<strong>callStaticObjectMethodV</strong>è¿™ä¸ªJNIæ–¹æ³•ã€‚æ¥ä¸‹æ¥è®¨è®ºä¸ºä»€ä¹ˆè¦è¡¥JNIç¯å¢ƒã€‚</p>
<h4 id="5-2-è¡¥ç¯å¢ƒåŸå› "><a href="#5-2-è¡¥ç¯å¢ƒåŸå› " class="headerlink" title="5.2 è¡¥ç¯å¢ƒåŸå› "></a>5.2 è¡¥ç¯å¢ƒåŸå› </h4><p>ä¸ºä»€ä¹ˆè¦è¡¥JNIç¯å¢ƒï¼Ÿ</p>
<p>ä¸ŠèŠ‚è®²åˆ°ï¼ŒUnidbgé€šè¿‡æ„é€ <strong>JNIEnv</strong>ï¼Œ<strong>JavaVM</strong>ç»“æ„ï¼Œè¾…ä¹‹ä»¥<strong>SVC</strong>è·³æ¿å‡½æ•°ï¼Œå®ç°äº†å¯¹<strong>JNI</strong>çš„æ‹¦æˆªå’Œæ¥ç®¡ã€‚</p>
<p>ä½†åˆ°åº•å¦‚ä½•å»æ¨¡æ‹ŸJNIå‡½æ•°ï¼Œè¿™æ˜¯é—®é¢˜çš„æ ¸å¿ƒã€‚Unidbgå®ç°äº†ä¸€å¥—JNIå¤„ç†é€»è¾‘ï¼Œå½“é‡åˆ°JNIè°ƒç”¨æ—¶ï¼Œå¦‚æœæ˜¯<strong>FindClass</strong>ã€<strong>NewGlobalRef</strong>ã€<strong>GetObjectClass</strong>ã€<strong>GetMethodID</strong>ã€<strong>GetStringLength</strong>ã€<strong>GetStringChars</strong>ã€<strong>ReleaseStringChars</strong>ç­‰ç­‰å‡½æ•°ï¼Œå®ƒéƒ½å¯ä»¥è‡ªæ´½å¤„ç†ï¼Œä¸éœ€è¦ä½¿ç”¨è€…ä»‹å…¥ã€‚</p>
<p>ä»¥GetStringLengthä¸ºä¾‹ï¼Œè·å–å­—ç¬¦ä¸²é•¿åº¦ï¼Œä¸éœ€è¦ä½¿ç”¨è€…å»åšä»€ä¹ˆäº‹ã€‚</p>
<pre><code class="language-Java">Pointer _GetStringLength = svcMemory.registerSvc(new ArmSvc() &#123;
    @Override
    public long handle(Emulator&lt;?&gt; emulator) &#123;
        RegisterContext context = emulator.getContext();
        UnidbgPointer object = context.getPointerArg(1);
        DvmObject&lt;?&gt; string = getObject(object.toIntPeer());
        String value = (String) Objects.requireNonNull(string).getValue();
        return value.length();
    &#125;
&#125;);
</code></pre>
<p>é‚£ä¹ˆè¡¥JNIç¯å¢ƒçš„éœ€æ±‚åœ¨å“ªé‡Œï¼Ÿåœ¨äºå¦‚æœæ˜¯<strong>callStaticObjectMethod</strong>ã€<strong>callObjectMethod</strong>ã€<strong>getObjectField</strong>ã€<strong>getStaticIntField</strong>ç­‰JNIå‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯¹æ ·æœ¬çš„Javaå±‚æ•°æ®åšè®¿é—®ï¼ŒUnidbgæ—¢æœªè¿è¡ŒDexï¼Œæ›´æ²¡æ³•è¿è¡ŒApkï¼Œå› ä¸ºéœ€è¦å€ŸåŠ©ä½¿ç”¨è€…ï¼Œå»è¡¥å……è¿™äº›å¤–éƒ¨çš„ä¿¡æ¯ã€‚</p>
<p>å› ä¸ºæ‹…å¿ƒç”¨æˆ·æ„è¯†ä¸åˆ°è¡¥JNIçš„éœ€æ±‚ï¼Œæ‰€ä»¥é€šè¿‡æŠ›å‡ºæŠ¥é”™å’Œæ‰“å°å †æ ˆäºˆä»¥æé†’ã€‚</p>
<p>éœ€è¦æ³¨æ„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰åŸºäºJNIå‘èµ·çš„å‡½æ•°è°ƒç”¨ã€å­—æ®µè®¿é—®éƒ½å¿…é¡»ç”±ç”¨æˆ·å¤„ç†ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå…¶ä¸­æœ‰éƒ¨åˆ†å¯ä»¥è¢«é¢„å¤„ç†ã€‚ä¸¾ä¸€äº›ä¾‹å­ã€‚</p>
<ul>
<li>Android PackageManager ç±»é‡Œçš„ GET_SIGNATURES é™æ€å­—æ®µ ï¼Œå®ƒçš„å€¼å›ºå®šæ˜¯ 64</li>
<li>String ç±»çš„ getBytes æ–¹æ³•</li>
<li>List å®ç°ç±»çš„ size æ–¹æ³•</li>
</ul>
<p>ä¸ºäº†å‡å°‘ç”¨æˆ·çš„è¡¥JNIè´Ÿæ‹…ï¼Œæ‰€ä»¥Unidbgé¢„å¤„ç†äº†æ•°ç™¾ä¸ªå¸¸è§çš„JNIå‡½æ•°è°ƒç”¨å’Œå­—æ®µè®¿é—®ï¼Œé€»è¾‘ä½äº<strong>src&#x2F;main&#x2F;java&#x2F;com&#x2F;github&#x2F;unidbg&#x2F;linux&#x2F;android&#x2F;dvm&#x2F;AbstractJni.java</strong>ç±»é‡Œã€‚</p>
<p>æ¯”å¦‚<strong>callBooleanMethodV</strong>ï¼Œè°ƒç”¨å’Œè¿”å›å¸ƒå°”å€¼çš„å®ä¾‹æ–¹æ³•ï¼Œé¢„å¤„ç†äº†å¦‚ä¸‹æ–¹æ³•ã€‚</p>
<pre><code class="language-Java">@Override
public boolean callBooleanMethodV(BaseVM vm, DvmObject&lt;?&gt; dvmObject, String signature, VaList vaList) &#123;
    switch (signature) &#123;
        case &quot;java/util/Enumeration-&gt;hasMoreElements()Z&quot;:
            return ((Enumeration) dvmObject).hasMoreElements();
        case &quot;java/util/ArrayList-&gt;isEmpty()Z&quot;:
            return ((ArrayListObject) dvmObject).isEmpty();
        case &quot;java/util/Iterator-&gt;hasNext()Z&quot;:
            Object iterator = dvmObject.getValue();
            if (iterator instanceof Iterator) &#123;
                return ((Iterator&lt;?&gt;) iterator).hasNext();
            &#125;
        case &quot;java/lang/String-&gt;startsWith(Ljava/lang/String;)Z&quot;:&#123;
            String str = (String) dvmObject.getValue();
            StringObject prefix = vaList.getObjectArg(0);
            return str.startsWith(prefix.value);
        &#125;
    &#125;

    throw new UnsupportedOperationException(signature);
&#125;
</code></pre>
<p>æ¯”å¦‚<strong>getObjectField</strong>ï¼Œè®¿é—®å¯¹è±¡ç±»å‹çš„å®ä¾‹å­—æ®µï¼Œåšäº†å¦‚ä¸‹å¤„ç†</p>
<pre><code class="language-Java">@Override
public DvmObject&lt;?&gt; getObjectField(BaseVM vm, DvmObject&lt;?&gt; dvmObject, String signature) &#123;
    if (&quot;android/content/pm/PackageInfo-&gt;signatures:[Landroid/content/pm/Signature;&quot;.equals(signature) &amp;&amp;
            dvmObject instanceof PackageInfo) &#123;
        PackageInfo packageInfo = (PackageInfo) dvmObject;
        if (packageInfo.getPackageName().equals(vm.getPackageName())) &#123;
            CertificateMeta[] metas = vm.getSignatures();
            if (metas != null) &#123;
                Signature[] signatures = new Signature[metas.length];
                for (int i = 0; i &lt; metas.length; i++) &#123;
                    signatures[i] = new Signature(vm, metas[i]);
                &#125;
                return new ArrayObject(signatures);
            &#125;
        &#125;
    &#125;
    if (&quot;android/content/pm/PackageInfo-&gt;versionName:Ljava/lang/String;&quot;.equals(signature) &amp;&amp;
            dvmObject instanceof PackageInfo) &#123;
        PackageInfo packageInfo = (PackageInfo) dvmObject;
        if (packageInfo.getPackageName().equals(vm.getPackageName())) &#123;
            String versionName = vm.getVersionName();
            if (versionName != null) &#123;
                return new StringObject(vm, versionName);
            &#125;
        &#125;
    &#125;

    throw new UnsupportedOperationException(signature);
&#125;
</code></pre>
<p>è¿™ä¸¤ä¸ªè°ƒç”¨æ˜¯è·å–Apkç­¾åä¿¡æ¯ä»¥åŠç‰ˆæœ¬ä¿¡æ¯ï¼ŒUnidbgä¹‹æ‰€ä»¥èƒ½å¤„ç†ï¼Œä¾èµ–æˆ‘ä»¬ä¼ å…¥çš„APKï¼Œè§£æå‡ºäº†è¿™äº›ä¿¡æ¯ã€‚</p>
<p>åœ¨AbstractJNI ä¸­ï¼Œä¸‹é¢å››ç±»å¤„ç†ä¸ºä¸»</p>
<ul>
<li>App åŸºæœ¬ä¿¡æ¯ä¸ç­¾å</li>
<li>JDK åŠ å¯†è§£å¯†ä¸æ•°å­—ç­¾å</li>
<li>å­—ç¬¦ä¸²å’Œå®¹å™¨ç±»å‹</li>
<li>Android FrameWork ç±»åº“</li>
</ul>
<p>ç¬¬ä¸€ç±»å°±æ¯”å¦‚ä¸Šé¢çš„ä¸¤ä¸ªï¼Œä½†ä¸æ­¢äºæ­¤ï¼ŒåŠ è½½å’Œè§£æAPKè®©Unidbgè·å–äº†å¤§é‡çš„ä¿¡æ¯ã€‚</p>
<p>æ¯”å¦‚å¤„ç†è·å–åŒ…åï¼š</p>
<pre><code class="language-Java">@Override
public DvmObject&lt;?&gt; callStaticObjectMethod(BaseVM vm, DvmClass dvmClass, String signature, VarArg varArg) &#123;
    if (&quot;android/app/ActivityThread-&gt;currentPackageName()Ljava/lang/String;&quot;.equals(signature)) &#123;
        String packageName = vm.getPackageName();
        if (packageName != null) &#123;
            return new StringObject(vm, packageName);
        &#125;
    &#125;
    throw new UnsupportedOperationException(signature);
&#125;
</code></pre>
<p>æ¯”å¦‚ç‰ˆæœ¬å·ï¼š</p>
<pre><code class="language-Java">@Override
public int getIntField(BaseVM vm, DvmObject&lt;?&gt; dvmObject, String signature) &#123;
    if (&quot;android/content/pm/PackageInfo-&gt;versionCode:I&quot;.equals(signature)) &#123;
        return (int) vm.getVersionCode();
    &#125;
    throw new UnsupportedOperationException(signature);
&#125;
</code></pre>
<p>ç¬¬äºŒç±»æ˜¯JavaåŠ è§£å¯†å’Œæ•°å­—ç­¾åç›¸å…³çš„æ–¹æ³•ï¼Œå®ƒä¸»è¦æœåŠ¡äºApkç­¾åæ ¡éªŒï¼Œå‡ºç°é¢‘ç‡å¾ˆé«˜ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="language-Java">case &quot;java/security/KeyFactory-&gt;getInstance(Ljava/lang/String;)Ljava/security/KeyFactory;&quot;:&#123;
    StringObject algorithm = vaList.getObjectArg(0);
    assert algorithm != null;
    try &#123;
        return dvmClass.newObject(KeyFactory.getInstance(algorithm.value));
    &#125; catch (NoSuchAlgorithmException e) &#123;
        throw new IllegalStateException(e);
    &#125;
&#125;
case &quot;javax/crypto/Cipher-&gt;getInstance(Ljava/lang/String;)Ljavax/crypto/Cipher;&quot;:&#123;
    StringObject transformation = vaList.getObjectArg(0);
    assert transformation != null;
    try &#123;
        return dvmClass.newObject(Cipher.getInstance(transformation.value));
    &#125; catch (NoSuchAlgorithmException | NoSuchPaddingException e) &#123;
        throw new IllegalStateException(e);
    &#125;
&#125;
case &quot;java/security/MessageDigest-&gt;getInstance(Ljava/lang/String;)Ljava/security/MessageDigest;&quot;: &#123;
    StringObject type = vaList.getObjectArg(0);
    assert type != null;
    try &#123;
        return dvmClass.newObject(MessageDigest.getInstance(type.value));
    &#125; catch (NoSuchAlgorithmException e) &#123;
        throw new IllegalStateException(e);
    &#125;
&#125;
</code></pre>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="language-Java">case &quot;javax/crypto/spec/SecretKeySpec-&gt;&lt;init&gt;([BLjava/lang/String;)V&quot;:&#123;
    byte[] key = (byte[]) vaList.getObjectArg(0).value;
    StringObject algorithm = vaList.getObjectArg(1);
    assert algorithm != null;
    SecretKeySpec secretKeySpec = new SecretKeySpec(key, algorithm.value);
    return dvmClass.newObject(secretKeySpec);
&#125;
</code></pre>
<p>ç¬¬ä¸‰ç±»æ˜¯å¯¹åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»ã€å­—ç¬¦ä¸²ã€å®¹å™¨ç±»å‹çš„å¤„ç†ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="language-Java">@Override
public DvmObject&lt;?&gt; newObject(BaseVM vm, DvmClass dvmClass, String signature, VarArg varArg) &#123;
    switch (signature) &#123;
        case &quot;java/lang/String-&gt;&lt;init&gt;([B)V&quot;:
            ByteArray array = varArg.getObjectArg(0);
            return new StringObject(vm, new String(array.getValue()));
        case &quot;java/lang/String-&gt;&lt;init&gt;([BLjava/lang/String;)V&quot;:
            array = varArg.getObjectArg(0);
            StringObject string = varArg.getObjectArg(1);
            try &#123;
                return new StringObject(vm, new String(array.getValue(), string.getValue()));
            &#125; catch (UnsupportedEncodingException e) &#123;
                throw new IllegalStateException(e);
            &#125;
    &#125;

    throw new UnsupportedOperationException(signature);
&#125;
</code></pre>
<p>å†æ¯”å¦‚ï¼š</p>
<pre><code class="language-Java">@Override
public boolean callBooleanMethodV(BaseVM vm, DvmObject&lt;?&gt; dvmObject, String signature, VaList vaList) &#123;
    switch (signature) &#123;
        case &quot;java/util/Enumeration-&gt;hasMoreElements()Z&quot;:
            return ((Enumeration) dvmObject).hasMoreElements();
        case &quot;java/util/ArrayList-&gt;isEmpty()Z&quot;:
            return ((ArrayListObject) dvmObject).isEmpty();
        case &quot;java/util/Iterator-&gt;hasNext()Z&quot;:
            Object iterator = dvmObject.getValue();
            if (iterator instanceof Iterator) &#123;
                return ((Iterator&lt;?&gt;) iterator).hasNext();
            &#125;
        case &quot;java/lang/String-&gt;startsWith(Ljava/lang/String;)Z&quot;:&#123;
            String str = (String) dvmObject.getValue();
            StringObject prefix = vaList.getObjectArg(0);
            return str.startsWith(prefix.value);
        &#125;
    &#125;

    throw new UnsupportedOperationException(signature);
&#125;
</code></pre>
<p>å†æ¯”å¦‚ï¼š</p>
<pre><code class="language-Java">case &quot;java/lang/Integer-&gt;intValue()I&quot;: &#123;
    DvmInteger integer = (DvmInteger) dvmObject;
    return integer.value;
&#125;
case &quot;java/util/List-&gt;size()I&quot;:
    List&lt;?&gt; list = (List&lt;?&gt;) dvmObject.getValue();
    return list.size();
case &quot;java/util/Map-&gt;size()I&quot;:
    Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) dvmObject.getValue();
    return map.size();
</code></pre>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="language-Java">case &quot;java/util/ArrayList-&gt;remove(I)Ljava/lang/Object;&quot;: &#123;
    int index = vaList.getIntArg(0);
    ArrayListObject list = (ArrayListObject) dvmObject;
    return list.value.remove(index);
&#125;
case &quot;java/util/List-&gt;get(I)Ljava/lang/Object;&quot;:
    List&lt;?&gt; list = (List&lt;?&gt;) dvmObject.getValue();
    return (DvmObject&lt;?&gt;) list.get(vaList.getIntArg(0));
case &quot;java/util/Map-&gt;entrySet()Ljava/util/Set;&quot;:
    Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) dvmObject.getValue();
    return vm.resolveClass(&quot;java/util/Set&quot;).newObject(map.entrySet());
case &quot;java/util/Set-&gt;iterator()Ljava/util/Iterator;&quot;:
    Set&lt;?&gt; set = (Set&lt;?&gt;) dvmObject.getValue();
    return vm.resolveClass(&quot;java/util/Iterator&quot;).newObject(set.iterator());
</code></pre>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="language-Java">case &quot;java/lang/String-&gt;getBytes()[B&quot;: &#123;
    String str = (String) dvmObject.getValue();
    return new ByteArray(vm, str.getBytes());
&#125;
case &quot;java/lang/String-&gt;getBytes(Ljava/lang/String;)[B&quot;:
    String str = (String) dvmObject.getValue();
    StringObject charsetName = vaList.getObjectArg(0);
    assert charsetName != null;
    try &#123;
        return new ByteArray(vm, str.getBytes(charsetName.value));
    &#125; catch (UnsupportedEncodingException e) &#123;
        throw new IllegalStateException(e);
    &#125;
</code></pre>
<p>ç¬¬å››ç±»æ˜¯ä¾èµ–äºAndroid FrameWorkçš„ç±»åº“ï¼Œå®ƒä»¬æ²¡æ³•åœ¨æ™®é€šçš„Javaç¯å¢ƒé‡Œè‰¯å¥½çš„å¤„ç†ï¼Œå› æ­¤éœ€è¦åšä¸€äº›ç²—ç³™çš„æ¨¡æ‹Ÿæˆ–è€…å ä½ã€‚</p>
<p>æ¯”å¦‚Androidç³»ç»ŸæœåŠ¡</p>
<pre><code class="language-Java">case &quot;android/app/Application-&gt;getSystemService(Ljava/lang/String;)Ljava/lang/Object;&quot;: &#123;
    StringObject serviceName = vaList.getObjectArg(0);
    assert serviceName != null;
    return new SystemService(vm, serviceName.getValue());
</code></pre>
<p>SystemService çš„å®ç°å¦‚ä¸‹ï¼Œå°±æ˜¯å¤§é‡çš„ç®€å•å ä½ï¼Œè°ƒç”¨å…¶ä¸­çš„æ–¹æ³•å®é™…è·å–æ•°æ®æ—¶ï¼Œè¿˜æ˜¯è¦ä½¿ç”¨è€…æ¥è¡¥ã€‚</p>
<pre><code class="language-Java">package com.github.unidbg.linux.android.dvm.api;

import com.github.unidbg.arm.backend.BackendException;
import com.github.unidbg.linux.android.dvm.DvmClass;
import com.github.unidbg.linux.android.dvm.DvmObject;
import com.github.unidbg.linux.android.dvm.VM;

public class SystemService extends DvmObject&lt;String&gt; &#123;

    public static final String WIFI_SERVICE = &quot;wifi&quot;;
    public static final String CONNECTIVITY_SERVICE = &quot;connectivity&quot;;
    public static final String TELEPHONY_SERVICE = &quot;phone&quot;;
    public static final String ACCESSIBILITY_SERVICE = &quot;accessibility&quot;;
    public static final String KEYGUARD_SERVICE = &quot;keyguard&quot;;
    public static final String ACTIVITY_SERVICE = &quot;activity&quot;;
    public static final String SENSOR_SERVICE = &quot;sensor&quot;;
    public static final String INPUT_METHOD_SERVICE = &quot;input_method&quot;;
    public static final String LOCATION_SERVICE = &quot;location&quot;;
    public static final String WINDOW_SERVICE = &quot;window&quot;;
    public static final String UI_MODE_SERVICE = &quot;uimode&quot;;
    public static final String DISPLAY_SERVICE = &quot;display&quot;;
    public static final String AUDIO_SERVICE = &quot;audio&quot;;
    
    public SystemService(VM vm, String serviceName) &#123;
        super(getObjectType(vm, serviceName), serviceName);
    &#125;

    private static DvmClass getObjectType(VM vm, String serviceName) &#123;
        switch (serviceName) &#123;
            case TELEPHONY_SERVICE:
                return vm.resolveClass(&quot;android/telephony/TelephonyManager&quot;);
            case WIFI_SERVICE:
                return vm.resolveClass(&quot;android/net/wifi/WifiManager&quot;);
            case CONNECTIVITY_SERVICE:
                return vm.resolveClass(&quot;android/net/ConnectivityManager&quot;);
            case ACCESSIBILITY_SERVICE:
                return vm.resolveClass(&quot;android/view/accessibility/AccessibilityManager&quot;);
            case KEYGUARD_SERVICE:
                return vm.resolveClass(&quot;android/app/KeyguardManager&quot;);
            case ACTIVITY_SERVICE:
                return vm.resolveClass(&quot;android/os/BinderProxy&quot;); // android/app/ActivityManager
            case SENSOR_SERVICE:
                return vm.resolveClass(&quot;android/hardware/SensorManager&quot;);
            case INPUT_METHOD_SERVICE:
                return vm.resolveClass(&quot;android/view/inputmethod/InputMethodManager&quot;);
            case LOCATION_SERVICE:
                return vm.resolveClass(&quot;android/location/LocationManager&quot;);
            case WINDOW_SERVICE:
                return vm.resolveClass(&quot;android/view/WindowManager&quot;);
            case UI_MODE_SERVICE:
                return vm.resolveClass(&quot;android/app/UiModeManager&quot;);
            case DISPLAY_SERVICE:
                return vm.resolveClass(&quot;android/hardware/display/DisplayManager&quot;);
            case AUDIO_SERVICE:
                return vm.resolveClass(&quot;android/media/AudioManager&quot;);
            default:
                throw new BackendException(&quot;service failed: &quot; + serviceName);
        &#125;
    &#125;

&#125;
</code></pre>
<p>åœ¨è¿‡å»å‡ å¹´çš„æ›´æ–°é‡Œï¼ŒUnidbg ä¸€ç›´åœ¨å¯¹ AbstractJNI åšæ‰©å……ï¼Œè®©å®ƒé¢„å¤„ç†æ›´å¤šçš„é€»è¾‘ï¼Œå‡å°‘ç”¨æˆ·çš„ä½¿ç”¨è´Ÿæ‹…ã€‚</p>
<p>å…³äº AbstractJNI å¯ä»¥åšä¸¤ç‚¹æ€»ç»“ã€‚</p>
<ol>
<li>ç¡®å®èƒ½è®©æˆ‘ä»¬å…äºä¸€äº›è¡¥ç¯å¢ƒçš„è‹¦æ¼</li>
<li>ç›¸è¾ƒäºæ‰€æœ‰å¯èƒ½çš„ JNI è®¿é—®ï¼Œå®ƒåªæ˜¯æ¯æ°´è½¦è–ªï¼Œè¡¥ JNI ç¯å¢ƒè¿™ä¸ªæ­¥éª¤ä¸å¯é¿å…ã€‚</li>
</ol>
<p>æˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ç‚¹ï¼Œå‰ä¸¤ç¯‡æ ·æœ¬çš„å¤„ç†ï¼Œéƒ½æ²¡æœ‰é‡åˆ° JNI è¡¥ç¯å¢ƒçš„éœ€æ±‚ï¼Œè¿™å°±æ˜¯ AbstractJNI æ›¿æˆ‘ä»¬ä»£åŠ³äº†ã€‚</p>
<p>æ¯”å¦‚ç¬¬ä¸€ç¯‡æ–‡ç« çš„æ—¥å¿—å¦‚ä¸‹ï¼š</p>
<pre><code class="language-shell">JNIEnv-&gt;FindClass(android/app/ActivityThread) was called from RX@0x12010e20[liboasiscore.so]0x10e20
JNIEnv-&gt;GetStaticMethodID(android/app/ActivityThread.currentApplication()Landroid/app/Application;) =&gt; 0xc1600375 was called from RX@0x12010f40[liboasiscore.so]0x10f40
JNIEnv-&gt;CallStaticObjectMethodV(class android/app/ActivityThread, currentApplication() =&gt; android.app.Application@3d680b5a) was called from RX@0x120126cc[liboasiscore.so]0x126cc
JNIEnv-&gt;FindClass(android/content/ContextWrapper) was called from RX@0x12011024[liboasiscore.so]0x11024
JNIEnv-&gt;GetMethodID(android/content/ContextWrapper.getPackageManager()Landroid/content/pm/PackageManager;) =&gt; 0x53f2c391 was called from RX@0x12011050[liboasiscore.so]0x11050
JNIEnv-&gt;CallObjectMethodV(android.app.Application@3d680b5a, getPackageManager() =&gt; android.content.pm.PackageManager@4b5d6a01) was called from RX@0x12012630[liboasiscore.so]0x12630
JNIEnv-&gt;GetMethodID(android/content/ContextWrapper.getPackageName()Ljava/lang/String;) =&gt; 0x8bcc2d71 was called from RX@0x120110bc[liboasiscore.so]0x110bc
JNIEnv-&gt;CallObjectMethodV(android.app.Application@3d680b5a, getPackageName() =&gt; &quot;com.sina.oasis&quot;) was called from RX@0x12012630[liboasiscore.so]0x12630
JNIEnv-&gt;GetStringUtfChars(&quot;com.sina.oasis&quot;) was called from RX@0x12011108[liboasiscore.so]0x11108
JNIEnv-&gt;GetMethodID(android/content/pm/PackageManager.getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;) =&gt; 0x3bca8377 was called from RX@0x12011168[liboasiscore.so]0x11168
JNIEnv-&gt;CallObjectMethodV(android.content.pm.PackageManager@4b5d6a01, getPackageInfo(&quot;com.sina.oasis&quot;, 0x40) =&gt; android.content.pm.PackageInfo@3e2e18f2) was called from RX@0x12012630[liboasiscore.so]0x12630
JNIEnv-&gt;GetFieldID(android/content/pm/PackageInfo.signatures [Landroid/content/pm/Signature;) =&gt; 0x25f17218 was called from RX@0x120111bc[liboasiscore.so]0x111bc
JNIEnv-&gt;GetObjectField(android.content.pm.PackageInfo@3e2e18f2, signatures [Landroid/content/pm/Signature; =&gt; [android.content.pm.Signature@8f4ea7c]) was called from RX@0x120111d4[liboasiscore.so]0x111d4
JNIEnv-&gt;GetObjectArrayElement([android.content.pm.Signature@8f4ea7c], 0) =&gt; android.content.pm.Signature@8f4ea7c was called from RX@0x120111ec[liboasiscore.so]0x111ec
JNIEnv-&gt;GetMethodID(android/content/pm/Signature.toCharsString()Ljava/lang/String;) =&gt; 0x7a908191 was called from RX@0x1201122c[liboasiscore.so]0x1122c
JNIEnv-&gt;CallObjectMethodV(android.content.pm.Signature@8f4ea7c, toCharsString() =&gt; &quot;30820295308201fea00302010202044b4ef1bf300d06092a864886f70d010105050030818d310b300906035504061302434e3110300e060355040813074265694a696e673110300e060355040713074265694a696e67312c302a060355040a132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c7464312c302a060355040b132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c74643020170d3130303131343130323831355a180f32303630303130323130323831355a30818d310b300906035504061302434e3110300e060355040813074265694a696e673110300e060355040713074265694a696e67312c302a060355040a132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c7464312c302a060355040b132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c746430819f300d06092a864886f70d010101050003818d00308189028181009d367115bc206c86c237bb56c8e9033111889b5691f051b28d1aa8e42b66b7413657635b44786ea7e85d451a12a82a331fced99c48717922170b7fc9bc1040753c0d38b4cf2b22094b1df7c55705b0989441e75913a1a8bd2bc591aa729a1013c277c01c98cbec7da5ad7778b2fad62b85ac29ca28ced588638c98d6b7df5a130203010001300d06092a864886f70d0101050500038181000ad4b4c4dec800bd8fd2991adfd70676fce8ba9692ae50475f60ec468d1b758a665e961a3aedbece9fd4d7ce9295cd83f5f19dc441a065689d9820faedbb7c4a4c4635f5ba1293f6da4b72ed32fb8795f736a20c95cda776402099054fccefb4a1a558664ab8d637288feceba9508aa907fc1fe2b1ae5a0dec954ed831c0bea4&quot;) was called from RX@0x12012630[liboasiscore.so]0x12630
JNIEnv-&gt;GetStringUtfChars(&quot;30820295308201fea00302010202044b4ef1bf300d06092a864886f70d010105050030818d310b300906035504061302434e3110300e060355040813074265694a696e673110300e060355040713074265694a696e67312c302a060355040a132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c7464312c302a060355040b132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c74643020170d3130303131343130323831355a180f32303630303130323130323831355a30818d310b300906035504061302434e3110300e060355040813074265694a696e673110300e060355040713074265694a696e67312c302a060355040a132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c7464312c302a060355040b132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c746430819f300d06092a864886f70d010101050003818d00308189028181009d367115bc206c86c237bb56c8e9033111889b5691f051b28d1aa8e42b66b7413657635b44786ea7e85d451a12a82a331fced99c48717922170b7fc9bc1040753c0d38b4cf2b22094b1df7c55705b0989441e75913a1a8bd2bc591aa729a1013c277c01c98cbec7da5ad7778b2fad62b85ac29ca28ced588638c98d6b7df5a130203010001300d06092a864886f70d0101050500038181000ad4b4c4dec800bd8fd2991adfd70676fce8ba9692ae50475f60ec468d1b758a665e961a3aedbece9fd4d7ce9295cd83f5f19dc441a065689d9820faedbb7c4a4c4635f5ba1293f6da4b72ed32fb8795f736a20c95cda776402099054fccefb4a1a558664ab8d637288feceba9508aa907fc1fe2b1ae5a0dec954ed831c0bea4&quot;) was called from RX@0x12011278[liboasiscore.so]0x11278
JNIEnv-&gt;ReleaseStringUTFChars(&quot;30820295308201fea00302010202044b4ef1bf300d06092a864886f70d010105050030818d310b300906035504061302434e3110300e060355040813074265694a696e673110300e060355040713074265694a696e67312c302a060355040a132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c7464312c302a060355040b132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c74643020170d3130303131343130323831355a180f32303630303130323130323831355a30818d310b300906035504061302434e3110300e060355040813074265694a696e673110300e060355040713074265694a696e67312c302a060355040a132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c7464312c302a060355040b132353696e612e436f6d20546563686e6f6c6f677920284368696e612920436f2e204c746430819f300d06092a864886f70d010101050003818d00308189028181009d367115bc206c86c237bb56c8e9033111889b5691f051b28d1aa8e42b66b7413657635b44786ea7e85d451a12a82a331fced99c48717922170b7fc9bc1040753c0d38b4cf2b22094b1df7c55705b0989441e75913a1a8bd2bc591aa729a1013c277c01c98cbec7da5ad7778b2fad62b85ac29ca28ced588638c98d6b7df5a130203010001300d06092a864886f70d0101050500038181000ad4b4c4dec800bd8fd2991adfd70676fce8ba9692ae50475f60ec468d1b758a665e961a3aedbece9fd4d7ce9295cd83f5f19dc441a065689d9820faedbb7c4a4c4635f5ba1293f6da4b72ed32fb8795f736a20c95cda776402099054fccefb4a1a558664ab8d637288feceba9508aa907fc1fe2b1ae5a0dec954ed831c0bea4&quot;) was called from RX@0x120112b0[liboasiscore.so]0x112b0
JNIEnv-&gt;FindClass(com/weibo/xvideo/NativeApi) was called from RX@0x12011348[liboasiscore.so]0x11348
JNIEnv-&gt;RegisterNatives(com/weibo/xvideo/NativeApi, RW@0x1205d100[liboasiscore.so]0x5d100, 4) was called from RX@0x120113e0[liboasiscore.so]0x113e0
RegisterNative(com/weibo/xvideo/NativeApi, s([BZ)Ljava/lang/String;, RX@0x120116cc[liboasiscore.so]0x116cc)
RegisterNative(com/weibo/xvideo/NativeApi, e(Ljava/lang/String;)Ljava/lang/String;, RX@0x12011af4[liboasiscore.so]0x11af4)
RegisterNative(com/weibo/xvideo/NativeApi, d(Ljava/lang/String;)Ljava/lang/String;, RX@0x12011cd8[liboasiscore.so]0x11cd8)
RegisterNative(com/weibo/xvideo/NativeApi, dg(Ljava/lang/String;Z)Ljava/lang/String;, RX@0x1201220c[liboasiscore.so]0x1220c)
Find native function Java_com_weibo_xvideo_NativeApi_s =&gt; RX@0x120116cc[liboasiscore.so]0x116cc
JNIEnv-&gt;GetByteArrayElements(false) =&gt; [B@5b8dfcc1 was called from RX@0x12011734[liboasiscore.so]0x11734
JNIEnv-&gt;GetArrayLength([B@5b8dfcc1 =&gt; 272) was called from RX@0x1201174c[liboasiscore.so]0x1174c
JNIEnv-&gt;NewStringUTF(&quot;1e3780f50056a3fea76b35592bfc3efc&quot;) was called from RX@0x1201191c[liboasiscore.so]0x1191c
Call s result:
1e3780f50056a3fea76b35592bfc3efc
</code></pre>
<p>å…¶ä¸­çš„<code>FindClass</code>ã€<code>GetStaticMethodID</code>ã€<code>GetMethodID</code>ã€<code>GetStringUtfChars</code>ã€<code>GetFieldID</code>ã€<code>GetObjectArrayElement</code>ã€<code>ReleaseStringUTFChars</code>ã€<code>RegisterNatives</code>ã€<code>GetArrayLength</code>ã€<code>NewStringUTF</code>æ˜¯ Unidbg ç›´æ¥å¯ä»¥å¤„ç†çš„å†…å®¹ã€‚</p>
<p>å…¶ä¸­çš„<code>CallStaticObjectMethodV</code>ã€<code>CallObjectMethodV</code>ã€<code>GetObjectField</code>åˆ™ç”± AbstrctJNI å¤„ç†ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ¡</p>
<pre><code class="language-shell">JNIEnv-&gt;CallStaticObjectMethodV(class android/app/ActivityThread, currentApplication() =&gt; android.app.Application@3d680b5a) was called from RX@0x120126cc[liboasiscore.so]0x126cc
</code></pre>
<p>è€Œç¬¬äºŒç¯‡æ ·æœ¬æ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre><code class="language-shell">Find native function Java_com_sina_weibo_security_WeiboSecurityUtils_calculateS =&gt; RX@0x12001e7d[libutility.so]0x1e7d
JNIEnv-&gt;FindClass(android/content/ContextWrapper) was called from RX@0x12002c4f[libutility.so]0x2c4f
JNIEnv-&gt;GetMethodID(android/content/ContextWrapper.getPackageManager()Landroid/content/pm/PackageManager;) =&gt; 0x53f2c391 was called from RX@0x12002c69[libutility.so]0x2c69
JNIEnv-&gt;FindClass(android/content/pm/PackageManager) was called from RX@0x12002c79[libutility.so]0x2c79
JNIEnv-&gt;CallObjectMethod(android.app.Application@60704c, getPackageManager() =&gt; android.content.pm.PackageManager@2805c96b) was called from RX@0x12002c8d[libutility.so]0x2c8d
JNIEnv-&gt;FindClass(android/content/pm/PackageInfo) was called from RX@0x12002c9d[libutility.so]0x2c9d
JNIEnv-&gt;GetMethodID(android/content/pm/PackageManager.getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;) =&gt; 0x3bca8377 was called from RX@0x12002cb5[libutility.so]0x2cb5
JNIEnv-&gt;NewStringUTF(&quot;com.weico.international&quot;) was called from RX@0x12002cd1[libutility.so]0x2cd1
JNIEnv-&gt;CallObjectMethod(android.content.pm.PackageManager@2805c96b, getPackageInfo(&quot;com.weico.international&quot;, 0x40) =&gt; android.content.pm.PackageInfo@5db250b4) was called from RX@0x12002ce1[libutility.so]0x2ce1
JNIEnv-&gt;GetFieldID(android/content/pm/PackageInfo.signatures [Landroid/content/pm/Signature;) =&gt; 0x25f17218 was called from RX@0x12002d13[libutility.so]0x2d13
JNIEnv-&gt;GetObjectField(android.content.pm.PackageInfo@5db250b4, signatures [Landroid/content/pm/Signature; =&gt; [android.content.pm.Signature@50b472aa]) was called from RX@0x12002d25[libutility.so]0x2d25
JNIEnv-&gt;FindClass(android/content/pm/Signature) was called from RX@0x12002d35[libutility.so]0x2d35
JNIEnv-&gt;GetMethodID(android/content/pm/Signature.toByteArray()[B) =&gt; 0x6a3e2031 was called from RX@0x12002d4d[libutility.so]0x2d4d
JNIEnv-&gt;GetObjectArrayElement([android.content.pm.Signature@50b472aa], 0) =&gt; android.content.pm.Signature@50b472aa was called from RX@0x12002d61[libutility.so]0x2d61
JNIEnv-&gt;CallObjectMethod(android.content.pm.Signature@50b472aa, toByteArray() =&gt; [B@4ac3c60d) was called from RX@0x12002d71[libutility.so]0x2d71
WInlineHookFunction free = RW@0x12176000
JNIEnv-&gt;GetStringUtfChars(&quot;CypCHG2kSlRkdvr2RG1QF8b2lCWXl7k7&quot;) was called from RX@0x12001eb3[libutility.so]0x1eb3
JNIEnv-&gt;GetStringUtfChars(&quot;7926844437&quot;) was called from RX@0x12001ec1[libutility.so]0x1ec1
JNIEnv-&gt;FindClass(java/lang/String) was called from RX@0x12001f33[libutility.so]0x1f33
JNIEnv-&gt;GetMethodID(java/lang/String.&lt;init&gt;([BLjava/lang/String;)V) =&gt; 0x782c535e was called from RX@0x12001f4b[libutility.so]0x1f4b
JNIEnv-&gt;NewByteArray(8) was called from RX@0x12001f61[libutility.so]0x1f61
JNIEnv-&gt;SetByteArrayRegion([B@0x0000000000000000, 0, 8, RW@0x121d3010) was called from RX@0x12001f7f[libutility.so]0x1f7f
JNIEnv-&gt;NewStringUTF(&quot;utf-8&quot;) was called from RX@0x12001f8f[libutility.so]0x1f8f
JNIEnv-&gt;NewObject(class java/lang/String, &lt;init&gt;([B@0x3164356134306466, &quot;utf-8&quot;) =&gt; &quot;1d5a40df&quot;) was called from RX@0x12001f9f[libutility.so]0x1f9f
WInlineHookFunction free = RW@0x121d3010
WInlineHookFunction free = RW@0x121d4000
JNIEnv-&gt;ReleaseStringUTFChars(&quot;7926844437&quot;) was called from RX@0x12001fbd[libutility.so]0x1fbd
call s result:1d5a40df
</code></pre>
<p>æ ·æœ¬é€šè¿‡ JNI è°ƒç”¨äº†è·å–ç­¾åçš„ç›¸å…³ JAVA æ–¹æ³•ï¼ŒAbstractJNI æ›¿æˆ‘ä»¬åšäº†å¤„ç†ã€‚</p>
<h4 id="5-3-åŸºæœ¬è§„èŒƒ"><a href="#5-3-åŸºæœ¬è§„èŒƒ" class="headerlink" title="5.3 åŸºæœ¬è§„èŒƒ"></a>5.3 åŸºæœ¬è§„èŒƒ</h4><p>å›åˆ°æœ€åˆçš„æŠ¥é”™ä¸Š</p>
<pre><code class="language-shell">JNIEnv-&gt;GetStringUtfChars(&quot;hello world&quot;) was called from RX@0x12066b07[libnet_crypto.so]0x66b07
JNIEnv-&gt;ReleaseStringUTFChars(&quot;hello world&quot;) was called from RX@0x12066b23[libnet_crypto.so]0x66b23
JNIEnv-&gt;FindClass(com/izuiyou/common/base/BaseApplication) was called from RX@0x1204da21[libnet_crypto.so]0x4da21
JNIEnv-&gt;GetStaticMethodID(com/izuiyou/common/base/BaseApplication.getAppContext()Landroid/content/Context;) =&gt; 0x2157b33c was called from RX@0x1204da57[libnet_crypto.so]0x4da57
[15:23:19 214]  WARN [com.github.unidbg.linux.ARM32SyscallHandler] (ARM32SyscallHandler:538) - handleInterrupt intno=2, NR=-452987556, svcNumber=0x170, PC=unidbg@0xfffe0794, LR=RX@0x1204db2f[libnet_crypto.so]0x4db2f, syscall=null
java.lang.UnsupportedOperationException: com/izuiyou/common/base/BaseApplication-&gt;getAppContext()Landroid/content/Context;
	at com.github.unidbg.linux.android.dvm.AbstractJni.callStaticObjectMethodV(AbstractJni.java:504)
	at com.github.unidbg.linux.android.dvm.AbstractJni.callStaticObjectMethodV(AbstractJni.java:438)
	at com.github.unidbg.linux.android.dvm.DvmMethod.callStaticObjectMethodV(DvmMethod.java:59)
	at com.github.unidbg.linux.android.dvm.DalvikVM$113.handle(DalvikVM.java:1815)
	at com.github.unidbg.linux.ARM32SyscallHandler.hook(ARM32SyscallHandler.java:131)
	at com.github.unidbg.arm.backend.Unicorn2Backend$11.hook(Unicorn2Backend.java:352)
	at com.github.unidbg.arm.backend.unicorn.Unicorn$NewHook.onInterrupt(Unicorn.java:109)
	at com.github.unidbg.arm.backend.unicorn.Unicorn.emu_start(Native Method)
	at com.github.unidbg.arm.backend.unicorn.Unicorn.emu_start(Unicorn.java:312)
	at com.github.unidbg.arm.backend.Unicorn2Backend.emu_start(Unicorn2Backend.java:389)
	at com.github.unidbg.AbstractEmulator.emulate(AbstractEmulator.java:378)
	at com.github.unidbg.thread.Function32.run(Function32.java:39)
	at com.github.unidbg.thread.MainTask.dispatch(MainTask.java:19)
	at com.github.unidbg.thread.UniThreadDispatcher.run(UniThreadDispatcher.java:165)
	at com.github.unidbg.thread.UniThreadDispatcher.runMainForResult(UniThreadDispatcher.java:97)
	at com.github.unidbg.AbstractEmulator.runMainForResult(AbstractEmulator.java:341)
	at com.github.unidbg.arm.AbstractARMEmulator.eFunc(AbstractARMEmulator.java:255)
	at com.github.unidbg.Module.emulateFunction(Module.java:163)
	at com.github.unidbg.linux.android.dvm.DvmObject.callJniMethod(DvmObject.java:135)
	at com.github.unidbg.linux.android.dvm.DvmClass.callStaticJniMethodObject(DvmClass.java:316)
	at com.test2.TEST2.callSign(TEST2.java:47)
	at com.test2.TEST2.main(TEST2.java:58)
</code></pre>
<p>å‡½æ•°ç­¾åæ˜¯<code>com/izuiyou/common/base/BaseApplication-&gt;getAppContext()Landroid/content/Context;</code>æ ¹æ®æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå®ƒæ¥è‡ª<code>callStaticObjectMethodV</code>è°ƒç”¨ã€‚</p>
<p>å¦‚ä½•æ„é€ å’Œè¡¥ Context æ˜¯ä¸€ä¸ªç‰¹æ®Šé—®é¢˜ï¼Œä¸‹é¢è¿™ä¸ªæ„é€ æ–¹å¼åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹å¯è¡Œã€‚</p>
<pre><code class="language-Java">DvmObject&lt;?&gt; context = vm.resolveClass(&quot;android/app/Application&quot;, vm.resolveClass(&quot;android/content/ContextWrapper&quot;, vm.resolveClass(&quot;android/content/Context&quot;))).newObject(null);
</code></pre>
<p>ä½†è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å¦ä¸€ä¸ªæ–¹å¼æ„é€ ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œè¿™æ˜¯ä¸€ä¸ªå°å‘ï¼Œæ”¾åæ–‡è®¨è®ºï¼Œè¯·è¯»è€…å…ˆå¿è€ä¸€ä¸‹ã€‚</p>
<pre><code class="language-Java">DvmObject&lt;?&gt; context = vm.resolveClass(&quot;cn/xiaochuankeji/tieba/AppController&quot;).newObject(null);
</code></pre>
<p>æ¥ä¸‹æ¥è¡¥ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ AbstractJNI çš„ callStaticObjectMethodV é‡Œæ·»åŠ å¯¹è¿™ä¸ªæ–¹æ³•çš„å¤„ç†ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1667975125845-da7b2d2b-94a4-4cd5-b8de-a900955e2ec4.png" alt="img"></p>
<p>ä½†è¿™ä¹ˆåšä¸æ˜¯å¥½åŠæ³•ï¼Œå¦‚æœæƒ³å°†è‡ªå·±å†™çš„ Unidbg ä»£ç åˆ†äº«ç»™ä»–äººï¼Œæˆ–è¿ç§»åˆ°å…¶ä»–è®¾å¤‡ä¸Šï¼Œå°±å¿…é¡»è¦æŠŠ AbstractJNI ä¸€å¹¶è½¬ç§»ï¼Œè¿™æœ‰äº›éº»çƒ¦ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¡¥çš„ä¹Ÿä¸ä¸€å®šç‰¹åˆ«å¥½ï¼Œæ”¾åˆ° AbstractJNI é‡Œä¼šâ€œæ±¡æŸ“â€ç¯å¢ƒã€‚æ›´æƒ¯å¸¸çš„åšæ³•æ˜¯è®©æœ¬ç±»ç»§æ‰¿ AbstractJNIï¼Œåœ¨åˆ›å»ºè™šæ‹Ÿæœºæ—¶<code>vm.setJni</code>è®¾ç½®ä¸ºå½“å‰ç±»ã€‚</p>
<pre><code class="language-Java">public TEST2() &#123;
        emulator = AndroidEmulatorBuilder
                .for32Bit()
                .addBackendFactory(new Unicorn2Factory(true))
                .setProcessName(&quot;cn.xiaochuankeji.tieba&quot;)
                .build();
        Memory memory = emulator.getMemory();
        memory.setLibraryResolver(new AndroidResolver(23));
        vm = emulator.createDalvikVM(new File(&quot;unidbg-android\\src\\test\\java\\com\\test2\\right573.apk&quot;));

        //è®¾ç½® JNI
        vm.setJni(this);
        vm.setVerbose(true);

        // ä½¿ç”¨libandroid.soè™šæ‹Ÿæ¨¡å—
        new AndroidModule(emulator, vm).register(memory);

        DalvikModule dm = vm.loadLibrary(&quot;net_crypto&quot;, true);
        NetCrypto = vm.resolveClass(&quot;com.izuiyou.network.NetCrypto&quot;);
        dm.callJNI_OnLoad(emulator);
    &#125;
</code></pre>
<p>ç„¶åæœ¬ç±»é‡Œé‡å†™ callStaticObjectMethodV æ–¹æ³•ï¼Œå¤„ç†ç›®æ ‡æ–¹æ³•ã€‚</p>
<pre><code class="language-Java">@Override
public DvmObject&lt;?&gt; callStaticObjectMethodV(BaseVM vm, DvmClass dvmClass, String signature, VaList vaList) &#123;
    switch (signature)&#123;
        case &quot;com/izuiyou/common/base/BaseApplication-&gt;getAppContext()Landroid/content/Context;&quot;:&#123;
            DvmObject&lt;?&gt; context = vm.resolveClass(&quot;cn/xiaochuankeji/tieba/AppController&quot;).newObject(null);
            return context;
        &#125;
    &#125;
    return super.callStaticObjectMethodV(vm, dvmClass, signature, vaList);
&#125;
</code></pre>
<p>è¿™é‡Œè¦è­¦æƒ•å¼ å† ææˆ´ï¼ŒcallStaticObjectMethodV å’Œ callStaticObjectMethod æ˜¯ä¸¤ä¸ªä¸åŒçš„ JNI æ–¹æ³•ï¼Œä¸è¦æ··æ·†ï¼Œæ›´ä¸è¦è¡¥é”™åœ°æ–¹å“­é”™åŸã€‚</p>
<p>åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œæ ·æœ¬è¿‡äºå¤æ‚ï¼Œè¦å¤„ç†çš„ JNI è°ƒç”¨å¤ªå¤šï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ JNI å¤„ç†ç±»ã€‚</p>
<pre><code class="language-Java">package com.izuiyou;

import com.github.unidbg.AndroidEmulator;
import com.github.unidbg.linux.android.dvm.*;

public class zuiYouJNI extends AbstractJni &#123;
    private final AndroidEmulator emulator;

    public zuiYouJNI(AndroidEmulator emulator)&#123;
        this.emulator = emulator;
    &#125;
    
&#125;
</code></pre>
<p>åœ¨æœ¬ç±» setJNI ä¹Ÿå¯¹åº”æ”¹å˜ã€‚</p>
<pre><code class="language-Java">vm.setJni(new zuiYouJNI(emulator));
</code></pre>
<h4 id="5-4-å¼€å§‹è¡¥ç¯å¢ƒ"><a href="#5-4-å¼€å§‹è¡¥ç¯å¢ƒ" class="headerlink" title="5.4 å¼€å§‹è¡¥ç¯å¢ƒ"></a>5.4 å¼€å§‹è¡¥ç¯å¢ƒ</h4><p>è¨€å½’æ­£ä¼ ï¼Œå¤„ç†å®Œè¿™ä¸ªJNIè°ƒç”¨</p>
<pre><code class="language-Java">package com.test2;

import com.github.unidbg.AndroidEmulator;
import com.github.unidbg.arm.backend.Unicorn2Factory;
import com.github.unidbg.linux.android.AndroidEmulatorBuilder;
import com.github.unidbg.linux.android.AndroidResolver;
import com.github.unidbg.linux.android.dvm.*;
import com.github.unidbg.memory.Memory;
import com.github.unidbg.virtualmodule.android.AndroidModule;

import java.io.File;
import java.nio.charset.StandardCharsets;

public class TEST2 extends AbstractJni &#123;
    private final AndroidEmulator emulator;
    private final DvmClass NetCrypto;
    private final VM vm;

    public TEST2() &#123;
        emulator = AndroidEmulatorBuilder
                .for32Bit()
                .addBackendFactory(new Unicorn2Factory(true))
                .setProcessName(&quot;cn.xiaochuankeji.tieba&quot;)
                .build();
        Memory memory = emulator.getMemory();
        memory.setLibraryResolver(new AndroidResolver(23));
        vm = emulator.createDalvikVM(new File(&quot;unidbg-android\\src\\test\\java\\com\\test2\\right573.apk&quot;));

        //è®¾ç½® JNI
        vm.setJni(this);
        vm.setVerbose(true);

        // ä½¿ç”¨libandroid.soè™šæ‹Ÿæ¨¡å—
        new AndroidModule(emulator, vm).register(memory);

        DalvikModule dm = vm.loadLibrary(&quot;net_crypto&quot;, true);
        NetCrypto = vm.resolveClass(&quot;com.izuiyou.network.NetCrypto&quot;);
        dm.callJNI_OnLoad(emulator);
    &#125;

    public String callSign() &#123;
        String arg1 = &quot;hello world&quot;;
        byte[] arg2 = &quot;V I 50&quot;.getBytes(StandardCharsets.UTF_8);
        String ret = null;
        try &#123;
            ret = NetCrypto.callStaticJniMethodObject(emulator, &quot;sign(Ljava/lang/String;[B)Ljava/lang/String;&quot;, arg1, arg2).getValue().toString();
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;

        return ret;
    &#125;

    @Override
    public DvmObject&lt;?&gt; callStaticObjectMethodV(BaseVM vm, DvmClass dvmClass, String signature, VaList vaList) &#123;
        switch (signature) &#123;
            case &quot;com/izuiyou/common/base/BaseApplication-&gt;getAppContext()Landroid/content/Context;&quot;: &#123;
                DvmObject&lt;?&gt; context = vm.resolveClass(&quot;cn/xiaochuankeji/tieba/AppController&quot;).newObject(null);
                return context;
            &#125;
        &#125;
        return super.callStaticObjectMethodV(vm, dvmClass, signature, vaList);
    &#125;


    public static void main(String[] args) &#123;
        TEST2 test = new TEST2();
        String result = test.callSign();
        System.out.println(&quot;call s result: &quot; + result);
    &#125;
&#125;
</code></pre>
<p>ç»§ç»­è¿è¡Œï¼Œé‡åˆ°äº†æ–°çš„JNI è¡¥ç¯å¢ƒã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705164702773.png" alt="image-20250705164702773"></p>
<p>è·å–åŒ…ç®¡ç†å™¨å¦‚ä½•è¿”å›ï¼ŸAbstractJNI é‡Œæœ‰å¯ä¾›å‚è€ƒçš„ä»£ç ã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705165040195.png" alt="image-20250705165040195"></p>
<p>é‡å†™ï¼Œå‚è€ƒAbstractJNI å»è¡¥ PackageManagerã€‚</p>
<pre><code class="language-java">@Override
public DvmObject&lt;?&gt; callObjectMethodV(BaseVM vm, DvmObject&lt;?&gt; dvmObject, String signature, VaList vaList) &#123;
    switch (signature)&#123;
        case &quot;cn/xiaochuankeji/tieba/AppController-&gt;getPackageManager()Landroid/content/pm/PackageManager;&quot;:&#123;
            return vm.resolveClass(&quot;android/content/pm/PackageManager&quot;).newObject(null);
        &#125;
    &#125;
    return super.callObjectMethodV(vm, dvmObject, signature, vaList);
</code></pre>
<p>ç»§ç»­è¿è¡Œ<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705165424673.png" alt="image-20250705165424673"></p>
<p>è·å–åŒ…åï¼ŒAbstractJNI é‡ŒåŒæ ·æœ‰è¿™ä¸ªå¤„ç†é€»è¾‘ã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705165455598.png" alt="image-20250705165455598"></p>
<p>ç…§æŠ„ä¸€ä¸‹</p>
<pre><code class="language-Java">@Override
public DvmObject&lt;?&gt; callObjectMethodV(BaseVM vm, DvmObject&lt;?&gt; dvmObject, String signature, VaList vaList) &#123;
    switch (signature)&#123;
        case &quot;cn/xiaochuankeji/tieba/AppController-&gt;getPackageManager()Landroid/content/pm/PackageManager;&quot;:&#123;
            return vm.resolveClass(&quot;android/content/pm/PackageManager&quot;).newObject(null);
        &#125;
        case &quot;cn/xiaochuankeji/tieba/AppController-&gt;getPackageName()Ljava/lang/String;&quot;:&#123;
            String packageName = vm.getPackageName();
            if (packageName != null) &#123;
                return new StringObject(vm, packageName);
            &#125;
            break;
        &#125;
    &#125;
    return super.callObjectMethodV(vm, dvmObject, signature, vaList);
&#125;
</code></pre>
<p>ç»§ç»­è¿è¡Œ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705165811357.png" alt="image-20250705165811357"></p>
<p>åœ¨ AbstractJNI é‡Œæ‰¾ getClass çš„å¤„ç†é€»è¾‘ã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705165854570.png" alt="image-20250705165854570"></p>
<p>ç…§æŠ„</p>
<pre><code class="language-Java">case &quot;cn/xiaochuankeji/tieba/AppController-&gt;getClass()Ljava/lang/Class;&quot;:&#123;
    return dvmObject.getObjectType();
&#125;
</code></pre>
<p>ç»§ç»­è¿è¡Œ<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705170044840.png" alt="image-20250705170044840"></p>
<p>è¿™åœ¨ AbstractJNI é‡Œå¯æ²¡æœ‰ï¼Œåƒä¸‹é¢è¿™æ ·å¤„ç†ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆåšåŒæ ·æ”¾åˆ°åé¢è®¨è®ºã€‚</p>
<pre><code class="language-Java">case &quot;java/lang/Class-&gt;getSimpleName()Ljava/lang/String;&quot;:&#123;
    String className = ((DvmClass) dvmObject).getClassName();
    String[] name = className.split(&quot;/&quot;);
    return new StringObject(vm, name[name.length - 1]);
&#125;
</code></pre>
<p>ç»§ç»­è¿è¡Œ<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705170221889.png" alt="image-20250705170221889"></p>
<p>Context çš„ getFilesDir è¿”å›ä»€ä¹ˆï¼Ÿåƒä¸‹é¢è¿™æ ·å¤„ç†ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆåšæ”¾åˆ°åé¢è®¨è®ºã€‚</p>
<pre><code class="language-Java">case &quot;cn/xiaochuankeji/tieba/AppController-&gt;getFilesDir()Ljava/io/File;&quot;:&#123;
    return vm.resolveClass(&quot;java/io/File&quot;).newObject(null);
&#125;
</code></pre>
<p>è¿è¡Œå‘ç°æ–°æŠ¥é”™<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705170311740.png" alt="image-20250705170311740"></p>
<p>åƒä¸‹é¢è¿™æ ·è¡¥ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆåšæ”¾åˆ°åé¢è®¨è®ºã€‚</p>
<pre><code class="language-Java">case &quot;cn/xiaochuankeji/tieba/AppController-&gt;getFilesDir()Ljava/io/File;&quot;:&#123;
    return vm.resolveClass(&quot;java/io/File&quot;).newObject(&quot;/data/data/cn.xiaochuankeji.tieba/files&quot;);
&#125;
case &quot;java/io/File-&gt;getAbsolutePath()Ljava/lang/String;&quot;:&#123;
    return new StringObject(vm, dvmObject.getValue().toString());
&#125;
</code></pre>
<p>ç»§ç»­è¿è¡Œï¼Œèµ°åˆ°äº†æ£€æµ‹ debug ç›¸å…³çš„é€»è¾‘<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705170553628.png" alt="image-20250705170553628"></p>
<p>è¿”å›false</p>
<pre><code class="language-Java">@Override
public boolean callStaticBooleanMethodV(BaseVM vm, DvmClass dvmClass, String signature, VaList vaList) &#123;
    switch (signature)&#123;
        case &quot;android/os/Debug-&gt;isDebuggerConnected()Z&quot;:&#123;
            return false;
        &#125;
    &#125;
    return super.callStaticBooleanMethodV(vm, dvmClass, signature, vaList);
&#125;
</code></pre>
<p>ç»§ç»­è¿è¡Œï¼Œè·å–è¿›ç¨‹ID<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705170703469.png" alt="image-20250705170703469"></p>
<p>è¿”å›Unidbgæ‰€ç”Ÿæˆçš„PID</p>
<pre><code class="language-Java">@Override
public int callStaticIntMethodV(BaseVM vm, DvmClass dvmClass, String signature, VaList vaList) &#123;
    switch (signature)&#123;
        case &quot;android/os/Process-&gt;myPid()I&quot;:&#123;
            return emulator.getPid();
        &#125;
    &#125;
    return super.callStaticIntMethodV(vm, dvmClass, signature, vaList);
&#125;
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬è®¨è®ºä¸€ä¸‹pidçš„é—®é¢˜ï¼Œä¸åŒçš„é¡¹ç›®åœ¨æ­¤æœ‰ä¸åŒçš„æ¨¡æ‹Ÿæ€è·¯ã€‚</p>
<p>æ¯”å¦‚qilingé‡‡ç”¨ç¡¬ç¼–ç ï¼Œè¿”å›0x512ï¼Œå³Unidbgç¯å¢ƒé‡Œï¼Œè¿›ç¨‹çš„IDæ€»æ˜¯0x512.</p>
<pre><code class="language-python">def ql_syscall_getpid(ql: Qiling):
    return 0x512
</code></pre>
<p>ExAndroidNativeEmu è¿”å›é¡¹ç›®è‡ªèº«çš„ pid</p>
<pre><code class="language-python">def get_pid(self):
    return os.getpid()
</code></pre>
<p>Unidbg åŒç†ï¼Œä½†å®ƒå¤„ç†çš„æ›´ç²¾ç»†</p>
<pre><code class="language-Java">// è·å–å½“å‰JVMè¿›ç¨‹çš„PID
String name = ManagementFactory.getRuntimeMXBean().getName();
String pid = name.split(&quot;@&quot;)[0];
// è§£æä¸ºæ•°å­—ï¼Œå–ä½ 15 ä½
this.pid = Integer.parseInt(pid) &amp; 0x7fff;
</code></pre>
<p>å®ƒå°†è·å–åˆ°çš„è¿›ç¨‹ ID å’Œ 0x7FFF åšä¸è¿ç®—ï¼ŒæŒ‰ç…§ä¸è¿ç®—çš„è§„åˆ™ï¼Œè¿™èˆå»äº†é«˜ä½ï¼Œåªä¿ç•™è¾ƒä½çš„ 15 æ¯”ç‰¹ã€‚</p>
<p>åŸå› åœ¨äºï¼ŒLinux ä»¥åŠåŸºäºå®ƒçš„ Android ç³»ç»Ÿä¸Šï¼Œé»˜è®¤ PID æœ€å¤§å°±æ˜¯ 0x8000ï¼ˆ32768ï¼‰ã€‚</p>
<pre><code>#define PID_MAX 0x8000
</code></pre>
<p>å¯ä»¥åœ¨ adb shell ä¸­éªŒè¯è¿™ä¸€ç‚¹</p>
<pre><code>blueline:/ $ cat /proc/sys/kernel/pid_max
32768
blueline:/ $
</code></pre>
<p>MacOS ä¸Šè¿›ç¨‹ ID å¯è¾¾ 100000ï¼ŒWindows ä¸Šæ›´æ˜¯ä¸åšé™åˆ¶ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œå¦‚æœ Unidbg çš„è¿è¡Œç¯å¢ƒå¹¶é Linuxï¼Œè€Œæ˜¯ MacOS æˆ– Windowsï¼Œé‚£ä¹ˆè·å–åˆ°çš„ Pid å¯èƒ½è¶…å‡º Android ç¯å¢ƒæ‰€é™åˆ¶çš„æœ€å¤§è¿›ç¨‹å·ã€‚ã€</p>
<p>å› æ­¤å‡ºäºè§„èŒƒè§’åº¦ï¼ŒUnidbg æŠ¹å»äº†å½“å‰ Pid çš„é«˜ä½ï¼Œç¡®ä¿å…¶å°äº<code>PID_MAX</code>ã€‚</p>
<p>åœ¨ Unidbg é‡Œ PID æ˜¯ç§æœ‰çš„<code>final</code>å˜é‡ï¼Œå¦‚æœä½ æƒ³ä¿®æ”¹ PIDï¼Œéœ€è¦ä¿®æ”¹ä½äº<code>unidbg-api/src/main/java/com/github/unidbg/AbstractEmulator.java</code> çš„æºç ï¼Œè¿™å…¶å®ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå›ºå®š pid çš„éœ€æ±‚å…¶å®ä¹Ÿå¾ˆå¤šï¼Œå¦‚æœ Unidbg æä¾›ä¸€ä¸ª<code>setPid</code>çš„æ–¹æ³•ä¼šå¾ˆå¥½.</p>
<p>è¿è¡Œæµ‹è¯•ï¼Œå¾—åˆ°ç»“æœï¼Œç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250705171217271.png" alt="image-20250705171217271"></p>
<pre><code class="language-shell">call s result:v2-b94195d5f3c2ad3a876f13346fa283a0
</code></pre>
<h3 id="å…­ã€å°¾å£°"><a href="#å…­ã€å°¾å£°" class="headerlink" title="å…­ã€å°¾å£°"></a>å…­ã€å°¾å£°</h3><p>è¯»è€…å¯èƒ½æœ‰å¾ˆå¤šå›°æƒ‘ï¼Œåœ¨è¡¥ç¯å¢ƒçš„å¤„ç†ä¸­ç•™äº†ä¸å°‘å‘ï¼Œè¿™åº”è¯¥ä¹Ÿè®©å¤§å®¶æ„è¯†åˆ°ï¼Œè¡¥ JNI ç¯å¢ƒæ˜¯ä¸€ä¸ªç¡¬éª¨å¤´ï¼Œéœ€è¦å­¦ä¹ ä¸€ç•ªæ‰èƒ½æå®šã€‚ä»ä¸‹ä¸€ç¯‡å¼€å§‹ï¼Œæˆ‘ä»¬æ­£å¼è®¨è®ºå¦‚ä½•è¡¥ JNI ç¯å¢ƒã€‚</p>
<h3 id="ä¸ƒã€å‚è€ƒ"><a href="#ä¸ƒã€å‚è€ƒ" class="headerlink" title="ä¸ƒã€å‚è€ƒ"></a>ä¸ƒã€å‚è€ƒ</h3><p><a target="_blank" rel="noopener" href="https://www.yuque.com/lilac-2hqvv/xdwlsg/bmf8lm68ffvhrfu0#uMicr">Unidbg çš„åŸºæœ¬ä½¿ç”¨ï¼ˆä¸‰ï¼‰</a></p>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 1621925986@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">ğŸ’°</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23lif2sndX4YqUPQwk',
            clientSecret: 'c76a4c487d51bf36e4dd1496b3f44bdbea037d50',
            repo: 'NshIdE1.github.io',
            owner: 'NshIdE1',
            admin: ['NshIdE1'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2024-2025 NshIdE
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">Ã—</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="æ‰«ç æ”¯æŒ">
            <img src="/img/weixin.jpg" class="weixin" title="æ‰«ç æ”¯æŒ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    

    
</style>







</html>
