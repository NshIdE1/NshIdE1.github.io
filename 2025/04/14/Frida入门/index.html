<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Fridaå…¥é—¨ | NshIdE&#39;s Home</title>
  <meta name="keywords" content=" Android , Frida ">
  <meta name="description" content="Fridaå…¥é—¨ | NshIdE&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="categories">
<meta property="og:url" content="https://nshide1.github.io/categories/">
<meta property="og:site_name" content="NshIdE&#39;s Home">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-03-04T12:19:41.475Z">
<meta property="article:modified_time" content="2025-03-04T12:19:41.475Z">
<meta property="article:author" content="NshIdE">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/logo.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/logo.jpg"/>
</a>
<div class="author">
    <span>NshIdE</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/NshIdE1/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://www.csdn.net/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=1621925986&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(42)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="å…¶ä»–">
            
            å…¶ä»–
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Android-RE">
            
            Android-RE
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Androidå­¦ä¹ ">
            
            Androidå­¦ä¹ 
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Angrå…¥é—¨">
            
            Angrå…¥é—¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="CTF">
            
            CTF
            <small>(16)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Fridaå…¥é—¨">
            
            Fridaå…¥é—¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Javaå­¦ä¹ ">
            
            Javaå­¦ä¹ 
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Unidbgå­¦ä¹ ">
            
            Unidbgå­¦ä¹ 
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="42">
<input type="hidden" id="yelog_site_word_count" value="231.8k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://bananashipsbbq.github.io/">bananaships</a></li>
            
            <li><a target="_blank" href="https://astralprisma.github.io/">AstralPrisma</a></li>
            
            <li><a target="_blank" href="https://monoceros406.github.io/">Monoceros406</a></li>
            
            <li><a target="_blank" href="https://github.com/Thir0th">Thir0th</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æŠ½è±¡</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ç¬¦å·æ‰§è¡Œ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å–è¯</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å®æˆ˜</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åº”æ€¥å“åº”</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Frida</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>go</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Harmony</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>il2Cpps</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>iOS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ISW</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SIMD</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unidbg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unity</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>WritesUp</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All CTF "
           href="/2026/01/04/HitCTF2025-Reverse%C2%B7VM/"
           data-tag="CTF,RE,WritesUp,vm"
           data-author="" >
            <span class="post-title" title="HitCTF2025-ReverseÂ·VM">HitCTF2025-ReverseÂ·VM</span>
            <span class="post-date" title="2026-01-04 16:19:02">2026/01/04</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/11/03/%E6%9F%90%E9%BB%91%E7%9B%92%20App%20%E7%99%BB%E5%BD%95%E5%8F%82%E6%95%B0%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"
           data-tag="Android,å®æˆ˜"
           data-author="" >
            <span class="post-title" title="æŸé»‘ç›’ App ç™»å½•å‚æ•°é€†å‘åˆ†æ">æŸé»‘ç›’ App ç™»å½•å‚æ•°é€†å‘åˆ†æ</span>
            <span class="post-date" title="2025-11-03 16:15:21">2025/11/03</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/10/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%BC%BA%E7%BD%91%C2%B7%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android,il2Cpps"
           data-author="" >
            <span class="post-title" title="ç¬¬å…«å±Šå¼ºç½‘Â·æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›">ç¬¬å…«å±Šå¼ºç½‘Â·æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›</span>
            <span class="post-date" title="2025-10-25 17:31:37">2025/10/25</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/10/22/Android%20APP%20%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android APP å¸¸è§æ¼æ´">Android APP å¸¸è§æ¼æ´</span>
            <span class="post-date" title="2025-10-22 17:06:07">2025/10/22</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/10/10/%E4%BB%8E%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20PackageInfo%20%E5%92%8C%20LoadedApk/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="ä»æºç åˆ†æ PackageInfo å’Œ LoadedApk">ä»æºç åˆ†æ PackageInfo å’Œ LoadedApk</span>
            <span class="post-date" title="2025-10-10 18:15:17">2025/10/10</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/09/09/2025%E5%B9%B4%E6%B9%BE%E5%8C%BA%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%88%9D%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025å¹´æ¹¾åŒºæ¯ç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›">2025å¹´æ¹¾åŒºæ¯ç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›</span>
            <span class="post-date" title="2025-09-09 09:34:17">2025/09/09</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/09/08/Android%20SO%20%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android SO æ–‡ä»¶åŠ è½½è¿‡ç¨‹">Android SO æ–‡ä»¶åŠ è½½è¿‡ç¨‹</span>
            <span class="post-date" title="2025-09-08 17:18:50">2025/09/08</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/25/Dex%20%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Dex æ–‡ä»¶ç»“æ„å­¦ä¹ ">Dex æ–‡ä»¶ç»“æ„å­¦ä¹ </span>
            <span class="post-date" title="2025-08-25 17:33:29">2025/08/25</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/ClassLoader%20%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="ClassLoader æœºåˆ¶">ClassLoader æœºåˆ¶</span>
            <span class="post-date" title="2025-08-19 17:42:51">2025/08/19</span>
        </a>
        
        
        <a  class="All Javaå­¦ä¹  "
           href="/2025/08/19/Java%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="Javaå­¦ä¹ ----åå°„æœºåˆ¶">Javaå­¦ä¹ ----åå°„æœºåˆ¶</span>
            <span class="post-date" title="2025-08-19 17:00:02">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/Android%20%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android åº”ç”¨å¯åŠ¨æµç¨‹">Android åº”ç”¨å¯åŠ¨æµç¨‹</span>
            <span class="post-date" title="2025-08-19 11:14:13">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/19/%E5%AE%89%E5%8D%93%E5%8A%A0%E5%9B%BA%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="å®‰å“åŠ å›ºå­¦ä¹ è®°å½•">å®‰å“åŠ å›ºå­¦ä¹ è®°å½•</span>
            <span class="post-date" title="2025-08-19 10:50:46">2025/08/19</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/14/Android%20%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94NDK%20%E5%BC%80%E5%8F%91/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android å¼€å‘--NDK å¼€å‘">Android å¼€å‘--NDK å¼€å‘</span>
            <span class="post-date" title="2025-08-14 17:56:58">2025/08/14</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/08/10/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%85%AD)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å…­)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å…­)</span>
            <span class="post-date" title="2025-08-10 10:25:02">2025/08/10</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/08/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%94)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äº”)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äº”)</span>
            <span class="post-date" title="2025-08-08 17:45:59">2025/08/08</span>
        </a>
        
        
        <a  class="All Androidå­¦ä¹  "
           href="/2025/08/05/%E6%BC%AB%E8%B0%88%E5%94%AF%E4%B8%80%E8%AE%BE%E5%A4%87ID/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="æ¼«è°ˆå”¯ä¸€è®¾å¤‡ ID">æ¼«è°ˆå”¯ä¸€è®¾å¤‡ ID</span>
            <span class="post-date" title="2025-08-05 18:00:44">2025/08/05</span>
        </a>
        
        
        <a  class="All å…¶ä»– "
           href="/2025/07/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20Linux%20%E7%B3%BB%E7%BB%9F%E4%B8%8B%20proc%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"
           data-tag="Android,Linux"
           data-author="" >
            <span class="post-title" title="æµ…è°ˆ Linux ç³»ç»Ÿä¸‹ proc æ–‡ä»¶ç³»ç»Ÿå†…å®¹">æµ…è°ˆ Linux ç³»ç»Ÿä¸‹ proc æ–‡ä»¶ç³»ç»Ÿå†…å®¹</span>
            <span class="post-date" title="2025-07-24 17:56:57">2025/07/24</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/24/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%BA%8C%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(äºŒ)">Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(äºŒ)</span>
            <span class="post-date" title="2025-07-24 17:00:12">2025/07/24</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/07/23/2025%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B-%E5%88%9D%E8%B5%9B-%E5%AE%89%E5%8D%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E5%85%A8/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025ç¬¬åå±Šæ¸¸æˆå®‰å…¨ç«èµ›-åˆèµ›-å®‰å“å®¢æˆ·ç«¯å®‰å…¨">2025ç¬¬åå±Šæ¸¸æˆå®‰å…¨ç«èµ›-åˆèµ›-å®‰å“å®¢æˆ·ç«¯å®‰å…¨</span>
            <span class="post-date" title="2025-07-23 15:32:11">2025/07/23</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/19/%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%92%8C%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—">åˆ›å»ºæ¨¡æ‹Ÿå™¨å’ŒåŠ è½½æ¨¡å—</span>
            <span class="post-date" title="2025-07-19 15:14:29">2025/07/19</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/15/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%B8%80%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(ä¸€)">Unidbg ä¸­å¤„ç†æ–‡ä»¶è®¿é—®(ä¸€)</span>
            <span class="post-date" title="2025-07-15 16:52:06">2025/07/15</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%9B%9B)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å››)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(å››)</span>
            <span class="post-date" title="2025-07-08 11:44:49">2025/07/08</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/07/01/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%89)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸‰)</span>
            <span class="post-date" title="2025-07-01 15:29:42">2025/07/01</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/06/07/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmonyCTF/"
           data-tag="CTF,RE,WritesUp,Harmony"
           data-author="" >
            <span class="post-title" title="ç¬¬ä¸€å±ŠOpenHarmonyCTF">ç¬¬ä¸€å±ŠOpenHarmonyCTF</span>
            <span class="post-date" title="2025-06-07 13:32:45">2025/06/07</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/06/04/%E8%A1%A5%E5%BA%93%E5%87%BD%E6%95%B0%EF%BC%88%E4%BA%94%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="è¡¥åº“å‡½æ•°(äº”)">è¡¥åº“å‡½æ•°(äº”)</span>
            <span class="post-date" title="2025-06-04 19:07:56">2025/06/04</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/06/02/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%8C)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äºŒ)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(äºŒ)</span>
            <span class="post-date" title="2025-06-02 15:33:15">2025/06/02</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/31/D%5E3CTF2025/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="D^3CTF2025">D^3CTF2025</span>
            <span class="post-date" title="2025-05-31 16:21:11">2025/05/31</span>
        </a>
        
        
        <a  class="All Unidbgå­¦ä¹  "
           href="/2025/05/28/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%80)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸€)">ä»å®è·µä¸­å­¦ä¹ unidbgä½¿ç”¨(ä¸€)</span>
            <span class="post-date" title="2025-05-28 16:39:23">2025/05/28</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/17/Parloo2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="Parloo RE">Parloo RE</span>
            <span class="post-date" title="2025-05-17 09:34:20">2025/05/17</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/05/07/%E8%AE%B0%E4%B8%80%E6%AC%A1APK%E5%88%86%E6%9E%90/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="è®°ä¸€æ¬¡APKåˆ†æ">è®°ä¸€æ¬¡APKåˆ†æ</span>
            <span class="post-date" title="2025-05-07 21:12:00">2025/05/07</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/26/%E4%B8%80%E9%81%93%E5%BE%88%E9%80%86%E5%A4%A9%E7%9A%84RC4/"
           data-tag="CTF,RE,WritesUp,æŠ½è±¡"
           data-author="" >
            <span class="post-title" title="æŠ½è±¡RC4">æŠ½è±¡RC4</span>
            <span class="post-date" title="2025-04-26 22:21:19">2025/04/26</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/24/%E5%BE%88%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜">å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜</span>
            <span class="post-date" title="2025-04-24 21:56:18">2025/04/24</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/23/%E4%BA%AC%E9%BA%92CTF2025%20%E7%83%AD%E8%BA%AB%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,iOS,SIMD"
           data-author="" >
            <span class="post-title" title="äº¬éº’CTF2025çƒ­èº«èµ›">äº¬éº’CTF2025çƒ­èº«èµ›</span>
            <span class="post-date" title="2025-04-23 13:33:59">2025/04/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/14/TGCTF2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TGCTF2025 RE">TGCTF2025 RE</span>
            <span class="post-date" title="2025-04-14 18:51:29">2025/04/14</span>
        </a>
        
        
        <a  class="All Angrå…¥é—¨ "
           href="/2025/04/14/Angr%E5%85%A5%E9%97%A8/"
           data-tag="ç¬¦å·æ‰§è¡Œ"
           data-author="" >
            <span class="post-title" title="Angrå…¥é—¨">Angrå…¥é—¨</span>
            <span class="post-date" title="2025-04-14 18:50:44">2025/04/14</span>
        </a>
        
        
        <a  class="All Fridaå…¥é—¨ "
           href="/2025/04/14/Frida%E5%85%A5%E9%97%A8/"
           data-tag="Android,Frida"
           data-author="" >
            <span class="post-title" title="Fridaå…¥é—¨">Fridaå…¥é—¨</span>
            <span class="post-date" title="2025-04-14 18:47:37">2025/04/14</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/12/TEXSAWCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TEXSAWCTF 2025">TEXSAWCTF 2025</span>
            <span class="post-date" title="2025-04-12 15:32:31">2025/04/12</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/23/NCTF2024/"
           data-tag="CTF,RE,WritesUp,vm,go"
           data-author="" >
            <span class="post-title" title="NCTF2024">NCTF2024</span>
            <span class="post-date" title="2025-03-23 11:58:53">2025/03/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/18/CISCN%20x%20CCB%20%E5%8D%8A%E5%86%B3%E8%B5%9B%202025%20ISW(%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94)/"
           data-tag="ISW,åº”æ€¥å“åº”,å–è¯"
           data-author="" >
            <span class="post-title" title="CISCN x CCB åŠå†³èµ› 2025 ISW(åº”æ€¥å“åº”)">CISCN x CCB åŠå†³èµ› 2025 ISW(åº”æ€¥å“åº”)</span>
            <span class="post-date" title="2025-03-18 10:24:23">2025/03/18</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/11/TPCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TPCTF 2025">TPCTF 2025</span>
            <span class="post-date" title="2025-03-11 21:41:19">2025/03/11</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/06/VishwaCTF2025/"
           data-tag="CTF,RE,WritesUp,Android,Unity"
           data-author="" >
            <span class="post-title" title="VishwaCTF2025">VishwaCTF2025</span>
            <span class="post-date" title="2025-03-06 21:52:51">2025/03/06</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/03/HGAME%20RE/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="HGAME-RE-WEEK1">HGAME-RE-WEEK1</span>
            <span class="post-date" title="2025-03-03 22:20:33">2025/03/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Fridaå…¥é—¨" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Fridaå…¥é—¨</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="Fridaå…¥é—¨">Fridaå…¥é—¨</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color3">Android</a>
            
            <a class="color1">Frida</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-07-25 16:58:23'>2025-04-14 18:47</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:12.9k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Frida%E5%85%A5%E9%97%A8"><span class="toc-text">Fridaå…¥é—¨</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80-Frida%E7%9A%84%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5"><span class="toc-text">ä¸€.Fridaçš„ç›¸å…³é“¾æ¥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C-%E5%AE%89%E5%8D%93%E8%84%B1%E5%A3%B3%E2%80%93Xposed-%E5%8F%8D%E5%B0%84%E5%A4%A7%E5%B8%88"><span class="toc-text">äºŒ.å®‰å“è„±å£³â€“Xposed&amp;åå°„å¤§å¸ˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89-Frida-%E7%94%A8%E6%B3%95%EF%BC%881%EF%BC%89-js%E8%84%9A%E6%9C%AChook%E4%B8%80%E4%B8%AA%E6%96%B9%E6%B3%95"><span class="toc-text">ä¸‰.Frida ç”¨æ³•ï¼ˆ1ï¼‰.jsè„šæœ¬hookä¸€ä¸ªæ–¹æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%9B-Frida-%E7%94%A8%E6%B3%95%EF%BC%882%EF%BC%89-js%E8%84%9A%E6%9C%AChook%E4%B8%80%E4%B8%AA%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-text">å››.Frida ç”¨æ³•ï¼ˆ2ï¼‰ .jsè„šæœ¬hookä¸€ä¸ªé™æ€æ–¹æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%94-Frida-%E7%94%A8%E6%B3%95%EF%BC%883%EF%BC%89-js%E8%84%9A%E6%9C%AC%E6%9B%B4%E6%94%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%80%BC"><span class="toc-text">äº”.Frida ç”¨æ³•ï¼ˆ3ï¼‰.jsè„šæœ¬æ›´æ”¹å˜é‡çš„å€¼</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%AD-Frida-%E7%94%A8%E6%B3%95%EF%BC%884%EF%BC%89-js%E8%84%9A%E6%9C%AC%E5%88%9B%E5%BB%BA%E7%B1%BB%E5%AE%9E%E4%BE%8B"><span class="toc-text">å…­.Â Frida ç”¨æ³•ï¼ˆ4ï¼‰.jsè„šæœ¬åˆ›å»ºç±»å®ä¾‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%83-Frida-%E7%94%A8%E6%B3%95%EF%BC%885%EF%BC%89-js%E8%84%9A%E6%9C%AC%E5%9C%A8%E7%8E%B0%E6%9C%89%E5%AE%9E%E4%BE%8B%E4%B8%8A%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">ä¸ƒ.Frida ç”¨æ³•ï¼ˆ5ï¼‰ .jsè„šæœ¬åœ¨ç°æœ‰å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%AB-Frida%E7%94%A8%E6%B3%95%EF%BC%886%EF%BC%89-js%E8%84%9A%E6%9C%AC-%E4%BD%BF%E7%94%A8%E5%AF%B9%E8%B1%A1%E5%8F%82%E6%95%B0%E8%B0%83%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">å…«.Fridaç”¨æ³•ï¼ˆ6ï¼‰ .jsè„šæœ¬ ä½¿ç”¨å¯¹è±¡å‚æ•°è°ƒç”¨çš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B9%9D-Frida%E7%94%A8%E6%B3%95%EF%BC%887%EF%BC%89-js%E8%84%9A%E6%9C%AC-Hook%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-text">ä¹.Fridaç”¨æ³•ï¼ˆ7ï¼‰ .jsè„šæœ¬ Hookæ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%81-Frida%E7%94%A8%E6%B3%95%EF%BC%888%EF%BC%89-js%E8%84%9A%E6%9C%AC-Hook-native%E5%87%BD%E6%95%B0"><span class="toc-text">å.Fridaç”¨æ³•ï¼ˆ8ï¼‰ .jsè„šæœ¬ Hook nativeå‡½æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%81%E4%B8%80-Frida%E7%94%A8%E6%B3%95%EF%BC%889%EF%BC%89-js%E8%84%9A%E6%9C%AC-%E6%9B%B4%E6%94%B9native%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">åä¸€.Fridaç”¨æ³•ï¼ˆ9ï¼‰.jsè„šæœ¬ æ›´æ”¹nativeå‡½æ•°çš„è¿”å›å€¼</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C-Frida%E7%94%A8%E6%B3%95%EF%BC%8810%EF%BC%89-js%E8%84%9A%E6%9C%AC%E8%B0%83%E7%94%A8native%E5%87%BD%E6%95%B0"><span class="toc-text">åäºŒ.Fridaç”¨æ³•ï¼ˆ10ï¼‰ .jsè„šæœ¬è°ƒç”¨nativeå‡½æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%81%E4%B8%89-Frida%E7%94%A8%E6%B3%95%EF%BC%8811%EF%BC%89-js%E8%84%9A%E6%9C%AC-%E4%BD%BF%E7%94%A8ARM64Writer%E4%BF%AE%E6%94%B9%E6%8C%87%E4%BB%A4"><span class="toc-text">åä¸‰.Fridaç”¨æ³•ï¼ˆ11ï¼‰ .jsè„šæœ¬ ä½¿ç”¨ARM64Writerä¿®æ”¹æŒ‡ä»¤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B-Android-JAVA%E5%B1%82root%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87"><span class="toc-text">åå››.Android JAVAå±‚rootæ£€æµ‹ç»•è¿‡</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Fridaå…¥é—¨"><a href="#Fridaå…¥é—¨" class="headerlink" title="Fridaå…¥é—¨"></a>Fridaå…¥é—¨</h1><h5 id="ä¸€-Fridaçš„ç›¸å…³é“¾æ¥"><a href="#ä¸€-Fridaçš„ç›¸å…³é“¾æ¥" class="headerlink" title="ä¸€.Fridaçš„ç›¸å…³é“¾æ¥"></a>ä¸€.Fridaçš„ç›¸å…³é“¾æ¥</h5><p>1.Frida serverä¸‹è½½ï¼š<a target="_blank" rel="noopener" href="https://github.com/frida/frida/releases?page=2">Releases Â· frida&#x2F;frida (github.com)</a></p>
<p>2.Fridaä¾‹é¢˜ï¼š<a target="_blank" rel="noopener" href="https://github.com/DERE-ad2001/Frida-Labs">DERE-ad2001&#x2F;Frida-Labs: The repo contains a series of challenges for learning Frida for Android Exploitation. (github.com)</a></p>
<p><strong>ç›¸å…³æŒ‡ä»¤ï¼š</strong></p>
<p>1.adb version ï¼šæ˜¾ç¤º adb ç‰ˆæœ¬</p>
<p>2.adb helpï¼šå¸®åŠ©ä¿¡æ¯ï¼ŒæŸ¥çœ‹adbæ‰€æ”¯æŒçš„æ‰€æœ‰å‘½ä»¤</p>
<p>3.adb devicesï¼šæŸ¥çœ‹å½“å‰è¿æ¥çš„è®¾å¤‡ï¼Œå·²è¿æ¥çš„è®¾å¤‡ä¼šæ˜¾ç¤ºå‡ºæ¥</p>
<p>4.adb get-serialnoï¼šä¹Ÿå¯ä»¥æŸ¥çœ‹è®¾å¤‡å·</p>
<p>5.adb rootï¼šè·å–Androidç®¡ç†å‘˜ï¼ˆrootç”¨æˆ·ï¼‰çš„æƒé™</p>
<p>6.adb shellï¼šç™»å½•è®¾å¤‡ shellï¼Œè¯¥å‘½ä»¤å°†ç™»å½•è®¾å¤‡çš„shellï¼ˆå†…æ ¸ï¼‰ï¼Œç™»å½•shellåï¼Œå¯ä»¥ä½¿ç”¨ cdï¼Œlsï¼Œrm ç­‰Linuxå‘½ä»¤</p>
<p>7.adb -dï¼šå¦‚æœåŒæ—¶è¿äº†usbï¼Œåˆå¼€äº†æ¨¡æ‹Ÿå™¨ï¼Œè¿æ¥å½“å‰å”¯ä¸€é€šè¿‡usbè¿æ¥çš„å®‰å“è®¾å¤‡</p>
<p>8.adb -e shellï¼šæŒ‡å®šå½“å‰è¿æ¥æ­¤ç”µè„‘çš„å”¯ä¸€çš„ä¸€ä¸ªæ¨¡æ‹Ÿå™¨</p>
<p>9.adb -s &lt;è®¾å¤‡å·&gt; shellï¼šå½“ç”µè„‘æ’å¤šå°æ‰‹æœºæˆ–æ¨¡æ‹Ÿå™¨æ—¶ï¼ŒæŒ‡å®šä¸€ä¸ªè®¾å¤‡å·è¿›è¡Œè¿æ¥</p>
<p>10.exitï¼šé€€å‡º</p>
<p>11.adb kill-serverï¼šæ€æ­»å½“å‰adbæœåŠ¡ï¼Œå¦‚æœè¿ä¸ä¸Šè®¾å¤‡æ—¶ï¼Œæ€æ‰é‡å¯ã€‚ï¼ˆæ²¡äº‹ä¸è¦ç”¨å®ƒï¼‰</p>
<p>12.adb start-serverï¼šæ€æ‰åé‡å¯</p>
<p>13.adb shell pm list packagesï¼šåˆ—å‡ºå½“å‰è®¾å¤‡&#x2F;æ‰‹æœºï¼Œæ‰€æœ‰çš„åŒ…å</p>
<p>14.adb shell pm list packages -fï¼šæ˜¾ç¤ºåŒ…å’ŒåŒ…ç›¸å…³è”çš„æ–‡ä»¶(å®‰è£…è·¯å¾„)</p>
<p>15.adb shell pm list packages -dï¼šæ˜¾ç¤ºç¦ç”¨çš„åŒ…å<br>16.adb shell pm list packages -eï¼šæ˜¾ç¤ºå½“å‰å¯ç”¨çš„åŒ…å<br>17.adb shell pm list packages -sï¼šæ˜¾ç¤ºç³»ç»Ÿåº”ç”¨åŒ…å<br>18.adb shell pm list packages -3ï¼šæ˜¾ç¤ºå·²å®‰è£…ç¬¬ä¸‰æ–¹çš„åŒ…å<br>19.adb shell pm list packages xxxxï¼šåŠ éœ€è¦è¿‡æ»¤çš„åŒ…åï¼Œå¦‚ï¼šxxx &#x3D; taobao<br>20.adb install &lt;æ–‡ä»¶è·¯å¾„\apk&gt;ï¼šå°†æœ¬åœ°çš„apkè½¯ä»¶å®‰è£…åˆ°è®¾å¤‡(æ‰‹æœº)ä¸Šã€‚å¦‚æ‰‹æœºå¤–éƒ¨å®‰è£…éœ€è¦å¯†ç ï¼Œ   Â Â Â Â  è®°å¾—æ‰‹æœºè¾“å…¥å¯†ç ã€‚   </p>
<p>21.adb install -r &lt;æ–‡ä»¶è·¯å¾„\apk&gt;ï¼šè¦†ç›–å®‰è£…</p>
<p>22.adb install -d &lt;æ–‡ä»¶è·¯å¾„\apk&gt;ï¼šå…è®¸é™çº§è¦†ç›–å®‰è£…<br>23.adb install -g &lt;æ–‡ä»¶è·¯å¾„\apk&gt;ï¼šæˆæƒ&#x2F;è·å–æƒé™ï¼Œå®‰è£…è½¯ä»¶æ—¶æŠŠæ‰€æœ‰æƒé™éƒ½æ‰“å¼€<br>24.adb uninstall &lt;åŒ…å&gt;ï¼šå¸è½½è¯¥è½¯ä»¶&#x2F;appã€‚<br>      æ³¨æ„ï¼šå®‰è£…æ—¶å®‰è£…çš„æ˜¯apkï¼Œå¸è½½æ—¶æ˜¯åŒ…åï¼Œå¯ä»¥é€šè¿‡ adb shell pm list packages æŸ¥çœ‹éœ€è¦å¸è½½çš„åŒ…åã€‚<br>25.adb shell pm uninstall -k &lt;åŒ…å&gt;ï¼šè™½ç„¶æŠŠæ­¤åº”ç”¨å¸è½½ï¼Œä½†ä»ä¿å­˜æ­¤åº”ç”¨çš„æ•°æ®å’Œç¼“å­˜<br>26.adb shell am force-stop &lt;åŒ…å&gt;ï¼šå¼ºåˆ¶é€€å‡ºè¯¥åº”ç”¨&#x2F;app</p>
<p>27.adb push &lt;æœ¬åœ°è·¯å¾„\æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹&gt; &lt;æ‰‹æœºç«¯è·¯å¾„&gt;ï¼šæŠŠæœ¬åœ°(pcæœº)çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹å¤åˆ¶åˆ°è®¾å¤‡(æ‰‹ æœº)</p>
<p>æ³¨æ„ç‚¹1ï¼špcæœºè·¯å¾„ä¸Androidæœºè·¯å¾„ï¼Œåˆ†éš”ç¬¦æ˜¯ä¸åŒçš„ã€‚</p>
<p>æ³¨æ„ç‚¹2ï¼šå¤åˆ¶å¤±è´¥ï¼Œå¤§æ¦‚ç‡æ˜¯æ— æƒé™ã€‚å¯å…ˆä½¿ç”¨ä¸Šé¢ä»‹ç»è¿‡çš„ä¸¤ä¸ªå‘½ä»¤ï¼šadb rootï¼›adb remountã€‚åœ¨ä½¿ç”¨ adb push å‘½ä»¤</p>
<p>**adb pull &lt;æ‰‹æœºç«¯è·¯å¾„&#x2F;æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹&gt; &lt;pcæœºè·¯å¾„&gt;ï¼šæŠŠè®¾å¤‡(æ‰‹æœº)çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æœ¬åœ°ã€‚**æ³¨æ„ç‚¹åŒä¸Š</p>
<p>28.æ›´å¤šï¼š</p>
<p>adb shell logcat -cï¼šæ¸…ç†ç°æœ‰æ—¥å¿—<br>adb shell logcat -v time ï¼šè¾“å‡ºæ—¥å¿—ï¼Œä¿¡æ¯è¾“å‡ºåœ¨æ§åˆ¶å°<br>adb shell logcat -v time &gt; &lt;å­˜æ”¾è·¯å¾„\log.txt&gt;ï¼šè¾“å‡ºæ—¥å¿—å¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶<br>Ctrl+Cï¼šç»ˆæ­¢æ—¥å¿—æŠ“å–<br>adb shell logcat -v time *:E &gt; &lt;å­˜æ”¾è·¯å¾„\log.txt&gt;ï¼šæ‰“å°çº§åˆ«ä¸ºErrorçš„ä¿¡æ¯<br>æ—¥å¿—çš„ç­‰çº§ï¼š<br>-vï¼šVerbseï¼ˆæ˜ç»†ï¼‰<br>-dï¼šDebugï¼ˆè°ƒè¯•ï¼‰<br>-iï¼šInfoï¼ˆä¿¡æ¯ï¼‰<br>-wï¼šWarnï¼ˆè­¦å‘Šï¼‰<br>-eï¼šErrorï¼ˆé”™è¯¯ï¼‰<br>-fï¼šFatalï¼ˆä¸¥é‡é”™è¯¯ï¼‰<br>æŠ“å–æ—¥å¿—çš„æ­¥éª¤å…ˆè¾“å…¥å‘½ä»¤å¯åŠ¨æ—¥å¿—ï¼Œç„¶åæ“ä½œ Appï¼Œå¤ç° bugï¼Œå† ctrl+c åœæ­¢æ—¥å¿—ï¼Œåˆ†ææœ¬åœ°ä¿å­˜çš„æ–‡ä»¶ã€‚<br>ï¼šæ—¥å¿—æ˜¯è®°å½•æ‰‹æœºç³»ç»Ÿåœ¨è¿è¡Œappæ—¶æœ‰ä»€ä¹ˆå¼‚å¸¸çš„äº‹ä»¶<br>EXCEPTION<br>ä¹Ÿå¯ä»¥æŠŠæ›´è¯¦ç»†å¾—Anræ—¥å¿—æ‹‰å–å‡ºæ¥ï¼šadb shell pull &#x2F;data&#x2F;anr&#x2F;traces.txt &lt;å­˜æ”¾è·¯å¾„&gt;</p>
<p><strong>adb shell getprop ro.product.modelï¼šè·å–è®¾å¤‡å‹å·</strong></p>
<p><strong>adb shell getprop ro.build.version.releaseï¼šè·å–Androidç³»ç»Ÿç‰ˆæœ¬</strong></p>
<p><strong>adb get-serialnoï¼šè·å–è®¾å¤‡çš„åºåˆ—å·ï¼ˆè®¾å¤‡å·ï¼‰</strong></p>
<p><strong>adb shell wm sizeï¼šè·å–è®¾å¤‡å±å¹•åˆ†è¾¨ç‡</strong></p>
<p><strong>adb shell screencap -p &#x2F;sdcard&#x2F;mms.pngï¼šå±å¹•æˆªå›¾<br>adb shell screencap -p &#x2F;sdcard&#x2F;screenshot.pngï¼šå±å¹•æˆªå›¾</strong></p>
<p><strong>adb pull &#x2F;sdcard&#x2F;mms.png &lt;å­˜æ”¾çš„è·¯å¾„&gt;ï¼šå°†æˆªå›¾å¯¼å‡ºåˆ°æœ¬åœ°<br>adb pull &#x2F;sdcard&#x2F;screenshot.png &lt;å­˜æ”¾çš„è·¯å¾„&gt;ï¼šå°†æˆªå›¾å¯¼å‡ºåˆ°æœ¬åœ°</strong></p>
<p><strong>adb shell dumpsys activity |find â€œmResumedActivityâ€ï¼šæŸ¥çœ‹å‰å°åº”ç”¨åŒ…åï¼Œå¿…é¡»å…ˆå¯åŠ¨appï¼Œé€‚ç”¨äºAndroid 8.0ä»¥ä¸Š</strong></p>
<p><strong>adb shell cat &#x2F;proc&#x2F;meminfoï¼šè·å–æ‰‹æœºå†…å­˜ä¿¡æ¯</strong></p>
<p><strong>adb shell dfï¼šè·å–æ‰‹æœºå­˜å‚¨ä¿¡æ¯</strong></p>
<p><strong>adb shell screenrecord &lt;å­˜æ”¾è·¯å¾„&#x2F;xxx.mp4&gt;ï¼šå½•å±ï¼Œå‘½åä»¥.mp4ç»“å°¾<br>adb shell screenrecord â€“time-limit 10 &lt;å­˜æ”¾è·¯å¾„&#x2F;xxx.mp4&gt;ï¼šå½•å±æ—¶é—´ä¸º10ç§’</strong></p>
<hr>
<h5 id="äºŒ-å®‰å“è„±å£³â€“Xposed-åå°„å¤§å¸ˆ"><a href="#äºŒ-å®‰å“è„±å£³â€“Xposed-åå°„å¤§å¸ˆ" class="headerlink" title="äºŒ.å®‰å“è„±å£³â€“Xposed&amp;åå°„å¤§å¸ˆ"></a>äºŒ.å®‰å“è„±å£³â€“Xposed&amp;åå°„å¤§å¸ˆ</h5><p>ä¾‹é¢˜ï¼š[XYCTF]Trust me</p>
<p><strong>1.åˆ†è¾¨æ˜¯å¦åŠ å£³</strong></p>
<p>ç”¨jadxæ‰“å¼€ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/f2f181ff-9b1d-4381-a3a2-51da7e72f5cd.png" alt="f2f181ff-9b1d-4381-a3a2-51da7e72f5cd"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/08d77483-4d7f-4a79-a46e-1997406c9bfe.png" alt="08d77483-4d7f-4a79-a46e-1997406c9bfe"></p>
<p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªåŒ…åä¸æ˜¯åŒä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´çœŸæ­£çš„ç¨‹åºå…¥å£å’Œjadxåç¼–è¯‘å‡ºæ¥çš„ä¸ä¸€æ ·ï¼Œè¯´æ˜å¯èƒ½åŠ å£³äº†ï¼ŒåŒæ—¶è¿˜æœ‰ä¸å°‘å®‰å“ç¬¬ä¸€ä»£å£³çš„ç‰¹å¾ï¼Œ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/498ee0a5-3841-49b5-a312-8a6f78c4f076.png" alt="498ee0a5-3841-49b5-a312-8a6f78c4f076"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/a3010d65-ac47-4c92-87b6-064828defcdd.png" alt="a3010d65-ac47-4c92-87b6-064828defcdd"></p>
<p>é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨Xposed&amp;åå°„å¤§å¸ˆæ¥è„±å£³ï¼Œå…·ä½“å®‰è£…è¿™é‡Œä¸åšè¿‡å¤šè¯´æ˜ï¼Œç½‘ä¸Šæœ‰ã€‚æˆ‘è¿™é‡Œç”¨çš„<strong>å¤œç¥æ¨¡æ‹Ÿå™¨</strong>ï¼Œ<strong>Xposed</strong>ï¼Œ<strong>åå°„å¤§å¸ˆ</strong>ã€‚</p>
<p>åœ¨æ¨¡æ‹Ÿå™¨ä¸Šæ‰“å¼€åå°„å¤§å¸ˆï¼Œç‚¹å‡»æˆ‘ä»¬éœ€è¦è„±å£³çš„appï¼Œç„¶åç‚¹å‡»é€‰æ‹©è¿™ä¸ªè½¯ä»¶</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/01eaa759-4c60-4920-ad43-1e90d3529783.png" alt="01eaa759-4c60-4920-ad43-1e90d3529783"></p>
<p>ç„¶åç‚¹å‡»ï¼Œæ‰“å¼€</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/39db2c26-8297-44b2-ba57-93c9b812cffc.png" alt="39db2c26-8297-44b2-ba57-93c9b812cffc"></p>
<p>å¯ä»¥çœ‹åˆ°è½¯ä»¶é¡µé¢ä¸­å¿ƒæœ‰ä¸ªçº¢è‰²å…­èŠ’æ˜Ÿ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/44a5cd61-c8ac-45e7-b856-b2f1b4feaecc.png" alt="44a5cd61-c8ac-45e7-b856-b2f1b4feaecc"></p>
<p>ç‚¹å‡»å…­èŠ’æ˜Ÿï¼Œå¯ä»¥çœ‹åˆ°</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/a45c7382-94f6-4784-a3f7-f8651b42e3d7.png" alt="a45c7382-94f6-4784-a3f7-f8651b42e3d7"></p>
<p>å†ç‚¹å‡»å½“å‰ACTIVITY</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/205988b5-9415-4caa-9415-5175e8d3e1f4.png" alt="205988b5-9415-4caa-9415-5175e8d3e1f4"></p>
<p>é•¿æŒ‰å†™å‡ºDEXï¼Œ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/bbaf31a4-2198-42ec-b173-0b2a96e86b7a.png" alt="bbaf31a4-2198-42ec-b173-0b2a96e86b7a"></p>
<p>ç‚¹å‡»ç¡®å®šï¼Œ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/aca4393d-5e0b-4b33-9f8c-8da436036d8d.png" alt="aca4393d-5e0b-4b33-9f8c-8da436036d8d"></p>
<p>ç„¶åç‚¹å‡»å¤åˆ¶ï¼Œæ–¹ä¾¿åç»­pull</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/8d8a410d-8a05-4314-ad89-cb4492500104.png" alt="8d8a410d-8a05-4314-ad89-cb4492500104"></p>
<p>è¿™é‡Œpullå‡ºæ¥çš„æ–‡ä»¶å°±æ˜¯åœ¨æˆ‘ä»¬cmdçš„è·¯å¾„ï¼Œæ–‡ä»¶åå°±å«dump</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/379bc70f-d5e5-4841-9100-5c2b865bfc85.png" alt="379bc70f-d5e5-4841-9100-5c2b865bfc85"></p>
<p>é‡Œé¢çš„class.dexå°±æ˜¯dumpä¸‹æ¥çš„æ–‡ä»¶ï¼Œç”¨jadxå°±å¯ä»¥ç»§ç»­åˆ†æäº†ã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/0d64aed0-449e-436a-a3c2-7426b63cc7a9.png" alt="0d64aed0-449e-436a-a3c2-7426b63cc7a9"></p>
<p>è¿™å°±æ˜¯çœŸæ­£æ­£ç¡®çš„appå…¥å£ï¼Œå‡½æ•°æ•´ä½“é€»è¾‘å°±æ˜¯å¯¹æ•°æ®åº“çš„åŠ å¯†ï¼Œå¯ä»¥ç”¨splæ³¨å…¥çš„ä¸‡èƒ½é’¥åŒ™ï¼Œç›´æ¥ç§’äº†ï¼Œæˆ–è€…å°±æ˜¯æ­£åœ¨é€†å‘åˆ†æï¼Œå¯ä»¥æ‰¾åˆ°æ•°æ®æ–‡ä»¶ï¼Œè¿›è¡Œå¼‚æˆ–ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/3a0e97a5-4d3b-4219-a08d-017b117c9e87.png" alt="3a0e97a5-4d3b-4219-a08d-017b117c9e87"></p>
<p>å°±æ˜¯å¼‚æˆ–0xFFï¼Œè¿™é‡Œè¿™ä¸ªæ•°æ®åº“ä¸èƒ½ç”¨jadxæ‰“å¼€ï¼Œä¼šå¡æ­»ï¼Œå¯ä»¥æ”¹æ–‡ä»¶åç¼€åï¼Œç„¶åæ‰¾åˆ°æ–‡ä»¶ï¼Œç”¨010editoræ‰“å¼€ï¼Œè¿›è¡Œå¼‚æˆ–ï¼Œå°±å¯ä»¥æ‰¾åˆ°flagã€‚</p>
<hr>
<h5 id="ä¸‰-Frida-ç”¨æ³•ï¼ˆ1ï¼‰-jsè„šæœ¬hookä¸€ä¸ªæ–¹æ³•"><a href="#ä¸‰-Frida-ç”¨æ³•ï¼ˆ1ï¼‰-jsè„šæœ¬hookä¸€ä¸ªæ–¹æ³•" class="headerlink" title="ä¸‰.Frida ç”¨æ³•ï¼ˆ1ï¼‰.jsè„šæœ¬hookä¸€ä¸ªæ–¹æ³•"></a>ä¸‰.Frida ç”¨æ³•ï¼ˆ1ï¼‰.jsè„šæœ¬hookä¸€ä¸ªæ–¹æ³•</h5><p>1.å·¥å…·ï¼š1.jadxâ€”-ç”¨äºè¿›è¡Œé™æ€åˆ†æï¼Œä¹Ÿå¯ä»¥è¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼ˆJEBä¼¼ä¹æ›´å¥½ï¼‰ã€‚ </p>
<p>é›·ç¥æ¨¡æ‹Ÿå™¨ 9ï¼ˆAndroid 9ï¼‰â€”-åŸæœ¬è‡ªå¸¦çš„adb.exeå¥½åƒæœ‰é—®é¢˜ï¼Œå»ºè®®å¦è¡Œè‡ªæ‰¾ã€‚ï¼ˆéœ€è¦rootï¼‰</p>
<p>Frida   Frida server</p>
<p>ä¾‹é¢˜ï¼šFrida 0x1</p>
<p>2.æ‹¿åˆ°é™„ä»¶ï¼Œä¸€ä¸ª.apkæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨MTç®¡ç†å™¨çœ‹çœ‹APPå…¥å£<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1721640027318.png" title="" alt="1721640027318" data-align="left"></p>
<p>æ‰¾åˆ°äº†ä¹‹åï¼Œå°±å¯ä»¥ç”¨jadxæ‰“å¼€ï¼Œå…ˆé™æ€åˆ†æçœ‹çœ‹é€»è¾‘</p>
<pre><code class="language-java">package com.ad2001.frida0x1;

import android.os.Bundle;
import android.text.TextUtils;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;
import androidx.appcompat.app.AppCompatActivity;
import java.util.Random;

/* loaded from: classes.dex */
public class MainActivity extends AppCompatActivity &#123;
    TextView t1;

    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public void onCreate(Bundle bundle) &#123;
        super.onCreate(bundle);
        setContentView(R.layout.activity_main);
        final EditText editText = (EditText) findViewById(R.id.editTextTextPassword);
        this.t1 = (TextView) findViewById(R.id.textview1);
        final int i = get_random();
        ((Button) findViewById(R.id.button)).setOnClickListener(new View.OnClickListener() &#123; // from class: com.ad2001.frida0x1.MainActivity.1
            @Override // android.view.View.OnClickListener
            public void onClick(View view) &#123;
                String obj = editText.getText().toString();
                if (TextUtils.isDigitsOnly(obj)) &#123;
                    MainActivity.this.check(i, Integer.parseInt(obj));
                &#125; else &#123;
                    Toast.makeText(MainActivity.this.getApplicationContext(), &quot;Enter a valid number !!&quot;, 1).show();
                &#125;
            &#125;
        &#125;);
    &#125;

    int get_random() &#123;
        return new Random().nextInt(100);
    &#125;

    void check(int i, int i2) &#123;
        if ((i * 2) + 4 == i2) &#123;
            Toast.makeText(getApplicationContext(), &quot;Yey you guessed it right&quot;, 1).show();
            StringBuilder sb = new StringBuilder();
            for (int i3 = 0; i3 &lt; 20; i3++) &#123;
                char charAt = &quot;AMDYV&#123;WVWT_CJJF_0s1&#125;&quot;.charAt(i3);
                if (charAt &lt; &#39;a&#39; || charAt &gt; &#39;z&#39;) &#123;
                    if (charAt &gt;= &#39;A&#39;) &#123;
                        if (charAt &lt;= &#39;Z&#39;) &#123;
                            charAt = (char) (charAt - 21);
                            if (charAt &gt;= &#39;A&#39;) &#123;
                            &#125;
                            charAt = (char) (charAt + 26);
                        &#125;
                    &#125;
                    sb.append(charAt);
                &#125; else &#123;
                    charAt = (char) (charAt - 21);
                    if (charAt &gt;= &#39;a&#39;) &#123;
                        sb.append(charAt);
                    &#125;
                    charAt = (char) (charAt + 26);
                    sb.append(charAt);
                &#125;
            &#125;
            this.t1.setText(sb.toString());
            return;
        &#125;
        Toast.makeText(getApplicationContext(), &quot;Try again&quot;, 1).show();
    &#125;
&#125;
</code></pre>
<p>â€‹        å¯ä»¥çœ‹åˆ°ï¼ŒAPPä¸­ä½äº<strong>com.ad2001.frida0x1</strong>åŒ…<strong>MainActivity</strong>ç±»çš„onCreateæ–¹æ³•åœ¨ç¨‹åºåˆå§‹åŒ–æ—¶ä¼šè°ƒç”¨get_random()<strong>æ–¹æ³•ç”Ÿæˆä¸€ä¸ªä»‹äº0åˆ°100ä¹‹é—´çš„éšæœºæ•°å¹¶èµ‹å€¼ç»™å˜é‡iã€‚åŒæ—¶ï¼Œç›‘å¬</strong>button<strong>çš„ç‚¹å‡»ï¼Œå½“æŒ‰ä¸‹æŒ‰é’®åï¼Œç¨‹åºé¦–å…ˆåˆ¤æ–­è¾“å…¥çš„å†…å®¹æ˜¯ä¸æ˜¯æ•°å­—ï¼Œå¦‚æœæ˜¯æ•°å­—å°±å°†å…¶ä»stringè½¬åŒ–ä¸ºintï¼Œå¹¶å°†è¯¥æ•´æ•°ä¸ç”Ÿæˆçš„éšæœºæ•°ä¸€èµ·ä¼ é€’ç»™</strong>check<strong>æ–¹æ³•ã€‚æ¥ä¸‹æ¥ï¼Œç»§ç»­åˆ†æ</strong>check**æ–¹æ³•å®ç°äº†å“ªäº›åŠŸèƒ½ã€‚ </p>
<p>â€‹         <strong>check</strong>æ–¹æ³•è¢«ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯æˆ‘ä»¬åœ¨APPé¡µé¢è¾“å…¥åæäº¤çš„çš„æ•°å­—i2ï¼Œä¸€ä¸ªæ˜¯ç¨‹åºå¯åŠ¨æ—¶è°ƒç”¨get_randomæ–¹æ³•ç”Ÿæˆçš„<strong>éšæœºæ•°</strong>iã€‚è¯¥æ–¹æ³•ä¼šæ£€æŸ¥è¡¨è¾¾å¼**(i * 2) + 4 &#x3D;&#x3D; i2)**æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹åˆ™å°†æ­£ç¡®çš„flagè¾“å‡ºåˆ°ç»‘å®šçš„textViewæ§ä»¶ä¸Šï¼Œåä¹‹åˆ™ä¼šæç¤ºâ€œTry againâ€ã€‚ </p>
<p>â€‹        å½“ç„¶ï¼Œè¿™ä¸ªé¢˜å…¶å®æ˜¯å¯ä»¥ç›´æ¥é€†çš„ï¼Œå†™è„šæœ¬çˆ†ç ´ï¼Œä½†æ˜¯ä¸ºäº†å­¦ä¹ fridaçš„ç”¨æ³•ï¼Œæˆ‘ä»¬ä½¿ç”¨fridaæ¥hookå‡ºæ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶æ‰€ç”Ÿæˆçš„éšæœºæ•°iæ˜¯å¤šå°‘ï¼Œç„¶åæˆ‘ä»¬å†å°†æ­£ç¡®ç­”æ¡ˆè¾“å…¥ï¼Œä¾¿å¯å¾—åˆ°æ­£ç¡®flagã€‚</p>
<p>â€‹         PSï¼šå› ä¸ºä½¿ç”¨fridaè¿›è¡Œhookï¼Œä¹Ÿæ˜¯å±äºåŠ¨æ€è°ƒ.apkæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åœ¨aokæ–‡ä»¶çš„AndroidMainfestxmlæ¸…å•é‡ŒæŸ¥çœ‹applicationä¸­æ˜¯å¦æœ‰å¯è°ƒå¼çš„å±æ€§ï¼Œå¦‚æœæ²¡æœ‰å¾—è‡ªè¡ŒåŠ å…¥ã€‚<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1721640598097.png" title="" alt="1721640598097" data-align="left"></p>
<p>ç„¶åå°±å¯ä»¥å¼€å§‹ä½¿ç”¨fridaè¿›è¡Œhookäº†ã€‚</p>
<p>3.å…·ä½“æ“ä½œ</p>
<p>é¦–å…ˆå…ˆæŸ¥çœ‹adbçš„è¿æ¥æ˜¯å¦æœ‰é—®é¢˜ï¼Œåœ¨ç»ˆç«¯è¾“å…¥<strong>adb devices</strong><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1721640935229.png" title="" alt="1721640935229" data-align="left"></p>
<p>ç„¶åè¾“å…¥<strong>adb shell</strong>è¿›å…¥æ‰‹æœºï¼Œæ¥ç€è¾“å…¥<strong>su</strong>è¿›å…¥è¶…çº§ç®¡ç†ï¼Œå†è¾“å…¥<strong>cd &#x2F;data&#x2F;local&#x2F;tmp</strong>è¿›å…¥ç›¸åº”ç›®å½•ï¼ˆç½‘ä¸Šå¤§éƒ¨åˆ†éƒ½æ˜¯å°†frida serverå­˜å…¥æ­¤æ–‡ä»¶å¤¹ã€‚ï¼ˆ<strong>æ³¨</strong>ï¼šfridaå’Œfrida serverç‰ˆæœ¬éœ€ä¸€è‡´ï¼ŒåŒæ—¶frida serverçš„ç±»å‹éœ€ä¸è™šæ‹Ÿæœºï¼ˆæ‰‹æœºï¼‰çš„æ¶æ„ä¸€ç›´ï¼Œå¯ç”¨æŒ‡ä»¤<strong>adb shell getprop ro.product.cpu.abi</strong>æŸ¥çœ‹å…·ä½“ä¿¡æ¯ï¼‰ã€‚è¿›å…¥ç›®å½•ä¹‹åï¼Œå¯ä»¥çœ‹çœ‹æ–‡ä»¶å¤¹é‡Œæ˜¯å¦æœ‰frida serverè¿™ä¸ªæ–‡ä»¶ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1721641241680.png" title="" alt="1721641241680" data-align="left"></p>
<p>ç„¶åä¿®æ”¹æ–‡ä»¶æƒé™<strong>chmod 755 frida-server-16.2\ .1-android-x86_64</strong>ï¼Œç´§æ¥ç€å°±å¯ä»¥è¿è¡Œäº†ã€‚ç„¶åï¼Œæˆ‘å¦å¤–å†æ‰“å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼Œåˆ†åˆ«è¾“å…¥<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1721641449576.png" alt="1721641449576"></p>
<p><strong>adb forward tcp:27042 tcp:27042</strong><br><strong>adb forward tcp:27043 tcp:27043</strong>  è¿›è¡Œç«¯å£è½¬å‘ç›‘å¬</p>
<p>æœ€åè¾“å…¥<strong>frida-ps -U</strong>æˆ–è€…<strong>frida-ps -R</strong>çœ‹çœ‹èƒ½å¦æˆåŠŸè¾“å‡ºè¿›ç¨‹åˆ—è¡¨ï¼Œæ£€æŸ¥fridaèƒ½å¦æ­£å¸¸ä½¿ç”¨ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1721641646506.png" alt="1721641646506"></p>
<p>æˆ‘ä»¬è¿˜éœ€ç¼–å†™è„šæœ¬</p>
<pre><code class="language-javascript">// ä½¿ç”¨Java.performå‡½æ•°åˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„Javaä¸Šä¸‹æ–‡ï¼Œç”¨äºæ‰§è¡ŒæŒ‚é’©å’ŒJavaç±»æ“ä½œ
Java.perform(function() &#123;                                               
    // è·å–åº”ç”¨ç¨‹åºä¸­com.ad2001.frida0x1.MainActivityç±»çš„å¼•ç”¨
    var MainActivity = Java.use(&quot;com.ad2001.frida0x1.MainActivity&quot;);

    // é‡å†™MainActivityç±»çš„get_randomæ–¹æ³•çš„å®ç°
    MainActivity.get_random.implementation = function() &#123;
        // å½“get_randomæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè¾“å‡ºä¸€æ¡æ—¥å¿—ä¿¡æ¯
        console.log(&quot;MainActivity.get_random is called&quot;);

        // è°ƒç”¨åŸå§‹çš„get_randomæ–¹æ³•å¹¶è·å–å…¶è¿”å›å€¼
        var ret_val = this.get_random();                                

        // è¾“å‡ºget_randomæ–¹æ³•çš„è¿”å›ç»“æœ
        console.log(&quot;MainActivity.get_random result is &quot; + ret_val);

        // è¿”å›åŸå§‹æ–¹æ³•çš„è¿”å›å€¼
        return ret_val;
    &#125;;
&#125;);
</code></pre>
<p>ä¿å­˜å¥½ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨<strong>frida -U -f com.ad2001.frida0x1 -l test.js</strong>(test.jsæ˜¯è„šæœ¬çš„ç»å¯¹è·¯å¾„)<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1721642126293.png" alt="1721642126293"></p>
<p>å†åœ¨jadxä¸­ç‚¹å‡»è¿è¡Œï¼Œå°±å¯ä»¥çœ‹åˆ°è¾“å‡ºäº†æ­¤æ¬¡appè¿è¡Œæ—¶ç”Ÿæˆçš„éšæœºæ•°æ˜¯å¤šå°‘ï¼Œå†è®¡ç®— (74 * 2) + 4 &#x3D; 152ï¼Œè¾“å…¥ï¼Œå°±å¯å¾—åˆ°flag</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1721642239103.png" alt="1721642239103"></p>
<p>è¿™å°±æ˜¯åˆ©ç”¨frida hookä¸€ä¸ªæ–¹æ³•çš„å®Œæ•´è¿‡ç¨‹ã€‚</p>
<p>å¯¹åº”é™„ä»¶ï¼šFrida 0X1_1.apk</p>
<p><strong>æ€»ç»“</strong>ï¼šFrida Hookæ–¹æ³•çš„è„šæœ¬æ¨¡æ¿ï¼š</p>
<pre><code class="language-js">Java.perform(function() &#123; 

var &lt;class_reference&gt; = Java.use(â€œ&lt;package_name&gt;.&lt;class&gt;â€); 

&lt;class_reference&gt;.&lt;method_to_hook&gt;.implementation = function(&lt;args&gt;) &#123; 

     /* 

       æˆ‘ä»¬è‡ªå·±çš„æ–¹æ³•å®ç° 

     */ 

   &#125;
&#125;
</code></pre>
<hr>
<h5 id="å››-Frida-ç”¨æ³•ï¼ˆ2ï¼‰-jsè„šæœ¬hookä¸€ä¸ªé™æ€æ–¹æ³•"><a href="#å››-Frida-ç”¨æ³•ï¼ˆ2ï¼‰-jsè„šæœ¬hookä¸€ä¸ªé™æ€æ–¹æ³•" class="headerlink" title="å››.Frida ç”¨æ³•ï¼ˆ2ï¼‰ .jsè„šæœ¬hookä¸€ä¸ªé™æ€æ–¹æ³•"></a>å››.Frida ç”¨æ³•ï¼ˆ2ï¼‰ .jsè„šæœ¬hookä¸€ä¸ªé™æ€æ–¹æ³•</h5><p>1.å·¥å…·ï¼šè¿˜æ˜¯é‚£å‡ æ ·ä¸œè¥¿ã€‚</p>
<p>2.ä¾‹é¢˜ï¼šFrida 0x2</p>
<p>3.åˆ†æï¼š</p>
<p>æ‹¿åˆ°é™„ä»¶apkæ–‡ä»¶ï¼Œå…ˆå®‰è£…åˆ°é›·ç”µ9é‡Œè¿è¡Œä¸€ä¸‹ï¼Œ</p>
<p>æ²¡æœ‰è¾“å…¥ï¼Œå°±æ˜¯å¾ˆç›´ç™½ï¼Œhookã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬ç”¨jadxåç¼–è¯‘ä¸ºjavaçœ‹çœ‹é™æ€é€»è¾‘ã€‚</p>
<pre><code class="language-java">package com.ad2001.frida0x2;

import android.os.Bundle;
import android.util.Base64;
import android.widget.TextView;
import androidx.appcompat.app.AppCompatActivity;
import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

/* loaded from: classes3.dex */
public class MainActivity extends AppCompatActivity &#123;
    static TextView t1;

    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        t1 = (TextView) findViewById(R.id.textview);
    &#125;

    public static void get_flag(int a) &#123;
        if (a == 4919) &#123;
            try &#123;
                SecretKeySpec secretKeySpec = new SecretKeySpec(&quot;HILLBILLWILLBINN&quot;.getBytes(), &quot;AES&quot;);
                Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);
                IvParameterSpec iv = new IvParameterSpec(new byte[16]);
                cipher.init(2, secretKeySpec, iv);
                byte[] decryptedBytes = cipher.doFinal(Base64.decode(&quot;q7mBQegjhpfIAr0OgfLvH0t/D0Xi0ieG0vd+8ZVW+b4=&quot;, 0));
                String decryptedText = new String(decryptedBytes);
                t1.setText(decryptedText);
            &#125; catch (Exception e) &#123;
                e.printStackTrace();
            &#125;
        &#125;
    &#125;
&#125;
</code></pre>
<p>é€»è¾‘å¾ˆç®€å•ï¼Œæœ‰ä¸€ä¸ªé™æ€æ–¹æ³•<strong>get_flag</strong>ï¼Œæ¯”è¾ƒä¸€ä¸ªå‚æ•°aæ˜¯ä¸æ˜¯4919ï¼Œæ˜¯çš„è¯å°±ä¼šè§£å¯†è¾“å‡ºflagï¼Œä¸€ä¸ªAESåŠ å¯†ï¼Œä½†æ˜¯ï¼Œè¿™é‡Œæ²¡æœ‰ä»»ä½•æ–¹æ³•ä¼šè°ƒç”¨è¿™ä¸ªé™æ€æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨fridaç¼–å†™è„šæœ¬è°ƒç”¨è¿™ä¸ªé™æ€æ–¹æ³•ï¼Œå¹¶ä¸”å°†å‚æ•°açš„å€¼æ”¹ä¸ºæ­£ç¡®çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¾“å‡ºflagã€‚ä½¿ç”¨fridaçš„å‰æœŸå·¥ä½œå’Œä¾‹é¢˜ä¸€ä¸€æ ·ï¼Œä½†æ˜¯å› ä¸ºè¿™æ˜¯é™æ€æ–¹æ³•ï¼Œå¦‚æœä½¿ç”¨æŒ‡ä»¤<strong>frida -U -f åŒ…å -l è„šæœ¬</strong>ä¼šå‡ºç°hookä¸ä¸Šçš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆè¿è¡Œç¨‹åºï¼Œç„¶åä½¿ç”¨æŒ‡ä»¤<strong>frida -U â€˜Frida 0x2â€™ -l .\Hook.js</strong>ï¼Œå°±å¯ä»¥è¾“å‡ºflagäº†ã€‚</p>
<p>è„šæœ¬ï¼š</p>
<pre><code class="language-js">Java.perform(function() &#123;

    // å£°æ˜äº†ä¸€ä¸ªå˜é‡aæ¥è¡¨ç¤ºç›®æ ‡Androidåº”ç”¨ç¨‹åºä¸­çš„Javaç±»ã€‚
    // Java.useå‡½æ•°æŒ‡å®šè¦ä½¿ç”¨com.ad2001.frida0x2åŒ…ä¸­çš„MainActivityç±»ã€‚
    var a = Java.use(&quot;com.ad2001.frida0x2.MainActivity&quot;);

    // è°ƒç”¨get_flagæ–¹æ³•å¹¶ä¼ å…¥å‚æ•°4919
    a.get_flag(4919);

&#125;);
</code></pre>
<p>è¿è¡Œè„šæœ¬ï¼š</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/bf377131-0114-495d-9e73-890184a88bf5.png" alt="bf377131-0114-495d-9e73-890184a88bf5"></p>
<p>å¾—åˆ°flag</p>
<p><strong>æ€»ç»“</strong>ï¼šFrida è°ƒç”¨é™æ€æ–¹æ³•çš„è„šæœ¬æ¨¡æ¿ï¼š</p>
<pre><code class="language-js">Java.perform(function ()&#123; 

     var &lt;class_reference&gt; = Java.use(â€œ&lt;package_name&gt;.&lt;class&gt;â€); 

     a.function(val); // éœ€è¦è°ƒç”¨çš„æ–¹æ³•åç§° 

&#125;)
</code></pre>
<hr>
<h5 id="äº”-Frida-ç”¨æ³•ï¼ˆ3ï¼‰-jsè„šæœ¬æ›´æ”¹å˜é‡çš„å€¼"><a href="#äº”-Frida-ç”¨æ³•ï¼ˆ3ï¼‰-jsè„šæœ¬æ›´æ”¹å˜é‡çš„å€¼" class="headerlink" title="äº”.Frida ç”¨æ³•ï¼ˆ3ï¼‰.jsè„šæœ¬æ›´æ”¹å˜é‡çš„å€¼"></a>äº”.Frida ç”¨æ³•ï¼ˆ3ï¼‰.jsè„šæœ¬æ›´æ”¹å˜é‡çš„å€¼</h5><p>1.æ‹¿åˆ°é™„ä»¶apkæ–‡ä»¶ï¼Œä¾æ—§å…ˆå®‰è£…åˆ°é›·ç”µæ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œä¸€ä¸‹çœ‹çœ‹å›æ˜¾ï¼Œ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/592dae50-4a8b-4703-a6f8-ae27fc3af21f.png" alt="592dae50-4a8b-4703-a6f8-ae27fc3af21f"></p>
<p>æ¡†æ¡†ä¸€é¡¿ç‚¹æ²¡ä»€ä¹ˆç”¨ï¼Œé‚£ä¹ˆå°±å¼€å§‹ç”¨jadxé™æ€åˆ†æä¸€æ³¢å§ï¼Œçœ‹çœ‹å‡½æ•°é€»è¾‘ï¼Œ</p>
<pre><code class="language-java">package com.ad2001.frida0x3;

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;
import androidx.appcompat.app.AppCompatActivity;
import java.nio.charset.Charset;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.util.Base64;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.spec.SecretKeySpec;

/* loaded from: classes3.dex */
public class MainActivity extends AppCompatActivity &#123;
    TextView t1;

    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button btn = (Button) findViewById(R.id.button);
        this.t1 = (TextView) findViewById(R.id.textView);
        btn.setOnClickListener(new View.OnClickListener() &#123; // from class: com.ad2001.frida0x3.MainActivity.1
            @Override // android.view.View.OnClickListener
            public void onClick(View v) &#123;
                if (Checker.code == 512) &#123;
                    byte[] bArr = new byte[0];
                    Toast.makeText(MainActivity.this.getApplicationContext(), &quot;YOU WON!!!&quot;, 1).show();
                    byte[] KeyData = &quot;glass123&quot;.getBytes();
                    SecretKeySpec KS = new SecretKeySpec(KeyData, &quot;Blowfish&quot;);
                    byte[] ecryptedtexttobytes = Base64.getDecoder().decode(&quot;MKxsZsY9Usw3ozXKKzTF0ymIaC8rs0AY74GnaKqkUrk=&quot;);
                    try &#123;
                        Cipher cipher = Cipher.getInstance(&quot;Blowfish&quot;);
                        cipher.init(2, KS);
                        byte[] decrypted = cipher.doFinal(ecryptedtexttobytes);
                        String decryptedString = new String(decrypted, Charset.forName(&quot;UTF-8&quot;));
                        MainActivity.this.t1.setText(decryptedString);
                        return;
                    &#125; catch (InvalidKeyException e) &#123;
                        throw new RuntimeException(e);
                    &#125; catch (NoSuchAlgorithmException e2) &#123;
                        throw new RuntimeException(e2);
                    &#125; catch (BadPaddingException e3) &#123;
                        throw new RuntimeException(e3);
                    &#125; catch (IllegalBlockSizeException e4) &#123;
                        throw new RuntimeException(e4);
                    &#125; catch (NoSuchPaddingException e5) &#123;
                        throw new RuntimeException(e5);
                    &#125;
                &#125;
                Toast.makeText(MainActivity.this.getApplicationContext(), &quot;TRY AGAIN&quot;, 1).show();
            &#125;
        &#125;);
    &#125;
&#125;
</code></pre>
<p>é€»è¾‘è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ï¼Œå°±æ˜¯<strong>com.ad2001.frida0x3</strong>åŒ…çš„<strong>Checker</strong>ç±»ä¸­æ£€æŸ¥å‚æ•°codeçš„å€¼æ˜¯å¦æ˜¯512ï¼Œæ˜¯çš„è¯å°±ä¼šè¾“å‡ºflagï¼Œå†æ¥çœ‹çœ‹<strong>Checker</strong>ç±»çš„é€»è¾‘ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/b84316aa-77aa-4e8b-9af1-a0c7c1c42edf.png" alt="b84316aa-77aa-4e8b-9af1-a0c7c1c42edf"></p>
<p>Â Â Â Â Â Â Â Â æœ‰ä¸ª<strong>increase</strong>æ–¹æ³•ï¼Œä¸»å‡½æ•°ä¸­æœ‰ä¸ªæ£€æµ‹æŒ‰é’®çš„ç‚¹å‡»æ¬¡æ•°ï¼Œç‚¹ä¸€æ¬¡å°±åŠ 2ï¼Œé‚£ä¹ˆè¿™ä¸ªé¢˜è¦è§£å‡ºæ¥çš„è¯ï¼Œè¦ä¹ˆç‚¹256æ¬¡ï¼Œè¦ä¹ˆç›´æ¥è§£å¯†ï¼Œä½†ä¼¼ä¹åŠ å¯†çš„é€»è¾‘ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œå†ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ç”¨fridaä¿®æ”¹codeçš„å€¼ï¼Œç›´æ¥æ”¹ä¸º512ï¼Œè¿™æ ·ä¸€æ¥å°±å¯ä»¥ç›´æ¥è¾“å‡ºflagäº†ã€‚</p>
<p><strong>è„šæœ¬</strong>ï¼š</p>
<pre><code class="language-js">/*** 
 * Java.perform æ˜¯Fridaä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºä¸ºè„šæœ¬åˆ›å»ºç‰¹æ®Šä¸Šä¸‹æ–‡ï¼Œ
 * è¿›å…¥æ­¤ä¸Šä¸‹æ–‡åï¼Œå¯ä»¥æ‰§è¡ŒæŒ‚é’©æ–¹æ³•æˆ–è®¿é—®Javaç±»ç­‰æ“ä½œæ¥æ§åˆ¶æˆ–è§‚å¯Ÿåº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚
 **/ 

Java.perform(function () &#123;

    // å£°æ˜äº†ä¸€ä¸ªå˜é‡aæ¥è¡¨ç¤ºç›®æ ‡Androidåº”ç”¨ç¨‹åºä¸­çš„Javaç±»ã€‚
    // Java.useå‡½æ•°æŒ‡å®šè¦ä½¿ç”¨com.ad2001.frida0x3åŒ…ä¸­çš„Checkerç±»ã€‚
    var a = Java.use(&quot;com.ad2001.frida0x3.Checker&quot;);

    // ä½¿ç”¨å˜é‡aå°†æ‰€é€‰ç±»çš„codeå˜é‡å€¼ä¿®æ”¹ä¸º512
    a.code.value = 512; 

&#125;);
</code></pre>
<p>Â Â Â Â Â Â Â Â ä½¿ç”¨fridaè¿˜æ˜¯å’Œå‰é¢çš„æ­¥éª¤ä¸€æ ·ï¼Œç„¶åæˆ‘ä»¬è¾“å…¥æŒ‡ä»¤<strong>frida -U -f com.ad2001.frida0x3 -l hook.js</strong>ï¼Œç„¶åå†ä½¿ç”¨jadxè¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼Œä¸ºçš„æ˜¯æ§åˆ¶ç¨‹åºè¿è¡Œï¼Œç‚¹å‡»ä¸¤æ¬¡è¿è¡Œï¼Œä¼šå‡ºç°æœ€å¼€å§‹çš„é¡µé¢ï¼Œæœ€åç‚¹å‡»Click meï¼Œå°±ä¼šå‡ºç°flag</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/b2eeb84c-a1a9-482b-adc6-f1434a6d376c.png" alt="b2eeb84c-a1a9-482b-adc6-f1434a6d376c"></p>
<p>å¾—åˆ°flag</p>
<p><strong>æ€»ç»“</strong>ï¼šFrida æ›´æ”¹å˜é‡å€¼çš„è„šæœ¬æ¨¡æ¿</p>
<pre><code class="language-js">Java.perform(function ()&#123; 

     var &lt;class_reference&gt; = Java.use(â€œ&lt;package_name&gt;.&lt;class&gt;â€); 

     &lt;class_reference&gt;.&lt;variable&gt;.value = &lt;value&gt;; //éœ€è¦ä¿®æ”¹çš„å˜é‡ 

&#125;)
</code></pre>
<hr>
<h5 id="å…­-Frida-ç”¨æ³•ï¼ˆ4ï¼‰-jsè„šæœ¬åˆ›å»ºç±»å®ä¾‹"><a href="#å…­-Frida-ç”¨æ³•ï¼ˆ4ï¼‰-jsè„šæœ¬åˆ›å»ºç±»å®ä¾‹" class="headerlink" title="å…­.Â Frida ç”¨æ³•ï¼ˆ4ï¼‰.jsè„šæœ¬åˆ›å»ºç±»å®ä¾‹"></a>å…­.Â Frida ç”¨æ³•ï¼ˆ4ï¼‰.jsè„šæœ¬åˆ›å»ºç±»å®ä¾‹</h5><p>å·¥å…·ä¸å˜ï¼Œæ‹¿åˆ°é™„ä»¶apkæ–‡ä»¶ï¼Œä¾æ—§å…ˆå®‰è£…åˆ°é›·ç¥æ¨¡æ‹Ÿå™¨ä¸Šå®‰è£…è¿è¡Œä¸€ä¸‹ã€‚æ²¡æœ‰ä»»ä½•è¾“å…¥æ¡†æˆ–è€…æŒ‰é’®ï¼Œåªæœ‰ä¸€ä¸ªæ‰“æ‹›å‘¼çš„ã€‚é‚£ä¹ˆå°±ä¸¢åˆ°jadxé‡Œåˆ†æçœ‹çœ‹å…·ä½“å‡½æ•°é€»è¾‘ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/bc871d60-adf0-4209-8577-98455a572801.png" alt="bc871d60-adf0-4209-8577-98455a572801"></p>
<p>è¿™æ˜¯<strong>MainActivity</strong>ç±»ï¼Œæ²¡å•¥æœ‰ç”¨çš„ä¿¡æ¯ã€‚å†çœ‹çœ‹<strong>Check</strong>ç±»<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/22979e97-83bc-4149-83e5-29d9e1f54005.png" alt="22979e97-83bc-4149-83e5-29d9e1f54005"></p>
<p>åˆ¤æ–­å‚æ•°açš„å€¼æ˜¯å¦æ˜¯1337ï¼Œæ˜¯çš„è¯å°±ä¼šæŠŠè§£ç çš„flagè¾“å‡ºï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªç±»ä»¥åŠç±»ä¸­çš„æ–¹æ³•å¹¶æ²¡æœ‰åœ¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹è¢«ä½¿ç”¨ï¼Œå› æ­¤æˆ‘ä»¬ä»…ä»…æ‰“å¼€ç¨‹åºæ— æ³•è·å–åˆ°flagçš„å€¼ï¼ŒåŒæ—¶ï¼Œè¿™é‡Œçš„get_flagæ–¹æ³•å¹¶ä¸æ˜¯é™æ€æ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨fridaåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå†ç”¨è¿™ä¸ªå®ä¾‹æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿›è€Œè¾“å‡ºflagã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ“ä½œäº†ï¼Œå‰æœŸå¼€å§‹å·¥ä½œæ˜¯ä¸€æ ·çš„ï¼Œç„¶åæˆ‘ä»¬ç›´æ¥ä½¿ç”¨è„šæœ¬ï¼Œ</p>
<pre><code class="language-js">Java.perform(function() &#123;

    var check = Java.use(&quot;com.ad2001.frida0x4.Check&quot;);
    // å£°æ˜äº†ä¸€ä¸ªå˜é‡ check æ¥è¡¨ç¤ºç›®æ ‡ Android åº”ç”¨ç¨‹åºä¸­çš„ Java ç±»ã€‚
    // Java.use å‡½æ•°æŒ‡å®šè¦ä½¿ç”¨ com.ad2001.frida0x4 åŒ…çš„ Check ç±»ã€‚

    var check_obj = check.$new(); 
    // $new() æ˜¯ Frida ä¸­çš„æ–¹æ³•ï¼Œç”¨äºå®ä¾‹åŒ–ç‰¹å®šç±»çš„å¯¹è±¡ï¼›
    // ä½¿ç”¨ $new() æ–¹æ³•åˆ›å»º Check ç±»çš„å®ä¾‹ check_objã€‚

    var res = check_obj.get_flag(1337); 
    // ä½¿ç”¨ check_obj å®ä¾‹è°ƒç”¨ get_flagï¼Œå¹¶ä¼ å…¥å‚æ•° 1337ã€‚
    // åˆ›å»ºä¸€ä¸ªå˜é‡ res æ¥ä¿å­˜ get_flag æ–¹æ³•çš„è¿”å›å€¼ã€‚

    console.log(&quot;FLAGï¼š&quot; + res);
    // å°†ä¿å­˜çš„ flag è¾“å‡ºåˆ°è„šæœ¬è¿è¡Œæ—¥å¿—ä¸­ã€‚

&#125;);
</code></pre>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/0feeea01-c0ea-429c-9631-9c1d5e923db3.png" alt="0feeea01-c0ea-429c-9631-9c1d5e923db3"></p>
<p>æ‹¿åˆ°flag</p>
<p><strong>æ€»ç»“</strong>ï¼šFrida åˆ›å»ºç±»å®ä¾‹çš„è„šæœ¬æ¨¡æ¿</p>
<pre><code class="language-js">Java.perform(function() &#123;

  var &lt;class_reference&gt; = Java.use(&quot;&lt;package_name&gt;.&lt;class&gt;&quot;);
  var &lt;class_instance&gt; = &lt;class_reference&gt;.$new(); // åˆ›å»ºç±»çš„å®ä¾‹
  &lt;class_instance&gt;.&lt;method&gt;(); // è°ƒç”¨è¯¥å®ä¾‹ä¸­çš„æ–¹æ³•

&#125;)
</code></pre>
<hr>
<h5 id="ä¸ƒ-Frida-ç”¨æ³•ï¼ˆ5ï¼‰-jsè„šæœ¬åœ¨ç°æœ‰å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•"><a href="#ä¸ƒ-Frida-ç”¨æ³•ï¼ˆ5ï¼‰-jsè„šæœ¬åœ¨ç°æœ‰å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•" class="headerlink" title="ä¸ƒ.Frida ç”¨æ³•ï¼ˆ5ï¼‰ .jsè„šæœ¬åœ¨ç°æœ‰å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•"></a>ä¸ƒ.Frida ç”¨æ³•ï¼ˆ5ï¼‰ .jsè„šæœ¬åœ¨ç°æœ‰å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•</h5><p>1.æ‹¿åˆ°é™„ä»¶ï¼Œè¿˜æ˜¯è€æ ·å­ï¼Œå…ˆåˆ°æ¨¡æ‹Ÿå™¨è¿è¡Œä¸€ä¸‹</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/335d30a1-e545-422d-9d15-ce5d9c46ba1a.png" alt="335d30a1-e545-422d-9d15-ce5d9c46ba1a"></p>
<p>æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œå°±æ˜¯ä¸€ä¸ªæç¤ºè¯ï¼Œæ²¡äº†ã€‚å¼€jadxçœ‹çœ‹é€»è¾‘å§ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/a2b28eb3-0581-4eee-ac41-5e1b64740e01.png" alt="a2b28eb3-0581-4eee-ac41-5e1b64740e01"></p>
<p>å¯ä»¥çœ‹åˆ°é€»è¾‘è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ï¼Œæœ‰ä¸€ä¸ª<strong>flag</strong>æ–¹æ³•ï¼Œå¦‚æœ<strong>code</strong>çš„å€¼æ˜¯1337ï¼Œé‚£ä¹ˆå°±ä¼šè¾“å‡ºflagï¼Œä½†æ˜¯è¯¥æ–¹æ³•æ²¡æœ‰åœ¨ç¨‹åºçš„ä»»ä½•ä½ç½®è¢«è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©Fridaæ¡†æ¶æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä»¥è·å–flagã€‚è·Ÿä¸Šä¸€ç”¨æ³•ç›¸åŒçš„æ˜¯æˆ‘ä»¬éœ€è¦é€šè¿‡flagæ–¹æ³•æ‰€åœ¨çš„MainActivityç±»çš„å®ä¾‹æ¥è°ƒç”¨è¯¥æ–¹æ³•ï¼Œä½†åœ¨ä½¿ç”¨Fridaè„šæœ¬åˆ›å»ºMainActivityç±»çš„å®ä¾‹ä¼šå‡ºç°é”™è¯¯ã€‚</p>
<p>åŸå› ï¼š<strong>flagæ–¹æ³•æ˜¯å±äºMainActivityå®ä¾‹çš„ï¼Œè€Œä¸Šä¸€é¢˜ï¼ˆ4ï¼‰ä¸­ï¼Œcheckæ˜¯å•ç‹¬çš„ä¸€ä¸ªç±»å®ä¾‹ï¼Œè€ŒMainActivityæ˜¯Androidç»„ä»¶ï¼Œç”±äºAndroidçš„ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹è§„åˆ™ï¼ŒAndroidç»„ä»¶éœ€è¦ä¾èµ–äºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡è¿è¡Œï¼Œåœ¨Fridaä¸­ï¼Œæˆ‘ä»¬ç¼ºå°‘å¿…è¦çš„ä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚ï¼šAndroid UIç»„ä»¶é€šå¸¸éœ€è¦å…·æœ‰å…³è”Looperçš„ç‰¹å®šçº¿ç¨‹ï¼Œå¦‚æœæ¶‰åŠUIä»»åŠ¡ï¼Œéœ€è¦åœ¨å…·æœ‰æ´»åŠ¨Looperçš„ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚æ€»ä¹‹ï¼Œåˆ›å»ºMainActivityçš„å®ä¾‹å¯èƒ½éœ€è¦åº”ç”¨å¤„äºç‰¹å®šçŠ¶æ€ï¼Œå¹¶é€šè¿‡Fridaç®¡ç†æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸å»ºè®®è¿™æ ·åšã€‚</strong></p>
<p>è§£å†³æ–¹æ³•ï¼š<strong>ç”±äºåˆ›å»ºMainActivityå®ä¾‹æ˜¯Androidåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸçš„ä¸€éƒ¨åˆ†ï¼Œå½“Androidåº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œç³»ç»Ÿä¼šåˆ›å»ºMainActivityçš„ä¸€ä¸ªå®ä¾‹ï¼ˆæˆ–AndroidManifest.xmlæ–‡ä»¶ä¸­æŒ‡å®šçš„å¯åŠ¨å™¨æ´»åŠ¨ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Fridaè·å–MainActivityçš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨flagæ–¹æ³•æ¥è·å–æˆ‘ä»¬çš„æ ‡å¿—ã€‚</strong></p>
<p>è„šæœ¬ï¼š</p>
<pre><code class="language-js">/*
Java.performNowæ˜¯Fridaä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœ¨Javaè¿è¡Œæ—¶ç¯å¢ƒä¸­æ‰§è¡Œä»£ç ã€‚
*/

Java.performNow(function() &#123;

  Java.choose(&#39;com.ad2001.frida0x5.MainActivity&#39;, &#123;
    // Java.chooseåœ¨è¿è¡Œæ—¶æšä¸¾ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„Javaç±»çš„å®ä¾‹ã€‚
    // ç¬¬äºŒä¸ªå‚æ•°éœ€è¦ä¼ å…¥åŒ…å«onMatchå’ŒonCompleteä¸¤ä¸ªå›è°ƒå‡½æ•°çš„é€‰é¡¹å¯¹è±¡ã€‚

      onMatch: function(instance) &#123; 
        // å¤„ç†åŒ¹é…åˆ°çš„ç±»å®ä¾‹çš„å›è°ƒå‡½æ•°
        // instanceå‚æ•°è¡¨ç¤ºMainActivityç±»çš„æ¯ä¸ªåŒ¹é…å®ä¾‹

        console.log(&quot;Instance found&quot;);
        // æ‰¾åˆ°å®ä¾‹æ—¶æ‰“å°ä¸€æ¡æç¤ºä¿¡æ¯ã€‚
        instance.flag(1337); 
        // è°ƒç”¨flagæ–¹æ³•ï¼Œå¹¶ä¼ å…¥å‚æ•°1337ã€‚
    &#125;,
    onComplete: function() &#123;&#125;
    // å®Œæˆæ“ä½œåçš„å›è°ƒå‡½æ•°
  &#125;);
&#125;);
</code></pre>
<p>è¿™ä¸ªé¢˜å’Œç¬¬äºŒä¸ªé¢˜ä¸€æ ·ï¼Œéœ€è¦åœ¨appè¿è¡Œèµ·æ¥ï¼Œç„¶åè¾“å…¥frida -U â€˜Frida 0x5â€™ -l F:\æ¡Œé¢\5.jsï¼Œå°±å¯ä»¥è¾“å‡ºflag</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/e3f1e801-52ef-4c98-af8d-e41be264623f.png" alt="e3f1e801-52ef-4c98-af8d-e41be264623f"></p>
<p>æ€»ç»“ï¼š<strong>Frida åœ¨ç°æœ‰å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•çš„è„šæœ¬æ¨¡æ¿</strong></p>
<pre><code class="language-js">  Java.performNow(function() &#123;
  Java.choose(&#39;&lt;Package&gt;.&lt;class_Name&gt;&#39;, &#123;
    onMatch: function(instance) &#123;
      // åŒ¹é…åˆ°ç±»å®ä¾‹æ—¶è¿›è¡Œçš„æ“ä½œ
    &#125;,
    onComplete: function() &#123;&#125;
    // å®Œæˆæ“ä½œåçš„å›è°ƒå‡½æ•°
  &#125;);
&#125;);
</code></pre>
<hr>
<h5 id="å…«-Fridaç”¨æ³•ï¼ˆ6ï¼‰-jsè„šæœ¬-ä½¿ç”¨å¯¹è±¡å‚æ•°è°ƒç”¨çš„æ–¹æ³•"><a href="#å…«-Fridaç”¨æ³•ï¼ˆ6ï¼‰-jsè„šæœ¬-ä½¿ç”¨å¯¹è±¡å‚æ•°è°ƒç”¨çš„æ–¹æ³•" class="headerlink" title="å…«.Fridaç”¨æ³•ï¼ˆ6ï¼‰ .jsè„šæœ¬ ä½¿ç”¨å¯¹è±¡å‚æ•°è°ƒç”¨çš„æ–¹æ³•"></a>å…«.Fridaç”¨æ³•ï¼ˆ6ï¼‰ .jsè„šæœ¬ ä½¿ç”¨å¯¹è±¡å‚æ•°è°ƒç”¨çš„æ–¹æ³•</h5><p>1.æ‹¿åˆ°apkæ–‡ä»¶ï¼Œæ¨¡æ‹Ÿå™¨è¿è¡Œä¸€ä¸‹ï¼Œè¿˜æ˜¯å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œæ²¡æœ‰ä»»ä½•å¯ä»¥è¾“å…¥çš„ä¸œè¥¿ï¼Œå°±ä¸€ä¸ªæç¤ºè¯ï¼Œæ²¡äº†ã€‚</p>
<p>2.çœ‹ä»£ç é€»è¾‘å§ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/5de480a5-6ed3-46ec-9813-69be4e34c6c7.png" alt="5de480a5-6ed3-46ec-9813-69be4e34c6c7"></p>
<p>ä»£ç çœ‹ä¸‹æ¥ï¼Œå°±æ˜¯ä¸»è¦é€»è¾‘åœ¨<strong>get_flag</strong>æ–¹æ³•é‡Œï¼Œå¯æ˜¯è¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¢«è°ƒç”¨ï¼Œè¯¥æ–¹æ³•å¯¹ä¼ å…¥çš„<strong>Checker</strong>ç±»å‹å‚æ•°Aè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœå‚æ•°Açš„<strong>num1</strong>å˜é‡å€¼ç­‰äº1234ä¸”<strong>num2</strong>å˜é‡å€¼ç­‰äº4321ï¼Œå°±ä¼šå°†flagè§£ç å¹¶è¾“å‡ºã€‚</p>
<p>ä¸ºäº†å¾—åˆ°æ–¹æ³•ä¸­çš„flagï¼Œæˆ‘ä»¬éœ€è¦<strong>è·å–MainActivityç±»çš„å®ä¾‹</strong>æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ŒåŒæ—¶è¿˜éœ€è¦æ»¡è¶³æ–¹æ³•å†…éƒ¨å¯¹ä¼ å…¥å‚æ•°A.num1å’ŒA.num2å˜é‡å€¼çš„éªŒè¯ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦<strong>åˆ›å»º</strong>ä¸€ä¸ª<strong>Checkerç±»çš„å®ä¾‹</strong>ï¼Œå¹¶è®¾ç½®å¥½å®ä¾‹ä¸­<strong>num1</strong>å’Œ<strong>num2</strong>å˜é‡çš„å€¼ï¼Œåœ¨è°ƒç”¨get_flagæ–¹æ³•æ—¶å°†è¿™ä¸ªå®ä¾‹ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</p>
<p>é‚£ä¹ˆå°±å¯ä»¥ç¼–å†™è„šæœ¬äº†ï¼š</p>
<pre><code class="language-js">/*
Java.performNowæ˜¯Fridaä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœ¨Javaè¿è¡Œæ—¶ç¯å¢ƒä¸­æ‰§è¡Œä»£ç ã€‚
*/

Java.performNow(function() &#123;

  Java.choose(&#39;com.ad2001.frida0x6.MainActivity&#39;, &#123;
    // Java.chooseåœ¨è¿è¡Œæ—¶æšä¸¾MainActivityç±»çš„å®ä¾‹ã€‚
    // ç¬¬äºŒä¸ªå‚æ•°éœ€è¦ä¼ å…¥åŒ…å«onMatchå’ŒonCompleteä¸¤ä¸ªå›è°ƒå‡½æ•°çš„é€‰é¡¹å¯¹è±¡ã€‚

    onMatch: function(instance) &#123;
      // å¤„ç†åŒ¹é…åˆ°çš„ç±»å®ä¾‹çš„å›è°ƒå‡½æ•°

      console.log(&quot;Instance found&quot;);
       // å¤„ç†åŒ¹é…åˆ°çš„ç±»å®ä¾‹çš„å›è°ƒå‡½æ•°

      var checker = Java.use(&quot;com.ad2001.frida0x6.Checker&quot;);
       // Java.useå‡½æ•°æŒ‡å®šè¦ä½¿ç”¨com.ad2001.frida0x6åŒ…çš„Checkç±»ã€‚

      var checker_obj  = checker.$new();  
       // ä½¿ç”¨$new()æ–¹æ³•åˆ›å»ºCheckç±»çš„å®ä¾‹check_objã€‚
      checker_obj.num1.value = 1234; 
       // å°†check_objå®ä¾‹çš„num1å˜é‡å€¼è®¾ç½®ä¸º1234
      checker_obj.num2.value = 4321; 
       // å°†check_objå®ä¾‹çš„num2å˜é‡å€¼è®¾ç½®ä¸º4321

      instance.get_flag(checker_obj); 
       // ä½¿ç”¨check_objä½œä¸ºå‚æ•°ï¼›
       // é€šè¿‡è·å–åˆ°çš„MainActivityç±»çš„å®ä¾‹instanceè°ƒç”¨get_flagæ–¹æ³•

    &#125;,
    onComplete: function() &#123;&#125;
  &#125;);
&#125;);
</code></pre>
<p>è¿è¡Œè„šæœ¬ï¼Œè¿˜æ˜¯ä¸€æ ·ï¼Œå…ˆè®©ç¨‹åºè¿è¡Œèµ·æ¥ï¼Œç„¶åè¿è¡Œè„šæœ¬å»è·å–<strong>MainActivity</strong>å®ä¾‹ã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/c08a65da-6ad9-4ec7-a418-49658949b813.png" alt="c08a65da-6ad9-4ec7-a418-49658949b813"></p>
<p>å¾—åˆ°flag</p>
<p>æ€»ç»“ï¼š<strong>Frida ä½¿ç”¨å¯¹è±¡å‚æ•°è°ƒç”¨æ–¹æ³•çš„è„šæœ¬æ¨¡æ¿</strong></p>
<pre><code class="language-js">Java.performNow(function() &#123;
  Java.choose(&#39;&lt;Package&gt;.&lt;class_Name&gt;&#39;, &#123;
    onMatch: function(instance) &#123;
      var &lt;class_reference&gt; = Java.use(&quot;&lt;package_name&gt;.&lt;class&gt;&quot;);
      var &lt;class_instance&gt; = &lt;class_reference&gt;.$new(); // åˆ›å»ºç±»çš„å®ä¾‹
      /*
      è®¾ç½®å®ä¾‹å‚æ•°
      */
      instance.&lt;method&gt;(class_instance); // ä½¿ç”¨å¯¹è±¡å‚æ•°è°ƒç”¨æ–¹æ³•
    &#125;,
    onComplete: function() &#123;&#125;
    // å®Œæˆæ“ä½œåçš„å›è°ƒå‡½æ•°
  &#125;);
&#125;);
</code></pre>
<hr>
<h5 id="ä¹-Fridaç”¨æ³•ï¼ˆ7ï¼‰-jsè„šæœ¬-Hookæ„é€ å‡½æ•°"><a href="#ä¹-Fridaç”¨æ³•ï¼ˆ7ï¼‰-jsè„šæœ¬-Hookæ„é€ å‡½æ•°" class="headerlink" title="ä¹.Fridaç”¨æ³•ï¼ˆ7ï¼‰ .jsè„šæœ¬ Hookæ„é€ å‡½æ•°"></a>ä¹.Fridaç”¨æ³•ï¼ˆ7ï¼‰ .jsè„šæœ¬ Hookæ„é€ å‡½æ•°</h5><p>1.æ‹¿åˆ°apkå®‰è£…åŒ…ï¼Œè¿˜æ˜¯å…ˆå®‰è£…åˆ°æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œä¸€ä¸‹çœ‹çœ‹å…ˆï¼Œ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/a95132d6-0271-4f2f-a4fa-ec9ea5c416f9.png" alt="a95132d6-0271-4f2f-a4fa-ec9ea5c416f9"></p>
<p>è¿˜æ˜¯ä¸€æ ·ï¼Œæ²¡æœ‰è¾“å…¥æ¡†ï¼Œåªæœ‰ä¸€å¥æç¤ºè¯ï¼Œé‚£å°±ç”¨jadxåç¼–è¯‘çœ‹çœ‹å§ï¼Œ</p>
<pre><code class="language-java">package com.ad2001.frida0x7;

import android.os.Bundle;
import android.widget.TextView;
import androidx.appcompat.app.AppCompatActivity;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.util.Base64;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.spec.SecretKeySpec;

/* loaded from: classes3.dex */
public class MainActivity extends AppCompatActivity &#123;
    TextView t1;

    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        this.t1 = (TextView) findViewById(R.id.textview);
        Checker ch = new Checker(123, 321);
        try &#123;
            flag(ch);
        &#125; catch (InvalidKeyException e) &#123;
            throw new RuntimeException(e);
        &#125; catch (NoSuchAlgorithmException e2) &#123;
            throw new RuntimeException(e2);
        &#125; catch (BadPaddingException e3) &#123;
            throw new RuntimeException(e3);
        &#125; catch (IllegalBlockSizeException e4) &#123;
            throw new RuntimeException(e4);
        &#125; catch (NoSuchPaddingException e5) &#123;
            throw new RuntimeException(e5);
        &#125;
    &#125;

    public void flag(Checker A) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException, IllegalBlockSizeException, BadPaddingException &#123;
        if (A.num1 &gt; 512 &amp;&amp; 512 &lt; A.num2) &#123;
            Cipher cipher = Cipher.getInstance(&quot;AES&quot;);
            SecretKeySpec secretKeySpec = new SecretKeySpec(&quot;MySecureKey12345&quot;.getBytes(), &quot;AES&quot;);
            cipher.init(2, secretKeySpec);
            byte[] decryptedBytes = Base64.getDecoder().decode(&quot;cL/bBqDmfO0IXXJCVFwYLeHp1k3mQr+SP6rlQGUPZTY=&quot;);
            String decrypted = new String(cipher.doFinal(decryptedBytes));
            this.t1.setText(decrypted);
        &#125;
    &#125;
&#125;
</code></pre>
<p>åˆ†æä»£ç é€»è¾‘ï¼Œå¹¶ä¸éš¾ï¼Œå°±æ˜¯æœ‰ä¸€ä¸ª<strong>Checker</strong>ç±»çš„å¯¹è±¡ï¼Œè°ƒç”¨flagæ–¹æ³•ä¼ å…¥è¯¥å¯¹è±¡ï¼Œç„¶åå¯¹num1å’Œnum2çš„ä¸¤ä¸ªå€¼åˆ†åˆ«è¿›è¡Œåˆ¤æ–­ï¼Œä¸¤ä¸ªå‚æ•°å¿…é¡»éƒ½å¤§äº512ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹flagè¿›è¡Œè§£å¯†è¾“å‡ºã€‚</p>
<p>é€»è¾‘æ˜ç™½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™è„šæœ¬è¿›è¡Œhookï¼ŒHookÂ Checkerç±»å¯¹è±¡çš„æ„é€ å‡½æ•°Checker(int a, int b)ï¼Œå°†å‚æ•°aï¼Œbä¿®æ”¹ä¸ºå¤§äº512çš„å€¼æ¥ç»•è¿‡æ£€éªŒã€‚</p>
<p>è„šæœ¬ï¼š</p>
<pre><code class="language-js">Java.perform(function ()&#123;

  var a = Java.use(&quot;com.ad2001.frida0x7.Checker&quot;);
    // å£°æ˜äº†ä¸€ä¸ªå˜é‡aæ¥è¡¨ç¤ºç›®æ ‡Androidåº”ç”¨ç¨‹åºä¸­çš„Javaç±»ã€‚
    // Java.useå‡½æ•°æŒ‡å®šè¦ä½¿ç”¨com.ad2001.frida0x7åŒ…ä¸­çš„Checkerç±»ã€‚

  a.$init.implementation = function (a,b)&#123;
    // $initå…³é”®å­—Hook Checkerç±»å¯¹è±¡åˆ›å»ºæ—¶æ‰§è¡Œçš„æ„é€ å‡½æ•°

    console.log(&quot;Origin numï¼š&quot;,a,b);
    // æ‰“å°a,bå˜é‡åˆå§‹åŒ–æ—¶è®¾ç½®çš„å€¼

    this.$init(1000,1000);
    // è°ƒç”¨Checkerç±»æ„é€ å‡½æ•°å°†a,bå˜é‡å€¼ä¿®æ”¹ä¸º600
  &#125;
&#125;)
</code></pre>
<p>è¿è¡Œè„šæœ¬ï¼Œç„¶ååˆ©ç”¨jadxæ§åˆ¶ç¨‹åºè¿è¡Œ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/5173e46c-b3cf-419f-8c72-a6696551909f.png" alt="5173e46c-b3cf-419f-8c72-a6696551909f"></p>
<p>æ‹¿åˆ°flag</p>
<p>æ€»ç»“ï¼š<strong>Frida Hookæ„é€ å‡½æ•°çš„è„šæœ¬æ¨¡æ¿</strong></p>
<pre><code class="language-js">Java.perform(function() &#123;
  var &lt;class_reference&gt; = Java.use(&quot;&lt;package_name&gt;.&lt;class&gt;&quot;);
  &lt;class_reference&gt;.$init.implementation = function(&lt;args&gt;)&#123;

    /*
    æˆ‘ä»¬è‡ªå·±çš„æ–¹æ³•å®ç°
    */

  &#125;
&#125;);
</code></pre>
<hr>
<h5 id="å-Fridaç”¨æ³•ï¼ˆ8ï¼‰-jsè„šæœ¬-Hook-nativeå‡½æ•°"><a href="#å-Fridaç”¨æ³•ï¼ˆ8ï¼‰-jsè„šæœ¬-Hook-nativeå‡½æ•°" class="headerlink" title="å.Fridaç”¨æ³•ï¼ˆ8ï¼‰ .jsè„šæœ¬ Hook nativeå‡½æ•°"></a>å.Fridaç”¨æ³•ï¼ˆ8ï¼‰ .jsè„šæœ¬ Hook nativeå‡½æ•°</h5><p>1.æ‹¿åˆ°é™„ä»¶ï¼Œå®‰è£…åˆ°æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å¯ä»¥è®©æˆ‘ä»¬è¾“å…¥å­—ç¬¦æˆ–è€…æ•°å­—ï¼Œç„¶åç‚¹å‡»æäº¤ï¼ŒæŠ¥é”™ï¼Œæ²¡äº†ã€‚</p>
<p>2.ç”¨jadxé™æ€åˆ†æå§ï¼Œ</p>
<pre><code class="language-java">package com.ad2001.frida0x8;

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;
import androidx.appcompat.app.AppCompatActivity;
import com.ad2001.frida0x8.databinding.ActivityMainBinding;

/* loaded from: classes4.dex */
public class MainActivity extends AppCompatActivity &#123;
    private ActivityMainBinding binding;
    Button btn;
    EditText edt;

    public native int cmpstr(String str);

    static &#123;
        System.loadLibrary(&quot;frida0x8&quot;);
    &#125;

    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        ActivityMainBinding inflate = ActivityMainBinding.inflate(getLayoutInflater());
        this.binding = inflate;
        setContentView(inflate.getRoot());
        this.edt = (EditText) findViewById(R.id.editTextText);
        Button button = (Button) findViewById(R.id.button);
        this.btn = button;
        button.setOnClickListener(new View.OnClickListener() &#123; // from class: com.ad2001.frida0x8.MainActivity.1
            @Override // android.view.View.OnClickListener
            public void onClick(View v) &#123;
                String ip = MainActivity.this.edt.getText().toString();
                int res = MainActivity.this.cmpstr(ip);
                if (res == 1) &#123;
                    Toast.makeText(MainActivity.this, &quot;YEY YOU GOT THE FLAG &quot; + ip, 1).show();
                &#125; else &#123;
                    Toast.makeText(MainActivity.this, &quot;TRY AGAIN&quot;, 1).show();
                &#125;
            &#125;
        &#125;);
    &#125;
&#125;
</code></pre>
<p>åˆ†æä»£ç é€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåªæœ‰å½“æˆ‘ä»¬è¾“å…¥çš„å†…å®¹æ˜¯æ­£ç¡®çš„flagæ—¶ï¼Œ<strong>cmpstr</strong>æ–¹æ³•çš„è¿”å›å€¼æ˜¯1æ—¶ï¼Œå°±ä¼šè¾“å‡ºè¡¨ç¤ºæ­£ç¡®çš„æç¤ºè¯ï¼Œç„¶åå†è¾“å‡ºflagã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥æ–¹æ³•æ˜¯<strong>native</strong>å±‚çš„ï¼Œ</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/7fd743f8-b07c-4e52-b19d-957af40378e5.png" alt="7fd743f8-b07c-4e52-b19d-957af40378e5"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å»<strong>nativeå±‚</strong>æŸ¥çœ‹è¯¥å‡½æ•°çš„é€»è¾‘ã€‚æˆ‘ä»¬å°†é™„ä»¶ä¸­çš„apkæ–‡ä»¶çš„åç¼€ï¼Œapkæ”¹æˆzipï¼Œç„¶åè§£å‹ç¼©ï¼Œç„¶åæˆ‘ä»¬åœ¨è·¯å¾„lib-&gt;x86_64-&gt;libfrida0x8.soï¼Œæ‰“å¼€libfrida0x8.soæ–‡ä»¶ï¼Œç”¨ida64åˆ†æï¼Œç„¶åæ‰¾åˆ°ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/038ef7a8-82f7-45b0-8363-2b9ddcf7e43d.png" alt="038ef7a8-82f7-45b0-8363-2b9ddcf7e43d"></p>
<p>å°±å¯ä»¥çœ‹åˆ°ä¼ªä»£ç ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/636e6848-d88a-497a-8b9b-e6886d1836db.png" alt="636e6848-d88a-497a-8b9b-e6886d1836db"></p>
<p>å¯ä»¥çœ‹åˆ°å°±æ˜¯<strong>aGsjebObujwfMbo</strong>å­—ç¬¦ä¸²æ¯ä¸€ä¸ªå…ƒç´ éƒ½å‡ä¸€ï¼Œç„¶åå°†ç»“æœç»™åˆ°Passwordï¼Œæœ€åè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œä¸€æ ·å°±è¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚ç”±äºpassword å‚æ•°åªåœ¨ native åº“ä¸­è°ƒç”¨çš„ strcmp å‡½æ•°ä¸­è¢«ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ Frida è„šæœ¬ Hook strcmp å‡½æ•°æ¥å®ç°ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªjsè„šæœ¬Hook åº”ç”¨ç¨‹åºåŠ è½½çš„ frida0x8 native åº“ä¸­ cmpstr å‡½æ•°ä½¿ç”¨çš„ strcmp å‡½æ•°ï¼Œå¹¶è·å–å‡½æ•°ä¸­ä½¿ç”¨çš„å‚æ•° password çš„å€¼ã€‚</p>
<p>ä»¥ä¸‹å°±æ˜¯è„šæœ¬ï¼š</p>
<p>ç¬¬ä¸€ç§ï¼š</p>
<pre><code class="language-js">var strcmp_adr =  Module.findExportByName(&quot;libc.so&quot;, &quot;strcmp&quot;);
// ä½¿ç”¨Module.findExportByName()è·å–libc.soåº“ä¸­strcmpå‡½æ•°çš„åœ°å€ã€‚

Interceptor.attach(strcmp_adr, &#123;
  // Hook strcmp_adråœ°å€å¯¹åº”çš„å‡½æ•°ï¼Œå°†onEnterå’ŒonLeaveå›è°ƒå‡½æ•°é™„åŠ åˆ°strcmp_adråœ°å€ä¸­

  onEnter: function (args) &#123;
    // åœ¨strcmpå‡½æ•°è¢«è°ƒç”¨ä¹‹å‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œargsæ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼Œæä¾›å¯¹å‡½æ•°å‚æ•°çš„è®¿é—®ã€‚

    console.log(&quot;Hooking the strcmp function&quot;);
    // è¿›å…¥strcmpå‡½æ•°æ—¶æ‰“å°æç¤ºè¯­&quot;Hooking the strcmp function&quot;

    var flag = Memory.readUtf8String(args[1]); 
    // ä½¿ç”¨Memory.readUtf8String()è·å–passwordå‚æ•°ï¼›
    // passwordå‚æ•°åœ¨strcmpå‡½æ•°ä¸­çš„åœ°å€ä¸ºarg[1]ã€‚

    console.log(&quot;The flag is &quot;+ flag);
    // æ‰“å°è·å–åˆ°çš„passwordå‚æ•°å€¼ã€‚

  &#125;,
  onLeave: function (retval) &#123;
    // åœ¨strcmpå‡½æ•°è¢«è°ƒç”¨ä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œå®ƒæä¾›å¯¹è¿”å›å€¼retvalçš„è®¿é—®ã€‚
  &#125;
&#125;);
</code></pre>
<p>ä½†æ˜¯ï¼Œè¿™ä¸ªè„šæœ¬ä¼šæŠŠç¨‹åºä¸­æ‰€æœ‰çš„strcmpå‡½æ•°éƒ½æ‰“å°å‡ºæ¥ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥ä¸€ä¸ªç‰¹å®šçš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ï¼šâ€HELLOâ€ï¼‰ï¼Œå°†å…¶ä½œä¸º Hook è„šæœ¬çš„è¿‡æ»¤å™¨ã€‚</p>
<pre><code class="language-js">var strcmp_adr = Module.findExportByName(&quot;libc.so&quot;, &quot;strcmp&quot;);
// ä½¿ç”¨Module.findExportByName()è·å–libc.soåº“ä¸­strcmpå‡½æ•°çš„åœ°å€ã€‚
Z
Interceptor.attach(strcmp_adr, &#123;
  // Hook strcmp_adråœ°å€å¯¹åº”çš„å‡½æ•°ï¼Œå°†onEnterå’ŒonLeaveå›è°ƒå‡½æ•°é™„åŠ åˆ°strcmp_adråœ°å€ä¸­

    onEnter: function (args) &#123;
      // åœ¨strcmpå‡½æ•°è¢«è°ƒç”¨ä¹‹å‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œargsæ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼Œæä¾›å¯¹å‡½æ•°å‚æ•°çš„è®¿é—®ã€‚

        var arg0 = Memory.readUtf8String(args[0]);
          // ä½¿ç”¨Memory.readUtf8String()è¯»å–ç¬¬ä¸€å‚æ•°inputStrå†…å®¹ã€‚

        var flag = Memory.readUtf8String(args[1]);
          // ä½¿ç”¨Memory.readUtf8String()è·å–ç¬¬äºŒä¸ªå‚æ•°passwordå†…å®¹ã€‚

        if (arg0.includes(&quot;HELLO&quot;)) &#123;
          // åªæœ‰å½“ç¬¬ä¸€ä¸ªå‚æ•°å€¼æ˜¯æˆ‘ä»¬è¾“å…¥çš„ç‰¹å®šå­—ç¬¦ä¸²&quot;HELLO&quot;æ—¶æ‰æ‰§è¡Œä¸‹é¢çš„æ“ä½œã€‚

            console.log(&quot;Hooking the strcmp function&quot;);
             // æ‰“å°æç¤ºè¯­&quot;Hooking the strcmp function&quot;

            console.log(&quot;Input &quot; + arg0);
             // æ‰“å°ç¬¬ä¸€ä¸ªå‚æ•°inputStrçš„å€¼ã€‚

            console.log(&quot;The flag is &quot;+ flag);
             // æ‰“å°ç¬¬äºŒä¸ªå‚æ•°passwordçš„å€¼ã€‚

        &#125;
    &#125;,
    onLeave: function (retval) &#123;
        // åœ¨strcmpå‡½æ•°è¢«è°ƒç”¨ä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œå®ƒæä¾›å¯¹è¿”å›å€¼retvalçš„è®¿é—®ã€‚
    &#125;
&#125;);
</code></pre>
<blockquote>
<p>Memory.readUtf8String()æ˜¯Fridaä¸­ç”¨äºè¯»å–å†…å­˜ä¸­UTF-8ç¼–ç å­—ç¬¦ä¸²çš„å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯ä»æŒ‡å®šçš„å†…å­˜åœ°å€è¯»å–UTF-8ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºJavaScriptä¸­çš„å­—ç¬¦ä¸²ç±»å‹ã€‚</p>
</blockquote>
<p>æ‹¿åˆ°flag</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/c5626169-66af-46d4-85a7-ae73bd1cbca7.png" alt="c5626169-66af-46d4-85a7-ae73bd1cbca7"></p>
<p>æ€»ç»“ï¼š<strong>Frida Hook native å‡½æ•°çš„è„šæœ¬æ¨¡æ¿</strong></p>
<pre><code class="language-js">Interceptor.attach(targetAddress, &#123;
  // å°†å›è°ƒé™„åŠ åˆ°æŒ‡å®šçš„å‡½æ•°åœ°å€ï¼ŒtargetAddressä¸ºæˆ‘ä»¬æƒ³è¦æŒ‚é’©çš„nativeå‡½æ•°çš„åœ°å€ã€‚

  onEnter: function (args) &#123;
    // åœ¨ç›®æ ‡å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œæä¾›å¯¹å‡½æ•°å‚æ•°argsçš„è®¿é—®ã€‚

    console.log(&#39;Entering &#39; + functionName);
    // æ ¹æ®éœ€è¦ä¿®æ”¹æˆ–è®°å½•å‚æ•°
  &#125;,
  onLeave: function (retval) &#123;
    // åœ¨ç›®æ ‡å‡½æ•°è¢«è°ƒç”¨ä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œå®ƒæä¾›å¯¹è¿”å›å€¼retvalçš„è®¿é—®ã€‚

    console.log(&#39;Leaving &#39; + functionName);
    // æ ¹æ®éœ€è¦ä¿®æ”¹æˆ–è®°å½•å‚æ•°
  &#125;
&#125;);
</code></pre>
<p><strong>è¡¥å……</strong>ï¼š</p>
<p>åœ¨å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“ï¼ŒHookä¸€ä¸ªå‡½æ•°éœ€è¦çŸ¥é“è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„ç¨‹åºåŒ…åå’Œç±»åã€‚è€ŒHook native å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ª native å‡½æ•°çš„åœ°å€ï¼Œç„¶åä½¿ç”¨ Frida çš„ Interceptor API è¿›è¡Œ Hookã€‚</p>
<blockquote>
<p>Interceptor APIæ˜¯Fridaä¸­ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„æ¨¡å—ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ Hook C å‡½æ•°ã€Objective-C æ–¹æ³•ã€‚</p>
<p>Interceptoræ¨¡å—ä¸­Interceptor.attach()å‡½æ•°ç”¨äºæ‹¦æˆªå‡½æ•°è°ƒç”¨ï¼Œéœ€è¦ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ‹¦æˆªçš„å‡½æ•°åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯åŒ…å«å›è°ƒå‡½æ•°çš„å¯¹è±¡ï¼Œç”¨äºå®šä¹‰åœ¨ç›®æ ‡å‡½æ•°è¢«è°ƒç”¨æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œé€šå¸¸åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼š</p>
<ul>
<li><p>onEnterï¼šåœ¨ç›®æ ‡å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚åœ¨è¿™ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œå¯ä»¥è®¿é—®å‡½æ•°çš„å‚æ•°ï¼Œä¿®æ”¹å‚æ•°çš„å€¼ï¼Œè®°å½•å‡½æ•°è°ƒç”¨ä¿¡æ¯ç­‰æ“ä½œã€‚</p>
</li>
<li><p>onLeaveï¼šåœ¨ç›®æ ‡å‡½æ•°è¢«è°ƒç”¨ä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚åœ¨è¿™ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œå¯ä»¥è®¿é—®å‡½æ•°çš„è¿”å›å€¼ï¼Œä¿®æ”¹è¿”å›å€¼ï¼Œè®°å½•å‡½æ•°æ‰§è¡Œç»“æœç­‰æ“ä½œã€‚</p>
</li>
</ul>
</blockquote>
<p><strong>å¯¼å‡ºå‡½æ•°è¡¨</strong>ï¼šæŒ‡çš„æ˜¯åº“æ–‡ä»¶æä¾›ç»™å¤–éƒ¨ä½¿ç”¨çš„å‡½æ•°æˆ–å˜é‡ã€‚</p>
<p><strong>å¯¼å…¥å‡½æ•°è¡¨</strong>ï¼šæŒ‡åº“æ–‡ä»¶å¼•ç”¨çš„å‡½æ•°æˆ–å˜é‡ã€‚</p>
<p>åœ¨Frida 0x8 çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å‡½æ•°æ˜¯ strcmpå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä» libfrida0x8.so çš„å¯¼å…¥è¡¨æˆ–è€… libc çš„å¯¼å‡ºè¡¨ä¸­æ‰¾åˆ°è¯¥å‡½æ•°åœ°å€ã€‚</p>
<p>è¾“å‡ºlibfrida0x8.soçš„å¯¼å‡ºè¡¨ï¼šModule.enumerateExports(â€œlibfrida0x8.soâ€)</p>
<p>æ‰¾strcmpå‡½æ•°çš„åœ°å€ï¼šModule.findExportByName(â€œlibc.soâ€,Â â€œstrcmpâ€)æˆ–è€…    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Module.enumerateImports(â€œlibfrida0x8.soâ€)[4]</p>
<hr>
<p>æ‰¾cmpstrå‡½æ•°çš„åœ°å€ï¼šModule.getExportByName(â€œlibfrida0x8.soâ€,Â â€œJava_com_ad2001_frida0x8_MainActivity_cmpstrâ€)</p>
<p>Module.findExportByName(â€œlibfrida0x8.soâ€,Â â€œJava_com_ad2001_frida0x8_MainActivity_cmpstrâ€)</p>
<p>Module.findExportByNameä¸ Module.getExportByName ç›¸åŒã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œå¦‚æœæ‰¾ä¸åˆ°å¯¼å‡ºç¬¦å·ï¼ŒModule.getExportByName ä¼šå¼•å‘å¼‚å¸¸ï¼Œè€Œ Module.findExportByName ä¼šè¿”å› nullã€‚</p>
<p>æœ‰æ—¶ï¼Œå¦‚æœä¸Šé¢çš„ API è·å–ä¸åˆ°æŒ‡å®šå‡½æ•°åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Module.getBaseAddressï¼Œè¿™ä¸ª API è¿”å›ç»™å®šæ¨¡å—çš„åŸºåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æ‰¾åˆ° libfrida0x8.so åº“çš„åŸºåœ°å€ã€‚å¦‚æœæˆ‘ä»¬æƒ³æ‰¾åˆ°ä¸€ä¸ªç‰¹å®šå‡½æ•°çš„åœ°å€ï¼Œå¯ä»¥åœ¨åŸºåœ°å€çš„åŸºç¡€ä¸Šæ·»åŠ åç§»é‡ã€‚cmpstr å‡½æ•°çš„åç§»é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ IDA ä¸­æŸ¥çœ‹</p>
<p>Module.getBaseAddress(â€œlibfrida0x8.soâ€).add(0x864)   ï¼ˆ0x864æ˜¯åç§»é‡ï¼Œå¯ä»¥åœ¨idaä¸­çœ‹åˆ°ï¼‰<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/ebecd84b-9b14-4c80-9ee6-8a238b859c11.png" alt="ebecd84b-9b14-4c80-9ee6-8a238b859c11"></p>
<hr>
<p><strong>æ³¨</strong>ï¼šç”±äº Android é»˜è®¤å¯ç”¨ ASLR å®‰å…¨æœºåˆ¶ï¼Œç³»ç»Ÿå¯åŠ¨æˆ–ç¨‹åºåŠ è½½æ—¶éšæœºåŒ–å†…å­˜åœ°å€ç©ºé—´ï¼Œå¦‚æœä½ é‡æ–°å¯åŠ¨äº† APPï¼Œå‰åä¸¤æ¬¡è·å–åˆ°çš„æŒ‡å®šå‡½æ•°åœ°å€ä¼šæœ‰å·®å¼‚ã€‚</p>
<p>æŸ¥çœ‹libfrida0x8.soå¯¼å…¥ç¬¦å·ä¿¡æ¯ï¼šModule.enumerateImports(â€œlibfrida0x8.soâ€)</p>
<p>æ¥ç€ï¼Œå¯ä»¥åˆ©ç”¨ä¸‹æ ‡æ¥è®¿é—®å…¶ä¸­çš„å‡½æ•°çš„åœ°å€ï¼šModule.enumerateImports(â€œlibfrida0x8.soâ€)[4][â€œaddressâ€]    [4]å°±æ˜¯ä¸‹æ ‡ã€‚</p>
<hr>
<h5 id="åä¸€-Fridaç”¨æ³•ï¼ˆ9ï¼‰-jsè„šæœ¬-æ›´æ”¹nativeå‡½æ•°çš„è¿”å›å€¼"><a href="#åä¸€-Fridaç”¨æ³•ï¼ˆ9ï¼‰-jsè„šæœ¬-æ›´æ”¹nativeå‡½æ•°çš„è¿”å›å€¼" class="headerlink" title="åä¸€.Fridaç”¨æ³•ï¼ˆ9ï¼‰.jsè„šæœ¬ æ›´æ”¹nativeå‡½æ•°çš„è¿”å›å€¼"></a>åä¸€.Fridaç”¨æ³•ï¼ˆ9ï¼‰.jsè„šæœ¬ æ›´æ”¹nativeå‡½æ•°çš„è¿”å›å€¼</h5><p>1.é¦–å…ˆè¿˜æ˜¯ä¸€æ ·ï¼Œæ‹¿åˆ°apkæ–‡ä»¶ï¼Œå…ˆå®‰è£…åˆ°æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œä¸€ä¸‹ï¼Œç»“æœè¿˜æ˜¯ä¸€æ ·ï¼Œä¸€é¡¿ç‚¹ï¼Œç„¶åä¹åªæœ‰æç¤ºä½ try angin</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/1e770054-8c1c-47c3-aaa7-4d66432e4def.png" alt="1e770054-8c1c-47c3-aaa7-4d66432e4def"></p>
<p>2.æ¥ç€ç”¨jadxæ‰“å¼€ï¼Œé™æ€åˆ†æä¸€ä¸‹åç¼–è¯‘çš„Javaä»£ç ï¼Œ</p>
<pre><code class="language-java">package com.ad2001.a0x9;

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.Toast;
import androidx.appcompat.app.AppCompatActivity;
import com.ad2001.a0x9.databinding.ActivityMainBinding;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.util.Base64;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.spec.SecretKeySpec;

/* loaded from: classes3.dex */
public class MainActivity extends AppCompatActivity &#123;
    private ActivityMainBinding binding;
    Button btn;

    public native int check_flag();

    static &#123;
        System.loadLibrary(&quot;a0x9&quot;);
    &#125;

    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        ActivityMainBinding inflate = ActivityMainBinding.inflate(getLayoutInflater());
        this.binding = inflate;
        setContentView(inflate.getRoot());
        Button button = (Button) findViewById(R.id.button);
        this.btn = button;
        button.setOnClickListener(new View.OnClickListener() &#123; // from class: com.ad2001.a0x9.MainActivity.1
            @Override // android.view.View.OnClickListener
            public void onClick(View v) &#123;
                if (MainActivity.this.check_flag() == 1337) &#123;
                    try &#123;
                        Cipher cipher = Cipher.getInstance(&quot;AES&quot;);
                        SecretKeySpec secretKeySpec = new SecretKeySpec(&quot;3000300030003003&quot;.getBytes(), &quot;AES&quot;);
                        try &#123;
                            cipher.init(2, secretKeySpec);
                            byte[] decryptedBytes = Base64.getDecoder().decode(&quot;hBCKKAqgxVhJMVTQS8JADelBUPUPyDiyO9dLSS3zho0=&quot;);
                            try &#123;
                                String decrypted = new String(cipher.doFinal(decryptedBytes));
                                Toast.makeText(MainActivity.this.getApplicationContext(), &quot;You won &quot; + decrypted, 1).show();
                                return;
                            &#125; catch (BadPaddingException e) &#123;
                                throw new RuntimeException(e);
                            &#125; catch (IllegalBlockSizeException e2) &#123;
                                throw new RuntimeException(e2);
                            &#125;
                        &#125; catch (InvalidKeyException e3) &#123;
                            throw new RuntimeException(e3);
                        &#125;
                    &#125; catch (NoSuchAlgorithmException e4) &#123;
                        throw new RuntimeException(e4);
                    &#125; catch (NoSuchPaddingException e5) &#123;
                        throw new RuntimeException(e5);
                    &#125;
                &#125;
                Toast.makeText(MainActivity.this.getApplicationContext(), &quot;Try again&quot;, 1).show();
            &#125;
        &#125;);
    &#125;
&#125;
</code></pre>
<p>å¯ä»¥çœ‹åˆ°åœ¨<strong>MainActivity</strong> ç±»ä¸­ï¼Œæœ‰ä¸€æ®µnativeåŠŸèƒ½å£°æ˜ï¼Œä½¿ç”¨nativeå…³é”®å­—å®šä¹‰äº†ä¸€ä¸ªnativeå‡½æ•°check_flagï¼Œè¯¥å‡½æ•°ä¸æ¥å—ä»»ä½•å‚æ•°ï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ªå‚æ•°ï¼Œç„¶åå°† a0x9 åº“åŠ è½½åˆ°ç¨‹åºä¸­ï¼ŒSystem.loadLibrary æ–¹æ³•æç¤ºæˆ‘ä»¬ a0x9 æ˜¯ native åº“æ–‡ä»¶ï¼Œcheck_flag å‡½æ•°åœ¨ a0x9 åº“ä¸­å®ç°ã€‚åŒæ—¶ï¼ŒMainActivity ç±»ä¸­è¿˜å®šä¹‰äº†ä¸€ä¸ª onClick æ–¹æ³•æ¥ç›‘æ§æŒ‰é’®çš„ç‚¹å‡»ï¼Œå½“ç‚¹å‡»åº”ç”¨ç¨‹åºæŒ‰é’®æ—¶ï¼ŒonClick æ–¹æ³•ä¼šå°† check_flag å‡½æ•°çš„è¿”å›å€¼ä¸1337è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå®ƒä»¬ç›¸ç­‰ï¼Œå°±ä¼šè§£å¯† flag å¹¶æ˜¾ç¤ºåœ¨åº”ç”¨ç¨‹åºç•Œé¢ã€‚å¦åˆ™ï¼Œæ‰“å°â€œTry againâ€ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ IDA æ¥åˆ†æ a0x9 åº“ä¸­çš„ check_flag å‡½æ•°ã€‚</p>
<pre><code class="language-java">public native int check_flag();

    static &#123;
        System.loadLibrary(&quot;a0x9&quot;);
    &#125;
</code></pre>
<pre><code class="language-java">public void onClick(View v) &#123;
if (MainActivity.this.check_flag() == 1337) &#123;
    try &#123;
        Cipher cipher = Cipher.getInstance(&quot;AES&quot;);
        SecretKeySpec secretKeySpec = new SecretKeySpec(&quot;3000300030003003&quot;.getBytes(), &quot;AES&quot;);
        try &#123;
            cipher.init(2, secretKeySpec);
            byte[] decryptedBytes = Base64.getDecoder().decode(&quot;hBCKKAqgxVhJMVTQS8JADelBUPUPyDiyO9dLSS3zho0=&quot;);
            try &#123;
                String decrypted = new String(cipher.doFinal(decryptedBytes));
                Toast.makeText(MainActivity.this.getApplicationContext(), &quot;You won &quot; + decrypted, 1).show();
                return;
            &#125; 
                ...
        &#125;
        Toast.makeText(MainActivity.this.getApplicationContext(), &quot;Try again&quot;, 1).show();
    &#125;
</code></pre>
<p>è¿˜æ˜¯ä¸€æ ·ï¼Œæ”¹ä¸€ä¸‹æ–‡ä»¶åç¼€åï¼Œç„¶åæ‰¾åˆ°liba0x9.soæ–‡ä»¶ï¼Œç„¶åç”¨ida64æ‰“å¼€ï¼Œæ‰¾åˆ°å¯¹åº”å‡½æ•°ï¼Œå‘ç°å•¥é€»è¾‘æ²¡ç”¨ï¼Œå°±æ˜¯ä¸€ä¸ªè¿”å›1ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/9768b234-8316-4ac0-abf7-27afb009f331.png" alt="9768b234-8316-4ac0-abf7-27afb009f331"></p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ Frida æ¡†æ¶ï¼Œç¼–å†™ä¸€ä¸ª JavaScript è„šæœ¬ï¼ŒHookåœ¨åº”ç”¨ç¨‹åºåŠ è½½çš„ liba0x9.so native åº“ä¸­è¿è¡Œçš„ check_flag å‡½æ•°ï¼Œå¹¶å°†å®ƒçš„è¿”å›å€¼æ›´æ”¹ä¸º1337ã€‚</p>
<p>é€šè¿‡å¯¹ APK é™æ€åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ check_flag å‡½æ•°åœ¨ liba0x9.so åº“ä¸­çš„åç§°æ˜¯Java_com_ad2001_a0x9_MainActivity_check_1flagï¼ŒåŒæ—¶å¯ä»¥åœ¨ liba0x9.so ä¸­çš„å¯¼å‡ºè¡¨ä¸­æ‰¾åˆ°è¯¥ç¬¦å·çš„åœ°å€ã€‚</p>
<p>ä»¥ä¸‹æ˜¯è„šæœ¬ï¼š</p>
<pre><code class="language-js">var check_flag = Module.findExportByName(&quot;liba0x9.so&quot;, &quot;Java_com_ad2001_a0x9_MainActivity_check_1flag&quot;)
// è·å–liba0x9.soåº“ä¸­Java_com_ad2001_a0x9_MainActivity_check_1flagå‡½æ•°åœ°å€ï¼Œå¹¶å°†å®ƒå‚¨å­˜åœ¨check_flagä¸­ã€‚

Interceptor.attach(check_flag, &#123;
  // Hook check_flagåœ°å€å¯¹åº”çš„å‡½æ•°ï¼Œå°†onEnterå’ŒonLeaveå›è°ƒå‡½æ•°é™„åŠ check_flagåœ°å€ä¸­
  onEnter: function () &#123;
    // åœ¨check_flagå‡½æ•°è¢«è°ƒç”¨ä¹‹å‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œæ ¹æ®éœ€è¦ä¿®æ”¹æˆ–è®°å½•å‚æ•°ã€‚

  &#125;,
  onLeave: function (retval) &#123;
    // åœ¨check_flagå‡½æ•°è¢«è°ƒç”¨ä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œå®ƒæä¾›å¯¹è¿”å›å€¼retvalçš„è®¿é—®ã€‚

    console.log(&quot;Original return value :&quot; + retval);
    // æ‰“å°å‡½æ•°åŸæœ¬è¿”å›å€¼

    retval.replace(1337)  
     // å°†check_flagå‡½æ•°è¿”å›å€¼ä¿®æ”¹ä¸º1337ã€‚
  &#125;
&#125;);
</code></pre>
<p>ç„¶åå…ˆè®©ç¨‹åºè¿è¡Œèµ·æ¥ï¼Œå†è¾“å…¥frida -U â€˜Frida 0x9â€™ -l F:\æ¡Œé¢\9.js</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/5125b7ab-1804-4952-a662-7e8f0851a167.png" alt="5125b7ab-1804-4952-a662-7e8f0851a167"></p>
<p>FRIDA{NATIVE_LAND_0x2}</p>
<p>å°±å¾—flagäº†ã€‚</p>
<p><strong>æ€»ç»“</strong>ï¼šFrida æ›´æ”¹nativeå‡½æ•°è¿”å›å€¼çš„è„šæœ¬æ¨¡æ¿</p>
<pre><code class="language-js">Interceptor.attach(targetAddress, &#123;
  // å°†å›è°ƒé™„åŠ åˆ°æŒ‡å®šçš„å‡½æ•°åœ°å€ï¼ŒtargetAddressä¸ºæˆ‘ä»¬æƒ³è¦æŒ‚é’©çš„nativeå‡½æ•°çš„åœ°å€ã€‚

  onEnter: function (args) &#123;
    // åœ¨ç›®æ ‡å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œæä¾›å¯¹å‡½æ•°å‚æ•°argsçš„è®¿é—®ã€‚

    console.log(&#39;Entering &#39; + functionName);
    // æ ¹æ®éœ€è¦ä¿®æ”¹æˆ–è®°å½•å‚æ•°
  &#125;,
  onLeave: function (retval) &#123;
    // åœ¨ç›®æ ‡å‡½æ•°è¢«è°ƒç”¨ä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œå®ƒæä¾›å¯¹è¿”å›å€¼retvalçš„è®¿é—®ã€‚

    console.log(&#39;Leaving &#39; + functionName);
    // æ ¹æ®éœ€è¦ä¿®æ”¹æˆ–è®°å½•å‚æ•°

    retval.replace(value)  
    // å°†ç›®æ ‡å‡½æ•°è¿”å›å€¼ä¿®æ”¹ä¸ºvalueã€‚
  &#125;
&#125;);
</code></pre>
<hr>
<h5 id="åäºŒ-Fridaç”¨æ³•ï¼ˆ10ï¼‰-jsè„šæœ¬è°ƒç”¨nativeå‡½æ•°"><a href="#åäºŒ-Fridaç”¨æ³•ï¼ˆ10ï¼‰-jsè„šæœ¬è°ƒç”¨nativeå‡½æ•°" class="headerlink" title="åäºŒ.Fridaç”¨æ³•ï¼ˆ10ï¼‰ .jsè„šæœ¬è°ƒç”¨nativeå‡½æ•°"></a>åäºŒ.Fridaç”¨æ³•ï¼ˆ10ï¼‰ .jsè„šæœ¬è°ƒç”¨nativeå‡½æ•°</h5><p>1.è¿˜æ˜¯ä¸€æ ·ï¼Œæ‹¿åˆ°apkæ–‡ä»¶ï¼Œå®‰è£…åˆ°æ¨¡æ‹Ÿå™¨ä¸Šï¼Œç»“æœå‘ç°åœ¨é›·ç”µæ¨¡æ‹Ÿå™¨ä¸Šå®‰è£…ä¸äº†ï¼Œç„¶åæ¢æˆå¤œç¥æ¨¡æ‹Ÿå™¨ï¼Œå¯ä»¥å®‰è£…ä½†æ˜¯ä¸å¯ä»¥è¿è¡Œï¼Œå°±å¾ˆå¥‡æ€ªäº†ã€‚(æ—¶éš”ä¸€å¹´ï¼Œæœ‰äº†çœŸæœºï¼Œé‡æ–°æ¥å®Œæˆè¿™é¢˜ï¼‰ã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/86be60ff-22b7-45ff-8bfe-60167c7e3bbe.png" alt="86be60ff-22b7-45ff-8bfe-60167c7e3bbe"></p>
<p>2.é‚£å°±ç”¨jadxæ‰“å¼€åˆ†æä¸€ä¸‹å‡½æ•°é€»è¾‘</p>
<pre><code class="language-Java">package com.ad2001.frida0xa;

import android.os.Bundle;
import androidx.appcompat.app.AppCompatActivity;
import androidx.constraintlayout.widget.ConstraintLayout;
import com.ad2001.frida0xa.databinding.ActivityMainBinding;
import kotlin.Metadata;
import kotlin.jvm.internal.DefaultConstructorMarker;
import kotlin.jvm.internal.Intrinsics;

/* compiled from: MainActivity.kt */
@Metadata(d1 = &#123;&quot;\u0000&amp;\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\b\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000e\n\u0002\b\u0002\u0018\u0000 \u000b2\u00020\u0001:\u0001\u000bB\u0005Â¢\u0006\u0002\u0010\u0002J\u0012\u0010\u0005\u001a\u00020\u00062\b\u0010\u0007\u001a\u0004\u0018\u00010\bH\u0014J\t\u0010\t\u001a\u00020\nH\u0086 R\u000e\u0010\u0003\u001a\u00020\u0004X\u0082.Â¢\u0006\u0002\n\u0000Â¨\u0006\f&quot;&#125;, d2 = &#123;&quot;Lcom/ad2001/frida0xa/MainActivity;&quot;, &quot;Landroidx/appcompat/app/AppCompatActivity;&quot;, &quot;()V&quot;, &quot;binding&quot;, &quot;Lcom/ad2001/frida0xa/databinding/ActivityMainBinding;&quot;, &quot;onCreate&quot;, &quot;&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;stringFromJNI&quot;, &quot;&quot;, &quot;Companion&quot;, &quot;app_debug&quot;&#125;, k = 1, mv = &#123;1, 8, 0&#125;, xi = ConstraintLayout.LayoutParams.Table.LAYOUT_CONSTRAINT_VERTICAL_CHAINSTYLE)
/* loaded from: classes4.dex */
public final class MainActivity extends AppCompatActivity &#123;
    public static final Companion Companion = new Companion(null);
    private ActivityMainBinding binding;

    public final native String stringFromJNI();

    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        ActivityMainBinding inflate = ActivityMainBinding.inflate(getLayoutInflater());
        Intrinsics.checkNotNullExpressionValue(inflate, &quot;inflate(layoutInflater)&quot;);
        this.binding = inflate;
        ActivityMainBinding activityMainBinding = null;
        if (inflate == null) &#123;
            Intrinsics.throwUninitializedPropertyAccessException(&quot;binding&quot;);
            inflate = null;
        &#125;
        setContentView(inflate.getRoot());
        ActivityMainBinding activityMainBinding2 = this.binding;
        if (activityMainBinding2 == null) &#123;
            Intrinsics.throwUninitializedPropertyAccessException(&quot;binding&quot;);
        &#125; else &#123;
            activityMainBinding = activityMainBinding2;
        &#125;
        activityMainBinding.sampleText.setText(stringFromJNI());
    &#125;

    /* compiled from: MainActivity.kt */
    @Metadata(d1 = &#123;&quot;\u0000\f\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0002\b\u0002\b\u0086\u0003\u0018\u00002\u00020\u0001B\u0007\b\u0002Â¢\u0006\u0002\u0010\u0002Â¨\u0006\u0003&quot;&#125;, d2 = &#123;&quot;Lcom/ad2001/frida0xa/MainActivity$Companion;&quot;, &quot;&quot;, &quot;()V&quot;, &quot;app_debug&quot;&#125;, k = 1, mv = &#123;1, 8, 0&#125;, xi = ConstraintLayout.LayoutParams.Table.LAYOUT_CONSTRAINT_VERTICAL_CHAINSTYLE)
    /* loaded from: classes4.dex */
    public static final class Companion &#123;
        public /* synthetic */ Companion(DefaultConstructorMarker defaultConstructorMarker) &#123;
            this();
        &#125;

        private Companion() &#123;
        &#125;
    &#125;

    static &#123;
        System.loadLibrary(&quot;frida0xa&quot;);
    &#125;
&#125;
</code></pre>
<p>å¯ä»¥çœ‹åˆ°åº”ç”¨ç¨‹åºçš„ MainActivityç±»ä¸­ï¼ŒåŒæ ·å£°æ˜äº†ä¸€æ®µnativeåŠŸèƒ½ï¼šåœ¨ç¨‹åºå¼€å§‹æ—¶å®šä¹‰äº†è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²ç±»å‹çš„ native å‡½æ•° stringFromJNIï¼Œå®ƒä¸æ¥å—ä»»ä½•å‚æ•°ï¼›åœ¨ç¨‹åºç»“å°¾å¤„åŠ è½½ frida0xa åŠ¨æ€é“¾æ¥åº“ï¼Œç”¨äºå®ç° native å‡½æ•°ã€‚MainActivity ç±»ä¸­è¿˜å®šä¹‰äº†onCreateæ–¹æ³•ï¼Œåœ¨ç¨‹åºåŠ è½½æ—¶è°ƒç”¨ stringFromJNI å‡½æ•°ï¼Œå°†å‡½æ•°è¿”å›çš„ â€œHello Hackersâ€æ–‡æœ¬è®¾ç½®ç»™ TextView æ§ä»¶ã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/73d70a10-c104-4c25-9830-2c19cf698775.png" alt="73d70a10-c104-4c25-9830-2c19cf698775"></p>
<p>3.æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ IDA å¯¹ frida0xa åŠ¨æ€é“¾æ¥åº“è¿›è¡Œåˆ†æã€‚</p>
<p>è¿˜æ˜¯ä¸€æ ·ï¼Œå…ˆæ”¹åç¼€åï¼Œç„¶åæ‰¾åˆ°libfrida0xa.soï¼Œç”¨ida64æ‰“å¼€ï¼Œå‘ç°å‡½æ•°çª—å£å¤„ä¸€å †å‡½æ•°ï¼Œå¹¶ä¸”æ˜¯ç”¨c++å†™çš„ï¼Œç›´æ¥åˆ©ç”¨æœç´¢åŠŸèƒ½æ‰¾åˆ°stringFromJNIå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°</p>
<pre><code class="language-c++">__int64 __fastcall Java_com_ad2001_frida0xa_MainActivity_stringFromJNI(_JNIEnv *a1)
&#123;
  const char *v1; // rsi
  __int64 v3; // [rsp+18h] [rbp-48h]
  char v4[24]; // [rsp+40h] [rbp-20h] BYREF
  unsigned __int64 v5; // [rsp+58h] [rbp-8h]

  v5 = __readfsqword(0x28u);
  std::string::basic_string&lt;decltype(nullptr)&gt;(v4, &quot;Hello Hackers&quot;);
  v1 = (const char *)sub_20690(v4);
  v3 = _JNIEnv::NewStringUTF(a1, v1);
  std::string::~string(v4);
  return v3;
&#125;
</code></pre>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å‘ç°äº†ä¸€ä¸ªå‡½æ•°ï¼Œget_flagå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æˆ‘ä»¬åœ¨Javaå±‚å¹¶æ²¡æœ‰çœ‹åˆ°æœ‰å¼•ç”¨ï¼Œ<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/a8f42294-b874-4ff2-b4a3-f6fac741ac4b.png" alt="a8f42294-b874-4ff2-b4a3-f6fac741ac4b"></p>
<p>é€»è¾‘å¾ˆç®€å•ï¼Œå¯ä»¥ç›´æ¥é€†ï¼Œä¹Ÿå¯ä»¥ç”¨Fridaæ¡†æ¶è¿›è¡Œè°ƒç”¨ï¼Œç„¶åç¨‹åºè‡ªè§£å¯†flagå¹¶è¾“å‡º</p>
<p>è¦ä½¿ç”¨ Frida è„šæœ¬è°ƒç”¨ native å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª NativePointer å¯¹è±¡ï¼Œå°†è¦è°ƒç”¨çš„ native å‡½æ•°åœ°å€ä¼ é€’ç»™ NativePointer æ„é€ å‡½æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª NativeFunction å¯¹è±¡ï¼Œæ¥è¡¨ç¤ºæˆ‘ä»¬è¦è°ƒç”¨çš„å®é™… native å‡½æ•°ã€‚NativeFunction å¯¹è±¡çš„ç¬¬ä¸€ä¸ªå‚æ•°åº”æ˜¯ NativePointer å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ native å‡½æ•°çš„è¿”å›ç±»å‹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¦ä¼ é€’ç»™ native å‡½æ•°å‚æ•°çš„æ•°æ®ç±»å‹åˆ—è¡¨ã€‚</p>
<blockquote>
<p>NativePointerï¼šæ˜¯ Frida ä¸­ä¸€ä¸ªè¡¨ç¤º native å†…å­˜åœ°å€çš„ JavaScript å¯¹è±¡ï¼Œå®ƒç”¨äºåœ¨ Frida è„šæœ¬ä¸­æ“ä½œå’Œè®¿é—® native å†…å­˜åœ°å€ï¼Œæ¯”å¦‚è¯»å–æˆ–å†™å…¥å†…å­˜ä¸­çš„æ•°æ®ï¼Œè°ƒç”¨å†…å­˜ä¸­çš„å‡½æ•°ç­‰ã€‚</p>
<p>NativeFunctionï¼šæ˜¯ Frida ä¸­ç”¨äºåœ¨ JavaScript ä¸­è°ƒç”¨ native å‡½æ•°çš„å¯¹è±¡ã€‚é€šè¿‡ NativeFunction å¯¹è±¡ï¼Œå¯ä»¥åœ¨ Frida è„šæœ¬ä¸­è°ƒç”¨ native å…±äº«åº“ï¼ˆå¦‚åŠ¨æ€é“¾æ¥åº“ï¼‰ä¸­çš„å‡½æ•°ï¼Œå®ç°å¯¹ native å‡½æ•°çš„è°ƒç”¨å’Œæ§åˆ¶ã€‚</p>
</blockquote>
<p>ä¸‹é¢å°±æ˜¯è„šæœ¬ï¼Œå…·ä½“get_flagå‡½æ•°çš„åœ°å€æ€ä¹ˆè·å–ä¹‹å‰æœ‰è®°å½•</p>
<pre><code class="language-js">function hook_function() &#123;
  var get_flagAddr = Module.findBaseAddress(&quot;libfrida0xa.so&quot;).add(0x1dd60);
  var get_flagPtr = new NativePointer(get_flagAddr);
  console.log(&quot;find the func&quot;);

  var get_flag = new NativeFunction(get_flagPtr, &quot;int&quot;, [&quot;int&quot;, &quot;int&quot;]);

  var res = get_flag(1, 2);
  console.log(res);
&#125;

setImmediate(function () &#123;
//   Java.perform(function () &#123;
    hook_function();
//   &#125;);
&#125;, 1000);
</code></pre>
<p>è¿è¡Œè„šæœ¬ã€‚<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250725163325106.png" alt="image-20250725163325106"></p>
<p>å¯ä»¥çœ‹åˆ°get_flagå‡½æ•°æˆåŠŸè¢«è°ƒç”¨å¹¶ä¸”è¿”å›äº†1ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æ—¥å¿—ä¸­æˆåŠŸè¾“å‡ºäº†ï¼Œæ‰“å¼€Android studioçœ‹æ—¥å¿—ï¼Œå°±å¯ä»¥æ‰¾åˆ°flag<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250725163428497.png" alt="image-20250725163428497"></p>
<p><strong>æ€»ç»“</strong>ï¼šFrida è°ƒç”¨ native å‡½æ•°è„šæœ¬æ¨¡æ¿</p>
<pre><code class="language-js">var native_adr = new NativePointer(&lt;address_of_the_native_function&gt;);
// åˆ›å»ºä¸€ä¸ª NativePointer å¯¹è±¡ï¼Œç”¨äºæ“ä½œå’Œè®¿é—® &lt;address_of_the_native_function&gt;å†…å­˜åœ°å€ã€‚

const native_function = new NativeFunction(native_adr, &#39;&lt;return type&gt;&#39;, [&#39;argument_data_type&#39;]);
// åˆ›å»ºä¸€ä¸ª NativeFunction å¯¹è±¡ï¼Œå®ç°å¯¹ native å‡½æ•°çš„è°ƒç”¨å’Œæ§åˆ¶ã€‚
// native_adrï¼šä½¿ç”¨native_adr NativePointerå¯¹è±¡ï¼›
// &#39;&lt;return type&gt;&#39;ï¼šå‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼›
// [&#39;argument_data_type&#39;]ï¼šä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ç±»å‹åˆ—è¡¨ã€‚

native_function(&lt;arguments&gt;);
// è°ƒç”¨ native_function å‡½æ•°ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ä¼ é€’&lt;arguments&gt;å‚æ•°ã€‚
</code></pre>
<hr>
<h5 id="åä¸‰-Fridaç”¨æ³•ï¼ˆ11ï¼‰-jsè„šæœ¬-ä½¿ç”¨ARM64Writerä¿®æ”¹æŒ‡ä»¤"><a href="#åä¸‰-Fridaç”¨æ³•ï¼ˆ11ï¼‰-jsè„šæœ¬-ä½¿ç”¨ARM64Writerä¿®æ”¹æŒ‡ä»¤" class="headerlink" title="åä¸‰.Fridaç”¨æ³•ï¼ˆ11ï¼‰ .jsè„šæœ¬ ä½¿ç”¨ARM64Writerä¿®æ”¹æŒ‡ä»¤"></a>åä¸‰.Fridaç”¨æ³•ï¼ˆ11ï¼‰ .jsè„šæœ¬ ä½¿ç”¨ARM64Writerä¿®æ”¹æŒ‡ä»¤</h5><p>1.è¿™ä¸ªé¢˜å’Œä¸Šä¸€ä¸ªé¢˜ä¸€æ ·ï¼Œè¿˜æ˜¯åœ¨é›·ç”µæ¨¡æ‹Ÿå™¨ä¸Šå®‰è£…ä¸äº†ï¼Œç„¶ååœ¨å¤œç¥æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œä¸äº†ï¼Œå¾ˆè‹¦æ¼ï¼Œé‚£å°±åªèƒ½å­¦æ€ç»´å’Œæ“ä½œæ–¹æ³•äº†ã€‚(æ—¶éš”ä¸€å¹´ï¼Œå›æ¥ç»§ç»­å†™ï¼Œhhhh)</p>
<p>2.ç”¨jadxåç¼–è¯‘çœ‹çœ‹å‡½æ•°é€»è¾‘</p>
<pre><code class="language-java">package com.ad2001.frida0xb;

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import androidx.appcompat.app.AppCompatActivity;
import androidx.constraintlayout.widget.ConstraintLayout;
import com.ad2001.frida0xb.databinding.ActivityMainBinding;
import kotlin.Metadata;
import kotlin.jvm.internal.DefaultConstructorMarker;
import kotlin.jvm.internal.Intrinsics;

/* compiled from: MainActivity.kt */
@Metadata(d1 = &#123;&quot;\u0000\&quot;\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\b\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u0002\n\u0002\b\u0002\n\u0002\u0018\u0002\n\u0002\b\u0002\u0018\u0000 \n2\u00020\u0001:\u0001\nB\u0005Â¢\u0006\u0002\u0010\u0002J\t\u0010\u0005\u001a\u00020\u0006H\u0086 J\u0012\u0010\u0007\u001a\u00020\u00062\b\u0010\b\u001a\u0004\u0018\u00010\tH\u0014R\u000e\u0010\u0003\u001a\u00020\u0004X\u0082.Â¢\u0006\u0002\n\u0000Â¨\u0006\u000b&quot;&#125;, d2 = &#123;&quot;Lcom/ad2001/frida0xb/MainActivity;&quot;, &quot;Landroidx/appcompat/app/AppCompatActivity;&quot;, &quot;()V&quot;, &quot;binding&quot;, &quot;Lcom/ad2001/frida0xb/databinding/ActivityMainBinding;&quot;, &quot;getFlag&quot;, &quot;&quot;, &quot;onCreate&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;Companion&quot;, &quot;app_debug&quot;&#125;, k = 1, mv = &#123;1, 8, 0&#125;, xi = ConstraintLayout.LayoutParams.Table.LAYOUT_CONSTRAINT_VERTICAL_CHAINSTYLE)
/* loaded from: classes3.dex */
public final class MainActivity extends AppCompatActivity &#123;
    public static final Companion Companion = new Companion(null);
    private ActivityMainBinding binding;

    public final native void getFlag();

    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        ActivityMainBinding inflate = ActivityMainBinding.inflate(getLayoutInflater());
        Intrinsics.checkNotNullExpressionValue(inflate, &quot;inflate(layoutInflater)&quot;);
        this.binding = inflate;
        if (inflate == null) &#123;
            Intrinsics.throwUninitializedPropertyAccessException(&quot;binding&quot;);
            inflate = null;
        &#125;
        setContentView(inflate.getRoot());
        View findViewById = findViewById(R.id.button);
        Intrinsics.checkNotNullExpressionValue(findViewById, &quot;findViewById(R.id.button)&quot;);
        Button btn = (Button) findViewById;
        btn.setOnClickListener(new View.OnClickListener() &#123; // from class: com.ad2001.frida0xb.MainActivity$$ExternalSyntheticLambda0
            @Override // android.view.View.OnClickListener
            public final void onClick(View view) &#123;
                MainActivity.onCreate$lambda$0(MainActivity.this, view);
            &#125;
        &#125;);
    &#125;

    /* JADX INFO: Access modifiers changed from: private */
    public static final void onCreate$lambda$0(MainActivity this$0, View it) &#123;
        Intrinsics.checkNotNullParameter(this$0, &quot;this$0&quot;);
        this$0.getFlag();
    &#125;

    /* compiled from: MainActivity.kt */
    @Metadata(d1 = &#123;&quot;\u0000\f\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0002\b\u0002\b\u0086\u0003\u0018\u00002\u00020\u0001B\u0007\b\u0002Â¢\u0006\u0002\u0010\u0002Â¨\u0006\u0003&quot;&#125;, d2 = &#123;&quot;Lcom/ad2001/frida0xb/MainActivity$Companion;&quot;, &quot;&quot;, &quot;()V&quot;, &quot;app_debug&quot;&#125;, k = 1, mv = &#123;1, 8, 0&#125;, xi = ConstraintLayout.LayoutParams.Table.LAYOUT_CONSTRAINT_VERTICAL_CHAINSTYLE)
    /* loaded from: classes3.dex */
    public static final class Companion &#123;
        public /* synthetic */ Companion(DefaultConstructorMarker defaultConstructorMarker) &#123;
            this();
        &#125;

        private Companion() &#123;
        &#125;
    &#125;

    static &#123;
        System.loadLibrary(&quot;frida0xb&quot;);
    &#125;
&#125;
</code></pre>
<p>å¯ä»¥çœ‹åˆ°åœ¨åº”ç”¨ç¨‹åºçš„ MainActivity ç±»ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª native å‡½æ•° getFlagï¼Œè¯¥å‡½æ•°ä¸æ¥å—ä»»ä½•å‚æ•°ä¹Ÿæ²¡æœ‰è¿”å›å€¼ï¼Œå¹¶åœ¨ç¨‹åºç»“å°¾å¤„ä½¿ç”¨ System.loadLibrary å‡½æ•°åŠ è½½ frida0xb åŠ¨æ€é“¾æ¥åº“ã€‚MainActivity ç±»ä¸­å®šä¹‰çš„ onCreate æ–¹æ³•ç›‘å¬æŒ‰é’®çš„ç‚¹å‡»ï¼Œç‚¹å‡»æŒ‰é’®æ—¶ä¼šé€šè¿‡ lambda è¡¨è¾¾å¼è°ƒç”¨ onCreate$lambda$0 æ–¹æ³•ï¼Œç„¶ååœ¨onCreate$lambda$0 æ–¹æ³•ä¸­è°ƒç”¨ getFlag å‡½æ•°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ IDA å¯¹ frida0xb åŠ¨æ€é“¾æ¥åº“è¿›è¡Œåˆ†æï¼ŒæŸ¥çœ‹ getFlag å‡½æ•°æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p>
<p>è·å–.soæ–‡ä»¶çš„æ–¹æ³•è¿˜æ˜¯ä¸€æ ·ï¼Œæ”¹ä¸€ä¸‹åç¼€åï¼Œç„¶åæ‰¾åˆ°å¯¹åº”çš„.soæ–‡ä»¶ï¼Œç”¨ida64æ‰“å¼€ï¼Œæ‰¾åˆ°å‡½æ•°ï¼Œå‘ç°idaåç¼–è¯‘å‡ºæ¥çš„ä¼ªä»£ç ä¸¥é‡ä¸å®Œæ•´</p>
<p>è¿™æ˜¯åç¼–è¯‘çš„<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/c1c99ce8-dd3c-45e7-972d-420bc723bb6b.png" alt="c1c99ce8-dd3c-45e7-972d-420bc723bb6b"></p>
<p>è¿™æ˜¯æ±‡ç¼–</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/b7f9b83b-82c3-4020-8214-7e21221cd822.png" alt="b7f9b83b-82c3-4020-8214-7e21221cd822"></p>
<p>æˆ‘ä»¬å›åˆ°æµç¨‹æ§åˆ¶çª—å£ä¸­æŸ¥çœ‹ã€‚å¯ä»¥çœ‹åˆ°ç¨‹åºä¸­å‡ºç°æ°¸è¿œä¸ºå‡çš„æ¡ä»¶è·³è½¬ï¼Œå¯¼è‡´ IDA è¯†åˆ«ä¸åˆ°è§£å¯† flag å¹¶è¾“å‡ºçš„ä»£ç æŒ‡ä»¤<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/c8c51492-2225-42d3-a08c-fb511b6314c6.png" alt="c8c51492-2225-42d3-a08c-fb511b6314c6"></p>
<p>ç„¶åä¸€è·³è½¬å°±æ²¡äº†ã€‚</p>
<p>åˆ†æå®Œä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç¨‹åºåœ¨ç‚¹å‡»æŒ‰é’®æ—¶è°ƒç”¨äº† getFlag å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨ native ä»£ç å®ç°è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªæ°¸ä¹…ä¸ºå‡çš„æ¡ä»¶è·³è½¬ï¼Œå¯¼è‡´è§£å¯† flag å¹¶è¾“å‡ºçš„ä»£ç å—æœªè¢«æ‰§è¡Œã€‚ä¸ºäº†è·å–è¿™ä¸ª flag ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ Frida è„šæœ¬ï¼Œä¿®æ”¹jnzï¼ˆè·³è½¬åˆ°ç¨‹åºç»“å°¾ï¼‰è¿™æ¡æŒ‡ä»¤ï¼Œè®©å®ƒä¸æ‰§è¡Œï¼Œä»¥ç»•è¿‡æ¡ä»¶è·³è½¬æ¥æ‰§è¡Œè§£ç å’Œè¾“å‡º flag çš„ç¨‹åºã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä½¿ç”¨Frida æ¡†æ¶ï¼Œç¼–å†™ä¸€ä¸ª JavaScript è„šæœ¬ï¼Œå°† native å‡½æ•° getFlag ä¸­çš„ B.NE ï¼ˆæ¡ä»¶åˆ†æ”¯è·³è½¬æŒ‡ä»¤ï¼‰ä¿®æ”¹ä¸º Nopï¼ˆç©ºæ“ä½œæŒ‡ä»¤ï¼‰ï¼Œåœ¨Fridaä¸­ä¿®æ”¹æ±‡ç¼–æŒ‡ä»¤éœ€è¦ä½¿ç”¨ARM64Writer ç±»ã€‚</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/fbfa387f-184f-4213-8b0b-f0095d0bf4c3.png" alt="fbfa387f-184f-4213-8b0b-f0095d0bf4c3"></p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ B.NE æŒ‡ä»¤çš„åœ°å€ï¼Œè¯¥åœ°å€åŒæ ·å¯ä»¥é€šè¿‡Module.getBaseAddress API å¾—åˆ° frida0xb åº“çš„åŸºåœ°å€ï¼Œå†åŠ ä¸Š B.NE æŒ‡ä»¤çš„åç§»é‡æ¥è·å–ã€‚æˆ‘ä»¬å¯ä»¥åœ¨IDAä¸­æŸ¥çœ‹ B.NE æŒ‡ä»¤åœ°å€çš„åç§»é‡ä¸ºâ€0x170CEâ€³ã€‚ç„¶ååˆ›å»ºä¸€ä¸ª ARM64Writer ç±»çš„å®ä¾‹ï¼Œå°†è·å–åˆ°çš„ B.NE æŒ‡ä»¤çš„åœ°å€ä½œä¸ºä¼ å…¥å‚æ•°ï¼Œå†è°ƒç”¨ ARM64Writer å®ä¾‹çš„ putNop æ–¹æ³•åœ¨ B.NE æŒ‡ä»¤çš„åœ°å€ä¸Šå†™å…¥ä¸€æ¡ Nop æŒ‡ä»¤ï¼Œè¦†ç›–æ‰åŸæ¥çš„æŒ‡ä»¤ã€‚æ¥ç€è°ƒç”¨ ARM64Writer å®ä¾‹çš„ flush æ–¹æ³•å°†ä¿®æ”¹åçš„æŒ‡ä»¤å†™å…¥å†…å­˜ä¸­ã€‚<img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/14ee1b95-145b-4648-b0b9-c6ed99e9f2ec.png" alt="14ee1b95-145b-4648-b0b9-c6ed99e9f2ec"></p>
<p>ä¸ºäº†ç»•è¿‡åº”ç”¨ç¨‹åºä¸­çš„å†…å­˜åˆ†é¡µä¿æŠ¤æœºåˆ¶ï¼ŒæˆåŠŸä¿®æ”¹å¹¶è¿è¡Œ native ä»£ç ä¸­çš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨ Frida ä¸­çš„ Memory.protect å‡½æ•°ï¼Œå°†æŒ‡å®šå†…å­˜åŒºåŸŸçš„ä¿æŠ¤å±æ€§ä¿®æ”¹ä¸ºâ€rwxâ€ï¼ˆå¯è¯»å¯å†™å¯æ‰§è¡Œï¼‰ã€‚</p>
<blockquote>
<p>åœ¨Fridaä¸­ï¼ŒMemory.protect å‡½æ•°ç”¨äºä¿®æ”¹å†…å­˜é¡µçš„ä¿æŠ¤å±æ€§ï¼Œä»¥æ§åˆ¶å¯¹å†…å­˜çš„è®¿é—®æƒé™ã€‚è¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥ä¿®æ”¹ç›®æ ‡è¿›ç¨‹ä¸­çš„å†…å­˜é¡µï¼Œä¾‹å¦‚å°†å†…å­˜é¡µè®¾ç½®ä¸ºå¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œç­‰ã€‚Memory.protect å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š  </p>
<p>Â  Â Memory.protect(ptr, size, protection)</p>
<ul>
<li><p>ptr: è¡¨ç¤ºè¦ä¿®æ”¹ä¿æŠ¤å±æ€§çš„å†…å­˜åœ°å€ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªæŒ‡å‘ç›®æ ‡å†…å­˜åŒºåŸŸçš„æŒ‡é’ˆã€‚</p>
</li>
<li><p>size: è¡¨ç¤ºè¦ä¿®æ”¹ä¿æŠ¤å±æ€§çš„å†…å­˜åŒºåŸŸçš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚</p>
</li>
<li><p>protection: è¡¨ç¤ºè¦è®¾ç½®çš„å†…å­˜ä¿æŠ¤å±æ€§ã€‚</p>
</li>
</ul>
</blockquote>
<p>è„šæœ¬å¦‚ä¸‹</p>
<pre><code class="language-js">var jnz_adr =  Module.getBaseAddress(&quot;libfrida0xb.so&quot;).add(0x170CE);
//è·å– jnz æŒ‡ä»¤åœ°å€ã€‚

Memory.protect(jnz_adr,0x1000,&quot;rwx&quot;);
// å°†å¯¹åº”å†…å­˜åŒºåŸŸçš„ä¿æŠ¤å±æ€§ä¿®æ”¹ä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œã€‚

var writer = new Arm64Writer(jnz_adr);
// åˆ›å»º ARM64Writer ç±»çš„å®ä¾‹ writerï¼Œå°† jnz_adr ä½œä¸ºå†™å…¥çš„å†…å­˜åœ°å€ã€‚

try&#123;
  writer.putNop();
  // åœ¨åŸæœ¬ jnz æŒ‡ä»¤çš„åœ°å€ä¸Šå†™å…¥ä¸€æ¡ Nop æŒ‡ä»¤ï¼Œæ›¿æ¢åŸæœ¬çš„ jnz æŒ‡ä»¤

  writer.flush();
  // å°†ä¿®æ”¹åçš„æŒ‡ä»¤å†™å…¥å†…å­˜ä¸­

  console.log(&quot;Command modification successful.&quot;);
  // æŒ‡ä»¤ä¿®æ”¹å®Œæˆåæ‰“å°ä¸€æ¡æç¤ºè¯­ã€‚

&#125;finally &#123;
  writer.dispose();
  // é‡Šæ”¾ä¸ writer å®ä¾‹å…³è”çš„èµ„æºã€‚
&#125;
</code></pre>
<p>è„šæœ¬è¿˜æ˜¯ä¸Šé¢çš„è„šæœ¬ï¼Œè¿è¡Œä¸€ä¸‹å°±è¡Œäº†ï¼›ä½†æ˜¯è¿™é¢˜åº”è¯¥è¿˜å¯ä»¥ç›´æ¥è¯¥æŒ‡ä»¤ï¼Œç„¶åé‡æ–°æ‰“åŒ…ä¸€ä¸‹è§£å†³çš„</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250725165131171.png" alt="image-20250725165131171"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250725165616883.png" alt="image-20250725165616883"></p>
<p>å®Œäº†patchä¸€ä¸‹ï¼Œæ¥ç€ç”¨mtç®¡ç†å™¨é‡æ–°ç­¾åæ‰“åŒ…ä¸€ä¸‹</p>
<p>ç„¶åå®‰è£…ç›´æ¥è¿è¡Œï¼Œå°±å¯ä»¥åœ¨Android studioä¸­æ‰¾</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250725165813894.png" alt="image-20250725165813894"></p>
<p><strong>æ€»ç»“</strong>ï¼šFridaä½¿ç”¨ARM64Writerä¿®æ”¹æŒ‡ä»¤çš„è„šæœ¬æ¨¡æ¿</p>
<pre><code class="language-js">var writer = new ARM64Writer(&lt;address_of_the_instruction&gt;);
// åˆ›å»ºä¸€ä¸ªArm64Writerç±»å®ä¾‹ï¼Œç”¨äºç¼–å†™ARM64æŒ‡ä»¤ï¼ŒcodeAddressæ˜¯è¦å†™å…¥çš„å†…å­˜åœ°å€ã€‚

try &#123;
  /*
  æˆ‘ä»¬è‡ªå·±çš„æŒ‡ä»¤å®ç°
  */

  writer.flush();
  // å°†ä¿®æ”¹åçš„æŒ‡ä»¤å†™å…¥å†…å­˜ä¸­

&#125; finally &#123;
  writer.dispose();
  // é‡Šæ”¾ä¸ ARM64Writer å®ä¾‹å…³è”çš„èµ„æºã€‚
&#125;
</code></pre>
<h5 id="åå››-Android-JAVAå±‚rootæ£€æµ‹ç»•è¿‡"><a href="#åå››-Android-JAVAå±‚rootæ£€æµ‹ç»•è¿‡" class="headerlink" title="åå››.Android JAVAå±‚rootæ£€æµ‹ç»•è¿‡"></a>åå››.Android JAVAå±‚rootæ£€æµ‹ç»•è¿‡</h5><p>å½“çœ‹åˆ°ç±»ä¼¼ä»£ç æ£€æµ‹</p>
<pre><code class="language-java">    protected void onCreate(Bundle bundle) &#123;
        if (c.a() || c.b() || c.c()) &#123;
            a(&quot;Root detected!&quot;);
        &#125;
        if (b.a(getApplicationContext())) &#123;
            a(&quot;App is debuggable!&quot;);
        &#125;
        super.onCreate(bundle);
        setContentView(R.layout.activity_main);
    &#125;
</code></pre>
<pre><code class="language-java">package sg.vantagepoint.a;

import android.os.Build;
import java.io.File;

/* loaded from: classes.dex */
public class c &#123;
    public static boolean a() &#123;
        for (String str : System.getenv(&quot;PATH&quot;).split(&quot;:&quot;)) &#123;
            if (new File(str, &quot;su&quot;).exists()) &#123;
                return true;
            &#125;
        &#125;
        return false;
    &#125;

    public static boolean b() &#123;
        String str = Build.TAGS;
        return str != null &amp;&amp; str.contains(&quot;test-keys&quot;);
    &#125;

    public static boolean c() &#123;
        for (String str : new String[]&#123;&quot;/system/app/Superuser.apk&quot;, &quot;/system/xbin/daemonsu&quot;, &quot;/system/etc/init.d/99SuperSUDaemon&quot;, &quot;/system/bin/.ext/.su&quot;, &quot;/system/etc/.has_su_daemon&quot;, &quot;/system/etc/.installed_su_daemon&quot;, &quot;/dev/com.koushikdutta.superuser.daemon/&quot;&#125;) &#123;
            if (new File(str).exists()) &#123;
                return true;
            &#125;
        &#125;
        return false;
    &#125;
&#125;
</code></pre>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™frida-hookè„šæœ¬ï¼Œä½¿å¾—å…¶æ£€æµ‹å‡½æ•°è¿”å›falseï¼Œå°±å¯ä»¥æ­£å¸¸åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œã€‚</p>
<pre><code class="language-java">setImmediate(function () &#123;
    console.log(&quot;[*] Starting script&quot;);

    Java.perform(function () &#123;
        let c = Java.use(&quot;sg.vantagepoint.a.c&quot;);
        c[&quot;a&quot;].implementation = function () &#123;
            return false;
        &#125;;

        c[&quot;b&quot;].implementation = function () &#123;
            return false;
        &#125;;

        c[&quot;c&quot;].implementation = function () &#123;

            return false;
        &#125;;

    &#125;);
&#125;)
</code></pre>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 1621925986@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">ğŸ’°</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23lif2sndX4YqUPQwk',
            clientSecret: 'c76a4c487d51bf36e4dd1496b3f44bdbea037d50',
            repo: 'NshIdE1.github.io',
            owner: 'NshIdE1',
            admin: ['NshIdE1'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2024-2025 NshIdE
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">Ã—</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="æ‰«ç æ”¯æŒ">
            <img src="/img/weixin.jpg" class="weixin" title="æ‰«ç æ”¯æŒ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    

    
</style>







</html>
