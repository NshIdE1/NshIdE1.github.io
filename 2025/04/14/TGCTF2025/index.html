<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>TGCTF2025 RE | NshIdE&#39;s Home</title>
  <meta name="keywords" content=" CTF , RE , WritesUp ">
  <meta name="description" content="TGCTF2025 RE | NshIdE&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="tags">
<meta property="og:url" content="https://nshide1.github.io/tags/">
<meta property="og:site_name" content="NshIdE&#39;s Home">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-03-04T12:20:04.979Z">
<meta property="article:modified_time" content="2025-03-04T12:20:04.979Z">
<meta property="article:author" content="NshIdE">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/logo.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/logo.jpg"/>
</a>
<div class="author">
    <span>NshIdE</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/NshIdE1/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://www.csdn.net/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=1621925986&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(40)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="其他">
            
            其他
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Android-RE">
            
            Android-RE
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Android学习">
            
            Android学习
            <small>(9)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Angr入门">
            
            Angr入门
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="CTF">
            
            CTF
            <small>(15)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Frida入门">
            
            Frida入门
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Java学习">
            
            Java学习
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Unidbg学习">
            
            Unidbg学习
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="40">
<input type="hidden" id="yelog_site_word_count" value="221.9k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://bananashipsbbq.github.io/">bananaships</a></li>
            
            <li><a target="_blank" href="https://astralprisma.github.io/">AstralPrisma</a></li>
            
            <li><a target="_blank" href="https://monoceros406.github.io/">Monoceros406</a></li>
            
            <li><a target="_blank" href="https://github.com/Thir0th">Thir0th</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>抽象</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>符号执行</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>取证</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>应急响应</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Frida</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>go</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Harmony</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>il2Cpps</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>iOS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ISW</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SIMD</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unidbg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unity</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>WritesUp</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All CTF "
           href="/2025/10/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%BC%BA%E7%BD%91%C2%B7%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android,il2Cpps"
           data-author="" >
            <span class="post-title" title="第八届强网·拟态防御国际精英挑战赛">第八届强网·拟态防御国际精英挑战赛</span>
            <span class="post-date" title="2025-10-25 17:31:37">2025/10/25</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/10/22/Android%20APP%20%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android APP 常见漏洞">Android APP 常见漏洞</span>
            <span class="post-date" title="2025-10-22 17:06:07">2025/10/22</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/10/10/%E4%BB%8E%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20PackageInfo%20%E5%92%8C%20LoadedApk/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="从源码分析 PackageInfo 和 LoadedApk">从源码分析 PackageInfo 和 LoadedApk</span>
            <span class="post-date" title="2025-10-10 18:15:17">2025/10/10</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/09/09/2025%E5%B9%B4%E6%B9%BE%E5%8C%BA%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%88%9D%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025年湾区杯网络安全大赛初赛">2025年湾区杯网络安全大赛初赛</span>
            <span class="post-date" title="2025-09-09 09:34:17">2025/09/09</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/09/08/Android%20SO%20%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android SO 文件加载过程">Android SO 文件加载过程</span>
            <span class="post-date" title="2025-09-08 17:18:50">2025/09/08</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/25/Dex%20%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Dex 文件结构学习">Dex 文件结构学习</span>
            <span class="post-date" title="2025-08-25 17:33:29">2025/08/25</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/19/ClassLoader%20%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="ClassLoader 机制">ClassLoader 机制</span>
            <span class="post-date" title="2025-08-19 17:42:51">2025/08/19</span>
        </a>
        
        
        <a  class="All Java学习 "
           href="/2025/08/19/Java%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="Java学习----反射机制">Java学习----反射机制</span>
            <span class="post-date" title="2025-08-19 17:00:02">2025/08/19</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/19/Android%20%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android 应用启动流程">Android 应用启动流程</span>
            <span class="post-date" title="2025-08-19 11:14:13">2025/08/19</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/19/%E5%AE%89%E5%8D%93%E5%8A%A0%E5%9B%BA%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="安卓加固学习记录">安卓加固学习记录</span>
            <span class="post-date" title="2025-08-19 10:50:46">2025/08/19</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/14/Android%20%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94NDK%20%E5%BC%80%E5%8F%91/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android 开发--NDK 开发">Android 开发--NDK 开发</span>
            <span class="post-date" title="2025-08-14 17:56:58">2025/08/14</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/08/10/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%85%AD)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(六)">从实践中学习unidbg使用(六)</span>
            <span class="post-date" title="2025-08-10 10:25:02">2025/08/10</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/08/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%94)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(五)">从实践中学习unidbg使用(五)</span>
            <span class="post-date" title="2025-08-08 17:45:59">2025/08/08</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/05/%E6%BC%AB%E8%B0%88%E5%94%AF%E4%B8%80%E8%AE%BE%E5%A4%87ID/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="漫谈唯一设备 ID">漫谈唯一设备 ID</span>
            <span class="post-date" title="2025-08-05 18:00:44">2025/08/05</span>
        </a>
        
        
        <a  class="All 其他 "
           href="/2025/07/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20Linux%20%E7%B3%BB%E7%BB%9F%E4%B8%8B%20proc%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"
           data-tag="Android,Linux"
           data-author="" >
            <span class="post-title" title="浅谈 Linux 系统下 proc 文件系统内容">浅谈 Linux 系统下 proc 文件系统内容</span>
            <span class="post-date" title="2025-07-24 17:56:57">2025/07/24</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/24/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%BA%8C%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg 中处理文件访问(二)">Unidbg 中处理文件访问(二)</span>
            <span class="post-date" title="2025-07-24 17:00:12">2025/07/24</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/07/23/2025%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B-%E5%88%9D%E8%B5%9B-%E5%AE%89%E5%8D%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E5%85%A8/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025第十届游戏安全竞赛-初赛-安卓客户端安全">2025第十届游戏安全竞赛-初赛-安卓客户端安全</span>
            <span class="post-date" title="2025-07-23 15:32:11">2025/07/23</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/19/%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%92%8C%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="创建模拟器和加载模块">创建模拟器和加载模块</span>
            <span class="post-date" title="2025-07-19 15:14:29">2025/07/19</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/15/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%B8%80%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg 中处理文件访问(一)">Unidbg 中处理文件访问(一)</span>
            <span class="post-date" title="2025-07-15 16:52:06">2025/07/15</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%9B%9B)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(四)">从实践中学习unidbg使用(四)</span>
            <span class="post-date" title="2025-07-08 11:44:49">2025/07/08</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/01/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%89)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(三)">从实践中学习unidbg使用(三)</span>
            <span class="post-date" title="2025-07-01 15:29:42">2025/07/01</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/06/07/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmonyCTF/"
           data-tag="CTF,RE,WritesUp,Harmony"
           data-author="" >
            <span class="post-title" title="第一届OpenHarmonyCTF">第一届OpenHarmonyCTF</span>
            <span class="post-date" title="2025-06-07 13:32:45">2025/06/07</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/06/04/%E8%A1%A5%E5%BA%93%E5%87%BD%E6%95%B0%EF%BC%88%E4%BA%94%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="补库函数(五)">补库函数(五)</span>
            <span class="post-date" title="2025-06-04 19:07:56">2025/06/04</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/06/02/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%8C)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(二)">从实践中学习unidbg使用(二)</span>
            <span class="post-date" title="2025-06-02 15:33:15">2025/06/02</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/31/D%5E3CTF2025/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="D^3CTF2025">D^3CTF2025</span>
            <span class="post-date" title="2025-05-31 16:21:11">2025/05/31</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/05/28/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%80)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(一)">从实践中学习unidbg使用(一)</span>
            <span class="post-date" title="2025-05-28 16:39:23">2025/05/28</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/17/Parloo2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="Parloo RE">Parloo RE</span>
            <span class="post-date" title="2025-05-17 09:34:20">2025/05/17</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/05/07/%E8%AE%B0%E4%B8%80%E6%AC%A1APK%E5%88%86%E6%9E%90/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="记一次APK分析">记一次APK分析</span>
            <span class="post-date" title="2025-05-07 21:12:00">2025/05/07</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/26/%E4%B8%80%E9%81%93%E5%BE%88%E9%80%86%E5%A4%A9%E7%9A%84RC4/"
           data-tag="CTF,RE,WritesUp,抽象"
           data-author="" >
            <span class="post-title" title="抽象RC4">抽象RC4</span>
            <span class="post-date" title="2025-04-26 22:21:19">2025/04/26</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/24/%E5%BE%88%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="很有意思的一道题">很有意思的一道题</span>
            <span class="post-date" title="2025-04-24 21:56:18">2025/04/24</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/23/%E4%BA%AC%E9%BA%92CTF2025%20%E7%83%AD%E8%BA%AB%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,iOS,SIMD"
           data-author="" >
            <span class="post-title" title="京麒CTF2025热身赛">京麒CTF2025热身赛</span>
            <span class="post-date" title="2025-04-23 13:33:59">2025/04/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/14/TGCTF2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TGCTF2025 RE">TGCTF2025 RE</span>
            <span class="post-date" title="2025-04-14 18:51:29">2025/04/14</span>
        </a>
        
        
        <a  class="All Angr入门 "
           href="/2025/04/14/Angr%E5%85%A5%E9%97%A8/"
           data-tag="符号执行"
           data-author="" >
            <span class="post-title" title="Angr入门">Angr入门</span>
            <span class="post-date" title="2025-04-14 18:50:44">2025/04/14</span>
        </a>
        
        
        <a  class="All Frida入门 "
           href="/2025/04/14/Frida%E5%85%A5%E9%97%A8/"
           data-tag="Android,Frida"
           data-author="" >
            <span class="post-title" title="Frida入门">Frida入门</span>
            <span class="post-date" title="2025-04-14 18:47:37">2025/04/14</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/12/TEXSAWCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TEXSAWCTF 2025">TEXSAWCTF 2025</span>
            <span class="post-date" title="2025-04-12 15:32:31">2025/04/12</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/23/NCTF2024/"
           data-tag="CTF,RE,WritesUp,vm,go"
           data-author="" >
            <span class="post-title" title="NCTF2024">NCTF2024</span>
            <span class="post-date" title="2025-03-23 11:58:53">2025/03/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/18/CISCN%20x%20CCB%20%E5%8D%8A%E5%86%B3%E8%B5%9B%202025%20ISW(%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94)/"
           data-tag="ISW,应急响应,取证"
           data-author="" >
            <span class="post-title" title="CISCN x CCB 半决赛 2025 ISW(应急响应)">CISCN x CCB 半决赛 2025 ISW(应急响应)</span>
            <span class="post-date" title="2025-03-18 10:24:23">2025/03/18</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/11/TPCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TPCTF 2025">TPCTF 2025</span>
            <span class="post-date" title="2025-03-11 21:41:19">2025/03/11</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/06/VishwaCTF2025/"
           data-tag="CTF,RE,WritesUp,Android,Unity"
           data-author="" >
            <span class="post-title" title="VishwaCTF2025">VishwaCTF2025</span>
            <span class="post-date" title="2025-03-06 21:52:51">2025/03/06</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/03/HGAME%20RE/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="HGAME-RE-WEEK1">HGAME-RE-WEEK1</span>
            <span class="post-date" title="2025-03-03 22:20:33">2025/03/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-TGCTF2025" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">TGCTF2025 RE</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="CTF">CTF</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color4">CTF</a>
            
            <a class="color3">RE</a>
            
            <a class="color4">WritesUp</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-05-22 18:59:35'>2025-04-14 18:51</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:12.9k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#TGCTF2025-RE"><span class="toc-text">TGCTF2025 RE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64"><span class="toc-text">Base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XTEA"><span class="toc-text">XTEA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exchange"><span class="toc-text">exchange</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#conforand"><span class="toc-text">conforand</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E5%BF%8D%E8%80%85"><span class="toc-text">水果忍者</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%9B%87%E5%B9%B4%E7%9A%84%E6%9C%AC%E5%91%BD%E8%AF%AD%E8%A8%80"><span class="toc-text">蛇年的本命语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#randomsystem"><span class="toc-text">randomsystem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#index"><span class="toc-text">index</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="TGCTF2025-RE"><a href="#TGCTF2025-RE" class="headerlink" title="TGCTF2025 RE"></a>TGCTF2025 RE</h1><h3 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h3><p>考点总结：魔改Base64</p>
<p>题目描述：如题 flag格式为HZNUCTF{}</p>
<p>wp：</p>
<p>拿到附件先查壳，64位的，没有壳</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20241222200148991.png" alt="image-20241222200148991"></p>
<p>直接ida64分析，拿到伪代码</p>
<pre><code class="language-c">int __fastcall main(int argc, const char **argv, const char **envp)
&#123;
  char *v3; // rbx
  __int64 v4; // rcx
  void *v5; // rbx
  char Destination[16]; // [rsp+20h] [rbp-28h] BYREF

  sub_140001020(&quot;Welcome to HZNUCTF!!!\n&quot;);
  sub_140001020(&quot;Plz input your flag:\n&quot;);
  v3 = (char *)malloc(0x2Aui64);
  sub_140001080(&quot;%s&quot;);
  v4 = -1i64;
  do
    ++v4;
  while ( v3[v4] );
  if ( v4 == 41 )
  &#123;
    strncpy_s(Destination, 9ui64, v3, 8ui64);
    Destination[8] = 0;
    if ( !strcmp(Destination, &quot;HZNUCTF&#123;&quot;) )
    &#123;
      v5 = (void *)sub_1400010E0(v3);
      if ( !strcmp((const char *)v5, &quot;AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=&quot;) )
      &#123;
        sub_140001020(&quot;Congratulation!!!&quot;);
        free(v5);
        exit(1);
      &#125;
      sub_140001020(&quot;wrong_wrong!!!&quot;);
      free(v5);
      exit(1);
    &#125;
    sub_140001020(&quot;wrong head!!!&quot;);
    free(v3);
    exit(1);
  &#125;
  sub_140001020(&quot;wrong len!!!&quot;);
  free(v3);
  return 0;
&#125;
</code></pre>
<p>逻辑很简单，输入flag，先检查长度，然后检查头，再接着就是加密了，加密函数就是<strong>sub_1400010E0</strong>函数，点进去看发现是一个魔改的base64，换了表，同时在索引取值的时候也进行了处理，一个类似于凯撒的处理，加24。</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20241222200549750.png" alt="image-20241222200549750"></p>
<p>加密完了就直接比对结果了</p>
<p>那么在解base64编码的时候，可以先把偏移后的码表输出，然后再用赛博厨子一把梭</p>
<pre><code class="language-python">table = &quot;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;
real_table = [0] * 64

for i in range(64):
    num = (i + 24) % 64  # 使用取模运算，确保索引在范围内
    real_table[i] = ord(table[num])

for i in range(64):
    print(chr(real_table[i]), end=&quot;&quot;)
</code></pre>
<p>拿到表：<strong>53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebIGLp&#x2F;+Wn7uqX8FQ2JDR1c0M6U</strong></p>
<p>然后解编码</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20241222200733698.png" alt="image-20241222200733698"></p>
<p><strong>HZNUCTF{ad162c-2d94-434d-9222-b65dc76a32}</strong></p>
<hr>
<h3 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h3><p>考点总结：魔改XTEA，反调试，伪随机</p>
<p>题目描述：如题，貌似有点misc味? flag格式为HZNUCTF{}</p>
<p>WP:</p>
<p>拿到题目附件，解压缩，里面有个readme.txt、一个.zip和一个.exe，readme里面是压缩包密码，解压缩，是一个exe，和外面那个一样的，查壳，没有壳，64位的</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250104173338545.png" alt="image-20250104173338545"></p>
<p>ida64打开分析，根据关键字符串跟踪到main函数</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250104173438726.png" alt="image-20250104173438726"></p>
<pre><code class="language-c">__int64 sub_140011BE0()
&#123;
  char *v0; // rdi
  __int64 i; // rcx
  __int64 v2; // rax
  __int64 v3; // rdi
  char v5[32]; // [rsp+0h] [rbp-20h] BYREF
  char v6; // [rsp+20h] [rbp+0h] BYREF
  int v7[9]; // [rsp+24h] [rbp+4h] BYREF
  void *Block; // [rsp+48h] [rbp+28h]
  void *v9; // [rsp+68h] [rbp+48h]
  int v10[15]; // [rsp+88h] [rbp+68h] BYREF
  int j; // [rsp+C4h] [rbp+A4h]
  int k; // [rsp+E4h] [rbp+C4h]
  int m; // [rsp+104h] [rbp+E4h]
  int v14; // [rsp+1D4h] [rbp+1B4h]

  v0 = &amp;v6;
  for ( i = 66i64; i; --i )
  &#123;
    *(_DWORD *)v0 = -858993460;
    v0 += 4;
  &#125;
  sub_1400113A2(&amp;unk_1400220A7);
  srand(0x7E9u);
  sub_140011181();
  printf(&quot;Welcome to HZNUCTF!!!\n&quot;);
  printf(&quot;Plz input the cipher:\n&quot;);
  v7[0] = 0;
  if ( (unsigned int)scanf(&quot;%d&quot;, v7) == 1 )     // 输入delta
  &#123;
    printf(&quot;Plz input the flag:\n&quot;);
    Block = malloc(0x21ui64);
    v9 = malloc(0x10ui64);
    if ( (unsigned int)scanf(&quot;%s&quot;, (const char *)Block) == 1 )// 输入flag
    &#123;
      for ( j = 0; j &lt; 32; j += 4 )
      &#123;
        v14 = *((char *)Block + j + 3) | (*((char *)Block + j + 2) &lt;&lt; 8) | (*((char *)Block + j + 1) &lt;&lt; 16) | (*((char *)Block + j) &lt;&lt; 24);// 字符串处理
        v10[j / 4] = v14;
      &#125;
      sub_1400110B9(v9);
      for ( k = 0; k &lt; 7; ++k )
        sub_140011212((unsigned int)v7[0], &amp;v10[k], &amp;v10[k + 1], v9);// 加密
      for ( m = 0; m &lt; 8; ++m )
      &#123;
        if ( v10[m] != dword_14001D000[m] )     // cmp
        &#123;
          printf(&quot;wrong_wrong!!!&quot;);
          exit(1);
        &#125;
      &#125;
      printf(&quot;Congratulation!!!&quot;);
      free(Block);
      free(v9);
      v2 = 0i64;
    &#125;
    else
    &#123;
      printf(&quot;Invalid input.\n&quot;);
      free(Block);
      free(v9);
      v2 = 1i64;
    &#125;
  &#125;
  else
  &#123;
    printf(&quot;Invalid input.\n&quot;);
    v2 = 1i64;
  &#125;
  v3 = v2;
  sub_14001133E(v5, &amp;unk_14001AD40);
  return v3;
&#125;
</code></pre>
<p>根据代码逻辑对一些函数进行重命名，同时对一些函数功能进行注释</p>
<p>整体逻辑就是先输入一个密码，这个密码也就是前面给的压缩包的解压密码，转成十六进制是0x9E3779B9，很明显就是xtea加密的delta</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250104173837132.png" alt="image-20250104173837132"></p>
<p>首先是加密所用到的key，在sub_1400110B9函数中进行初始化</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250104174038200.png" alt="image-20250104174038200"></p>
<p>可以看到就是一个伪随机，但是种子是在函数的最开始</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250104175434787.png" alt="image-20250104175434787"></p>
<p>那么就可以根据已知的种子获取key的值，或者动态调试拿key，但是这里有一个反调试，在sub_140011181函数里</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250104175419437.png" alt="image-20250104175419437"></p>
<p>检测到调式的话伪随机的种子就会改变</p>
<p>导致key也不一样，想通过动调拿key简单绕一下就可以了</p>
<p>下面是获取key的脚本</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
#include &lt;time.h&gt;
int main() &#123;
    srand(0x7e8u);
    for (int i = 0; i &lt; 4; i++) &#123;
        printf(&quot;%d\n&quot;, rand());
    &#125;

    return 0;
&#125;
</code></pre>
<p>key</p>
<blockquote>
<p>6648<br>4542<br>2449<br>13336</p>
</blockquote>
<p>初始完了key，这里有一个for循环，就是处理输入的32位的明文，分成八组进行加密</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250104175909142.png" alt="image-20250104175909142"></p>
<p>然后是加密函数，通过查看sub_140011212函数可知是一个没有进行魔改的xtea加密，但是在明文传进去的时候做了一些改变，不是和标准的xtea以01 23 45这样的组合进行加密，而是01 12 23这样的组合，那么在解密的时候需要倒着来进行解密</p>
<p>以下就是解密脚本</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
#define delta 0x9E3779B9

void decrypt(uint32_t* enc, uint32_t* key) &#123;
    unsigned int sum, i;
    uint32_t v1, v2;
    v1 = enc[0];
    v2 = enc[1];
    sum = 32 * -delta;

    for (i = 0; i &lt; 32; i++) &#123;
        v2 -= (key[(sum &gt;&gt; 11) &amp; 3] + sum) ^ (v1 + ((v1 &gt;&gt; 5) ^ (16 * v1)));
        sum += delta;
        v1 -= (key[sum &amp; 3] + sum) ^ (v2 + ((v2 &gt;&gt; 5) ^ (16 * v2)));
    &#125;

    enc[0] = v1;
    enc[1] = v2;
&#125;

void print_as_big_endian(uint32_t value) &#123;
    // 将每个字节打印出来，按大端序排列
    for (int i = 3; i &gt;= 0; i--) &#123;  // 从最高字节开始输出
        printf(&quot;%c&quot;, (unsigned char)((value &gt;&gt; (i * 8)) &amp; 0xFF));  // 提取字节并打印
    &#125;
&#125;

int main() &#123;
    uint32_t key[4];  
    key[0] = 6648;
    key[1] = 4542;
    key[2] = 2449;
    key[3] = 13336;

    uint32_t enc[8];
    enc[0] = 0x8ccb2324;
    enc[1] = 0x09a7741a;
    enc[2] = 0xfb3c678d;
    enc[3] = 0xf6083a79;
    enc[4] = 0xf1cc241b;
    enc[5] = 0x39fa59f2;
    enc[6] = 0xf2abe1cc;
    enc[7] = 0x17189f72;

    for (int index = 6; index &gt;= 0; index--) &#123;  
        decrypt(&amp;enc[index], key);
    &#125;

    for (int i = 0; i &lt; 8; i++) &#123;
        print_as_big_endian(enc[i]);  // 打印按大端序的值
    &#125;

    printf(&quot;\n&quot;);
    puts((char *)enc);  

    return 0;
&#125;
</code></pre>
<p><strong>HZNUCTF{ae6-9f57-4b74-b423-98eb}</strong></p>
<hr>
<h3 id="exchange"><a href="#exchange" class="headerlink" title="exchange"></a>exchange</h3><p>考点总结：PE文件格式，UPX壳，自定义加密，魔改DES</p>
<p>题目描述：嘶，为什么不能运行呢，但好像也不影响？ flag格式为HZNUCTF{}</p>
<p>WP：</p>
<p>根据题目描述，把文件位数改成64bit，就可以正常运行程序了。用die可以查出这是64位的文件，但是用010打开来看不符合64位文件的格式</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301115519561.png" alt="image-20250301115519561"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250209134613624.png" alt="image-20250209134613624"></p>
<p>把0B 01改成0B 02。ida64打开分析，根据关键字符串定位到main函数</p>
<p>然后依据逻辑对一些变量和函数名进行重命名</p>
<pre><code class="language-c">__int64 sub_140012F90()
&#123;
  char *v0; // rdi
  __int64 i; // rcx
  char v3[32]; // [rsp+0h] [rbp-20h] BYREF
  char v4; // [rsp+20h] [rbp+0h] BYREF
  char *flag; // [rsp+28h] [rbp+8h]
  char Destination[44]; // [rsp+48h] [rbp+28h] BYREF
  char Str1[36]; // [rsp+74h] [rbp+54h] BYREF
  char *v8; // [rsp+98h] [rbp+78h]
  char v9[100]; // [rsp+C0h] [rbp+A0h] BYREF
  int j; // [rsp+124h] [rbp+104h]
  unsigned __int8 v11; // [rsp+144h] [rbp+124h]
  unsigned __int8 v12; // [rsp+164h] [rbp+144h]
  char v13[32]; // [rsp+184h] [rbp+164h] BYREF
  char v14[32]; // [rsp+1A4h] [rbp+184h] BYREF
  char v15; // [rsp+1C4h] [rbp+1A4h]

  v0 = &amp;v4;
  for ( i = 114i64; i; --i )
  &#123;
    *(_DWORD *)v0 = -858993460;
    v0 += 4;
  &#125;
  sub_1400113CA(&amp;unk_1400260A6);
  flag = (char *)malloc(0x2Aui64);
  printf(&quot;Welcome to HZNUCTF!!!\n&quot;);
  printf(&quot;Plz input the flag:\n&quot;);
  scanf(&amp;aS, flag);
  strncpy_s(Destination, 9ui64, flag, 8ui64);
  strncpy_s(Str1, 2ui64, flag + 40, 1ui64);
  if ( !j_strcmp(Destination, &quot;HZNUCTF&#123;&quot;) &amp;&amp; !j_strcmp(Str1, &quot;&#125;&quot;) )
  &#123;
    v8 = (char *)malloc(0x24ui64);
    strncpy_s(v8, 0x24ui64, flag + 8, 0x20ui64);
    memset(v9, 0, 0x41ui64);
    for ( j = 0; j &lt; 32; j += 2 )
    &#123;
      v11 = 0;
      v12 = 0;
      memset(v13, 0, 5ui64);
      memset(v14, 0, 3ui64);
      v11 = v8[j];
      sub_140011393(v13, &quot;%x&quot;, v11);
      v12 = v8[j + 1];
      sub_140011393(v14, &quot;%x&quot;, v12);
      j_strcat(v13, v14);
      v15 = v13[1];
      v13[1] = v13[2];
      v13[2] = v15;
      j_strcat(v9, v13);
    &#125;
    sub_1400113ED(v9, Destination);
    printf(&quot;Congratulation!!!\n&quot;);
    free(v8);
  &#125;
  free(flag);
  sub_14001135C(v3, &amp;unk_14001D390);
  return 0i64;
&#125;
</code></pre>
<p>程序的整体逻辑就是先对输入的flag进行格式检查，是否满足HZNUCTF{}，然后对大括号内的内容进行加密处理，先把每一个字符转成十六进制，然后将这些十六进制转为字符串，并将每四个字符中的两个进行交换位置，最后传入sub_1400113ED函数进行魔改的DES加密，这里可以利用插件识别出是DES加密</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250209141110123.png" alt="image-20250209141110123"></p>
<p>并且最终check的密文就在此函数中</p>
<pre><code class="language-c">__int64 __fastcall sub_140017F30(int a1, int a2)
&#123;
  char *v2; // rdi
  __int64 i; // rcx
  int v4; // edx
  char v6[32]; // [rsp+0h] [rbp-30h] BYREF
  char v7; // [rsp+30h] [rbp+0h] BYREF
  char Src[96]; // [rsp+40h] [rbp+10h] BYREF
  char v9[64]; // [rsp+A0h] [rbp+70h] BYREF
  int j; // [rsp+F4h] [rbp+C4h]

  v2 = &amp;v7;
  for ( i = 58i64; i; --i )
  &#123;
    *(_DWORD *)v2 = -858993460;
    v2 += 4;
  &#125;
  sub_1400113CA(&amp;unk_1400260A6);
  j_memcpy(v9, Src, sizeof(v9));
  LOBYTE(v4) = 8;
  sub_1400113B6(a2, v4, a1, (unsigned int)Src, 8);
  for ( j = 0; j &lt; 64; ++j )
  &#123;
    if ( (unsigned __int8)Src[j] != enc[j] )
    &#123;
      printf(&quot;wrong_wrong!!!\n&quot;);
      exit(1);
    &#125;
  &#125;
  return sub_14001135C(v6, &amp;unk_14001D1F0);
&#125;
</code></pre>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250209141513061.png" alt="image-20250209141513061"></p>
<p>标准的totrot是1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28，在网上找个脚本，把这个修改一下就可以正常解密了。这里DES解密的密钥是flag头<strong>HZNUCTF{</strong>，</p>
<pre><code class="language-c">#include &lt;string.h&gt;
#include &lt;stdio.h&gt;

#define EN0 0   /* MODE == encrypt */
#define DE1 1   /* MODE == decrypt */

typedef struct 
&#123;
  unsigned long ek[32];
  unsigned long dk[32];
&#125; des_ctx;

static unsigned long SP1[64] = &#123;
    0x01010400L, 0x00000000L, 0x00010000L, 0x01010404L,
    0x01010004L, 0x00010404L, 0x00000004L, 0x00010000L,
    0x00000400L, 0x01010400L, 0x01010404L, 0x00000400L,
    0x01000404L, 0x01010004L, 0x01000000L, 0x00000004L,
    0x00000404L, 0x01000400L, 0x01000400L, 0x00010400L,
    0x00010400L, 0x01010000L, 0x01010000L, 0x01000404L,
    0x00010004L, 0x01000004L, 0x01000004L, 0x00010004L,
    0x00000000L, 0x00000404L, 0x00010404L, 0x01000000L,
    0x00010000L, 0x01010404L, 0x00000004L, 0x01010000L,
    0x01010400L, 0x01000000L, 0x01000000L, 0x00000400L,
    0x01010004L, 0x00010000L, 0x00010400L, 0x01000004L,
    0x00000400L, 0x00000004L, 0x01000404L, 0x00010404L,
    0x01010404L, 0x00010004L, 0x01010000L, 0x01000404L,
    0x01000004L, 0x00000404L, 0x00010404L, 0x01010400L,
    0x00000404L, 0x01000400L, 0x01000400L, 0x00000000L,
    0x00010004L, 0x00010400L, 0x00000000L, 0x01010004L &#125;;

static unsigned long SP2[64] = &#123;
    0x80108020L, 0x80008000L, 0x00008000L, 0x00108020L,
    0x00100000L, 0x00000020L, 0x80100020L, 0x80008020L,
    0x80000020L, 0x80108020L, 0x80108000L, 0x80000000L,
    0x80008000L, 0x00100000L, 0x00000020L, 0x80100020L,
    0x00108000L, 0x00100020L, 0x80008020L, 0x00000000L,
    0x80000000L, 0x00008000L, 0x00108020L, 0x80100000L,
    0x00100020L, 0x80000020L, 0x00000000L, 0x00108000L,
    0x00008020L, 0x80108000L, 0x80100000L, 0x00008020L,
    0x00000000L, 0x00108020L, 0x80100020L, 0x00100000L,
    0x80008020L, 0x80100000L, 0x80108000L, 0x00008000L,
    0x80100000L, 0x80008000L, 0x00000020L, 0x80108020L,
    0x00108020L, 0x00000020L, 0x00008000L, 0x80000000L,
    0x00008020L, 0x80108000L, 0x00100000L, 0x80000020L,
    0x00100020L, 0x80008020L, 0x80000020L, 0x00100020L,
    0x00108000L, 0x00000000L, 0x80008000L, 0x00008020L,
    0x80000000L, 0x80100020L, 0x80108020L, 0x00108000L &#125;;

static unsigned long SP3[64] = &#123;
    0x00000208L, 0x08020200L, 0x00000000L, 0x08020008L,
    0x08000200L, 0x00000000L, 0x00020208L, 0x08000200L,
    0x00020008L, 0x08000008L, 0x08000008L, 0x00020000L,
    0x08020208L, 0x00020008L, 0x08020000L, 0x00000208L,
    0x08000000L, 0x00000008L, 0x08020200L, 0x00000200L,
    0x00020200L, 0x08020000L, 0x08020008L, 0x00020208L,
    0x08000208L, 0x00020200L, 0x00020000L, 0x08000208L,
    0x00000008L, 0x08020208L, 0x00000200L, 0x08000000L,
    0x08020200L, 0x08000000L, 0x00020008L, 0x00000208L,
    0x00020000L, 0x08020200L, 0x08000200L, 0x00000000L,
    0x00000200L, 0x00020008L, 0x08020208L, 0x08000200L,
    0x08000008L, 0x00000200L, 0x00000000L, 0x08020008L,
    0x08000208L, 0x00020000L, 0x08000000L, 0x08020208L,
    0x00000008L, 0x00020208L, 0x00020200L, 0x08000008L,
    0x08020000L, 0x08000208L, 0x00000208L, 0x08020000L,
    0x00020208L, 0x00000008L, 0x08020008L, 0x00020200L &#125;;

static unsigned long SP4[64] = &#123;
    0x00802001L, 0x00002081L, 0x00002081L, 0x00000080L,
    0x00802080L, 0x00800081L, 0x00800001L, 0x00002001L,
    0x00000000L, 0x00802000L, 0x00802000L, 0x00802081L,
    0x00000081L, 0x00000000L, 0x00800080L, 0x00800001L,
    0x00000001L, 0x00002000L, 0x00800000L, 0x00802001L,
    0x00000080L, 0x00800000L, 0x00002001L, 0x00002080L,
    0x00800081L, 0x00000001L, 0x00002080L, 0x00800080L,
    0x00002000L, 0x00802080L, 0x00802081L, 0x00000081L,
    0x00800080L, 0x00800001L, 0x00802000L, 0x00802081L,
    0x00000081L, 0x00000000L, 0x00000000L, 0x00802000L,
    0x00002080L, 0x00800080L, 0x00800081L, 0x00000001L,
    0x00802001L, 0x00002081L, 0x00002081L, 0x00000080L,
    0x00802081L, 0x00000081L, 0x00000001L, 0x00002000L,
    0x00800001L, 0x00002001L, 0x00802080L, 0x00800081L,
    0x00002001L, 0x00002080L, 0x00800000L, 0x00802001L,
    0x00000080L, 0x00800000L, 0x00002000L, 0x00802080L &#125;;

static unsigned long SP5[64] = &#123;
    0x00000100L, 0x02080100L, 0x02080000L, 0x42000100L,
    0x00080000L, 0x00000100L, 0x40000000L, 0x02080000L,
    0x40080100L, 0x00080000L, 0x02000100L, 0x40080100L,
    0x42000100L, 0x42080000L, 0x00080100L, 0x40000000L,
    0x02000000L, 0x40080000L, 0x40080000L, 0x00000000L,
    0x40000100L, 0x42080100L, 0x42080100L, 0x02000100L,
    0x42080000L, 0x40000100L, 0x00000000L, 0x42000000L,
    0x02080100L, 0x02000000L, 0x42000000L, 0x00080100L,
    0x00080000L, 0x42000100L, 0x00000100L, 0x02000000L,
    0x40000000L, 0x02080000L, 0x42000100L, 0x40080100L,
    0x02000100L, 0x40000000L, 0x42080000L, 0x02080100L,
    0x40080100L, 0x00000100L, 0x02000000L, 0x42080000L,
    0x42080100L, 0x00080100L, 0x42000000L, 0x42080100L,
    0x02080000L, 0x00000000L, 0x40080000L, 0x42000000L,
    0x00080100L, 0x02000100L, 0x40000100L, 0x00080000L,
    0x00000000L, 0x40080000L, 0x02080100L, 0x40000100L &#125;;

static unsigned long SP6[64] = &#123;
    0x20000010L, 0x20400000L, 0x00004000L, 0x20404010L,
    0x20400000L, 0x00000010L, 0x20404010L, 0x00400000L,
    0x20004000L, 0x00404010L, 0x00400000L, 0x20000010L,
    0x00400010L, 0x20004000L, 0x20000000L, 0x00004010L,
    0x00000000L, 0x00400010L, 0x20004010L, 0x00004000L,
    0x00404000L, 0x20004010L, 0x00000010L, 0x20400010L,
    0x20400010L, 0x00000000L, 0x00404010L, 0x20404000L,
    0x00004010L, 0x00404000L, 0x20404000L, 0x20000000L,
    0x20004000L, 0x00000010L, 0x20400010L, 0x00404000L,
    0x20404010L, 0x00400000L, 0x00004010L, 0x20000010L,
    0x00400000L, 0x20004000L, 0x20000000L, 0x00004010L,
    0x20000010L, 0x20404010L, 0x00404000L, 0x20400000L,
    0x00404010L, 0x20404000L, 0x00000000L, 0x20400010L,
    0x00000010L, 0x00004000L, 0x20400000L, 0x00404010L,
    0x00004000L, 0x00400010L, 0x20004010L, 0x00000000L,
    0x20404000L, 0x20000000L, 0x00400010L, 0x20004010L &#125;;

static unsigned long SP7[64] = &#123;
    0x00200000L, 0x04200002L, 0x04000802L, 0x00000000L,
    0x00000800L, 0x04000802L, 0x00200802L, 0x04200800L,
    0x04200802L, 0x00200000L, 0x00000000L, 0x04000002L,
    0x00000002L, 0x04000000L, 0x04200002L, 0x00000802L,
    0x04000800L, 0x00200802L, 0x00200002L, 0x04000800L,
    0x04000002L, 0x04200000L, 0x04200800L, 0x00200002L,
    0x04200000L, 0x00000800L, 0x00000802L, 0x04200802L,
    0x00200800L, 0x00000002L, 0x04000000L, 0x00200800L,
    0x04000000L, 0x00200800L, 0x00200000L, 0x04000802L,
    0x04000802L, 0x04200002L, 0x04200002L, 0x00000002L,
    0x00200002L, 0x04000000L, 0x04000800L, 0x00200000L,
    0x04200800L, 0x00000802L, 0x00200802L, 0x04200800L,
    0x00000802L, 0x04000002L, 0x04200802L, 0x04200000L,
    0x00200800L, 0x00000000L, 0x00000002L, 0x04200802L,
    0x00000000L, 0x00200802L, 0x04200000L, 0x00000800L,
    0x04000002L, 0x04000800L, 0x00000800L, 0x00200002L &#125;;

static unsigned long SP8[64] = &#123;
    0x10001040L, 0x00001000L, 0x00040000L, 0x10041040L,
    0x10000000L, 0x10001040L, 0x00000040L, 0x10000000L,
    0x00040040L, 0x10040000L, 0x10041040L, 0x00041000L,
    0x10041000L, 0x00041040L, 0x00001000L, 0x00000040L,
    0x10040000L, 0x10000040L, 0x10001000L, 0x00001040L,
    0x00041000L, 0x00040040L, 0x10040040L, 0x10041000L,
    0x00001040L, 0x00000000L, 0x00000000L, 0x10040040L,
    0x10000040L, 0x10001000L, 0x00041040L, 0x00040000L,
    0x00041040L, 0x00040000L, 0x10041000L, 0x00001000L,
    0x00000040L, 0x10040040L, 0x00001000L, 0x00041040L,
    0x10001000L, 0x00000040L, 0x10000040L, 0x10040000L,
    0x10040040L, 0x10000000L, 0x00040000L, 0x10001040L,
    0x00000000L, 0x10041040L, 0x00040040L, 0x10000040L,
    0x10040000L, 0x10001000L, 0x10001040L, 0x00000000L,
    0x10041040L, 0x00041000L, 0x00041000L, 0x00001040L,
    0x00001040L, 0x00040040L, 0x10000000L, 0x10041000L &#125;;

#define   CRCSEED 0x7529

static void scrunch(unsigned char *, unsigned long *);
static void unscrun(unsigned long *, unsigned char *);
static void desfunc(unsigned long *, unsigned long *);
static void cookey(unsigned long *);
void usekey(register unsigned long *from);

static unsigned long KnL[32] = &#123; 0L &#125;;
//static unsigned long KnR[32] = &#123; 0L &#125;;
//static unsigned long Kn3[32] = &#123; 0L &#125;;
//static unsigned char Df_Key[24] = &#123;
//  0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef,
//  0xfe,0xdc,0xba,0x98,0x76,0x54,0x32,0x10,
//  0x89,0xab,0xcd,0xef,0x01,0x23,0x45,0x67 &#125;;

static unsigned short bytebit[8]    = &#123;
    0200, 0100, 040, 020, 010, 04, 02, 01 &#125;;

static unsigned long bigbyte[24] = &#123;
    0x800000L,  0x400000L,  0x200000L,  0x100000L,
    0x80000L,   0x40000L,   0x20000L,   0x10000L,
    0x8000L,    0x4000L,    0x2000L,    0x1000L,
    0x800L,     0x400L,     0x200L,     0x100L,
    0x80L,      0x40L,      0x20L,      0x10L,
    0x8L,       0x4L,       0x2L,       0x1L    &#125;;

/* Use the key schedule specified in the Standard (ANSI X3.92-1981). */ 

static unsigned char pc1[56] = &#123;
    56, 48, 40, 32, 24, 16,  8,  0, 57, 49, 41, 33, 25, 17,
     9,  1, 58, 50, 42, 34, 26, 18, 10,  2, 59, 51, 43, 35,
    62, 54, 46, 38, 30, 22, 14,  6, 61, 53, 45, 37, 29, 21,
    13,  5, 60, 52, 44, 36, 28, 20, 12,  4, 27, 19, 11,  3 &#125;;

static unsigned char totrot[16] = &#123;                                                 //魔改的地方
    1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16&#125;;

static unsigned char pc2[48] = &#123;
    13, 16, 10, 23,  0,  4,  2, 27, 14,  5, 20,  9,
    22, 18, 11,  3, 25,  7, 15,  6, 26, 19, 12,  1,
    40, 51, 30, 36, 46, 54, 29, 39, 50, 44, 32, 47,
    43, 48, 38, 55, 33, 52, 45, 41, 49, 35, 28, 31 &#125;;

void deskey(unsigned char *key,short edf)   /* Thanks to James Gillogly &amp; Phil Karn! */
&#123;
    register int i, j, l, m, n;
    unsigned char pc1m[56], pcr[56];
    unsigned long kn[32];

    for ( j = 0; j &lt; 56; j++ ) 
    &#123;
        l = pc1[j];
        m = l &amp; 07;
        pc1m[j] = (key[l &gt;&gt; 3] &amp; bytebit[m]) ? 1 : 0;
    &#125;
    for( i = 0; i &lt; 16; i++ )
    &#123;
        if( edf == DE1 ) m = (15 - i) &lt;&lt; 1;
        else m = i &lt;&lt; 1;
        n = m + 1;
        kn[m] = kn[n] = 0L;
        for( j = 0; j &lt; 28; j++ )
        &#123;
            l = j + totrot[i];
            if( l &lt; 28 ) pcr[j] = pc1m[l];
            else pcr[j] = pc1m[l - 28];
        &#125;
        for( j = 28; j &lt; 56; j++ ) 
        &#123;
            l = j + totrot[i];
            if( l &lt; 56 ) pcr[j] = pc1m[l];
            else pcr[j] = pc1m[l - 28];
        &#125;
        for( j = 0; j &lt; 24; j++ ) 
        &#123;
            if( pcr[pc2[j]] ) kn[m] |= bigbyte[j];
            if( pcr[pc2[j+24]] ) kn[n] |= bigbyte[j];
        &#125;
    &#125;
    cookey(kn);
    return;
&#125;

static void cookey(register unsigned long *raw1)
&#123;
    register unsigned long *cook, *raw0;
    unsigned long dough[32];
    register int i;

    cook = dough;
    for( i = 0; i &lt; 16; i++, raw1++ ) 
    &#123;
        raw0 = raw1++;
        *cook    = (*raw0 &amp; 0x00fc0000L) &lt;&lt; 6;
        *cook   |= (*raw0 &amp; 0x00000fc0L) &lt;&lt; 10;
        *cook   |= (*raw1 &amp; 0x00fc0000L) &gt;&gt; 10;
        *cook++ |= (*raw1 &amp; 0x00000fc0L) &gt;&gt; 6;
        *cook    = (*raw0 &amp; 0x0003f000L) &lt;&lt; 12;
        *cook   |= (*raw0 &amp; 0x0000003fL) &lt;&lt; 16;
        *cook   |= (*raw1 &amp; 0x0003f000L) &gt;&gt; 4;
        *cook++ |= (*raw1 &amp; 0x0000003fL);
    &#125;
    usekey(dough);
    return;
&#125;

void cpkey(register unsigned long *into)
&#123;
    register unsigned long *from, *endp;

    from = KnL, endp = &amp;KnL[32];
    while( from &lt; endp ) *into++ = *from++;
    return;
&#125;

void usekey(register unsigned long *from)
&#123;
    register unsigned long *to, *endp;

    to = KnL, endp = &amp;KnL[32];
    while( to &lt; endp ) *to++ = *from++;
    return;
&#125;

void des(unsigned char *inblock, unsigned char *outblock)
&#123;
    unsigned long work[2];

    scrunch(inblock, work);
    desfunc(work, KnL);
    unscrun(work, outblock);
    return;
&#125;

static void scrunch(register unsigned char *outof, register unsigned long *into)
&#123;
    *into    = (*outof++ &amp; 0xffL) &lt;&lt; 24;
    *into   |= (*outof++ &amp; 0xffL) &lt;&lt; 16;
    *into   |= (*outof++ &amp; 0xffL) &lt;&lt; 8;
    *into++ |= (*outof++ &amp; 0xffL);
    *into    = (*outof++ &amp; 0xffL) &lt;&lt; 24;
    *into   |= (*outof++ &amp; 0xffL) &lt;&lt; 16;
    *into   |= (*outof++ &amp; 0xffL) &lt;&lt; 8;
    *into   |= (*outof   &amp; 0xffL);
    return;
&#125;

static void unscrun(register unsigned long *outof, register unsigned char *into)
&#123;
    *into++ = (unsigned char)((*outof &gt;&gt; 24) &amp; 0xffL);
    *into++ = (unsigned char)((*outof &gt;&gt; 16) &amp; 0xffL);
    *into++ = (unsigned char)((*outof &gt;&gt;  8) &amp; 0xffL);
    *into++ = (unsigned char)(*outof++   &amp; 0xffL);
    *into++ = (unsigned char)((*outof &gt;&gt; 24) &amp; 0xffL);
    *into++ = (unsigned char)((*outof &gt;&gt; 16) &amp; 0xffL);
    *into++ = (unsigned char)((*outof &gt;&gt;  8) &amp; 0xffL);
    *into   =  (unsigned char)(*outof    &amp; 0xffL);
    return;
&#125;

static void desfunc(register unsigned long *block,register unsigned long *keys)
&#123;
    register unsigned long fval, work, right, leftt;
    register int round;
    
    leftt = block[0];
    right = block[1];
    work = ((leftt &gt;&gt; 4) ^ right) &amp; 0x0f0f0f0fL;
    right ^= work;
    leftt ^= (work &lt;&lt; 4);
    work = ((leftt &gt;&gt; 16) ^ right) &amp; 0x0000ffffL;
    right ^= work;
    leftt ^= (work &lt;&lt; 16);
    work = ((right &gt;&gt; 2) ^ leftt) &amp; 0x33333333L;
    leftt ^= work;
    right ^= (work &lt;&lt; 2);
    work = ((right &gt;&gt; 8) ^ leftt) &amp; 0x00ff00ffL;
    leftt ^= work;
    right ^= (work &lt;&lt; 8);
    right = ((right &lt;&lt; 1) | ((right &gt;&gt; 31) &amp; 1L)) &amp; 0xffffffffL;
    work = (leftt ^ right) &amp; 0xaaaaaaaaL;
    leftt ^= work;
    right ^= work;
    leftt = ((leftt &lt;&lt; 1) | ((leftt &gt;&gt; 31) &amp; 1L)) &amp; 0xffffffffL;
    
    for( round = 0; round &lt; 8; round++ ) 
    &#123;
        work  = (right &lt;&lt; 28) | (right &gt;&gt; 4);
        work ^= *keys++;
        fval  = SP7[ work        &amp; 0x3fL];
        fval |= SP5[(work &gt;&gt;  8) &amp; 0x3fL];
        fval |= SP3[(work &gt;&gt; 16) &amp; 0x3fL];
        fval |= SP1[(work &gt;&gt; 24) &amp; 0x3fL];
        work  = right ^ *keys++;
        fval |= SP8[ work        &amp; 0x3fL];
        fval |= SP6[(work &gt;&gt;  8) &amp; 0x3fL];
        fval |= SP4[(work &gt;&gt; 16) &amp; 0x3fL];
        fval |= SP2[(work &gt;&gt; 24) &amp; 0x3fL];
        leftt ^= fval;
        work  = (leftt &lt;&lt; 28) | (leftt &gt;&gt; 4);
        work ^= *keys++;
        fval  = SP7[ work        &amp; 0x3fL];
        fval |= SP5[(work &gt;&gt;  8) &amp; 0x3fL];
        fval |= SP3[(work &gt;&gt; 16) &amp; 0x3fL];
        fval |= SP1[(work &gt;&gt; 24) &amp; 0x3fL];
        work  = leftt ^ *keys++;
        fval |= SP8[ work        &amp; 0x3fL];
        fval |= SP6[(work &gt;&gt;  8) &amp; 0x3fL];
        fval |= SP4[(work &gt;&gt; 16) &amp; 0x3fL];
        fval |= SP2[(work &gt;&gt; 24) &amp; 0x3fL];
        right ^= fval;
    &#125;
        
    right = (right &lt;&lt; 31) | (right &gt;&gt; 1);
    work = (leftt ^ right) &amp; 0xaaaaaaaaL;
    leftt ^= work;
    right ^= work;
    leftt = (leftt &lt;&lt; 31) | (leftt &gt;&gt; 1);
    work = ((leftt &gt;&gt; 8) ^ right) &amp; 0x00ff00ffL;
    right ^= work;
    leftt ^= (work &lt;&lt; 8);
    work = ((leftt &gt;&gt; 2) ^ right) &amp; 0x33333333L;
    right ^= work;
    leftt ^= (work &lt;&lt; 2);
    work = ((right &gt;&gt; 16) ^ leftt) &amp; 0x0000ffffL;
    leftt ^= work;
    right ^= (work &lt;&lt; 16);
    work = ((right &gt;&gt; 4) ^ leftt) &amp; 0x0f0f0f0fL;
    leftt ^= work;
    right ^= (work &lt;&lt; 4);
    *block++ = right;
    *block = leftt;
    return;
&#125;

/* Validation sets:
 *
 * Single-length key, single-length plaintext -
 * Key    : 0123 4567 89ab cdef
 * Plain  : 0123 4567 89ab cde7
 * Cipher : c957 4425 6a5e d31d
 *****************************************************************/

void des_key(des_ctx *dc, unsigned char *key)
&#123;
    deskey(key,EN0);
    cpkey(dc-&gt;ek);
    deskey(key,DE1);
    cpkey(dc-&gt;dk);
&#125;

/*Encrypt several blocks in ECB mode. Caller is responsible for short blocks. */
void des_enc(des_ctx *dc, unsigned char *data, int blocks)
&#123;
    unsigned long work[2];
    int i;
    unsigned char *cp;
    cp=data;
    for(i=0;i&lt;blocks;i++)
    &#123;
        scrunch(cp,work);
        desfunc(work,dc-&gt;ek);
        unscrun(work,cp);
        cp+=8;
    &#125;
&#125;

void des_dec(des_ctx *dc, unsigned char *data, int blocks)
&#123;
    unsigned long work[2];
    int i;
    unsigned char *cp;
    cp=data;

    for(i=0;i&lt;blocks;i++)
    &#123;
        scrunch(cp,work);
        desfunc(work,dc-&gt;dk);
        unscrun(work,cp);
        cp+=8;
    &#125;
&#125;



int des_encrypt(const unsigned char* Key,const unsigned char KeyLen,const unsigned char* PlainContent,unsigned char* CipherContent,const int BlockCount)
&#123;
    des_ctx dc;
    unsigned char  keyEn[8];
    unsigned char  keyDe[8];
    
    if((BlockCount == 0) || (Key == NULL) || (CipherContent == NULL) || (PlainContent == NULL))
    &#123;
        return -1;
    &#125;

    if((KeyLen != 8) &amp;&amp; (KeyLen != 16))
    &#123;
        return -1;
    &#125;

    memcpy(CipherContent, PlainContent,BlockCount*8);   

    switch (KeyLen)
    &#123;
    case 8:    // DES
        memcpy(keyEn,Key,8);               //keyEn
        des_key(&amp;dc, keyEn);
        des_enc(&amp;dc, CipherContent, BlockCount);
        break;
    case 16:    // 3DES
        memcpy(keyEn,Key,8);               //keyEn
        memcpy(keyDe, Key+8, 8);      //keyDe
        des_key(&amp;dc, keyEn);
        des_enc(&amp;dc, CipherContent, BlockCount);
        
        des_key(&amp;dc, keyDe);
        des_dec(&amp;dc, CipherContent, BlockCount);

        des_key(&amp;dc, keyEn);
        des_enc(&amp;dc, CipherContent, BlockCount);
        break;

        default:
            return -1;          
    &#125;
    return 0;   
&#125;


int des_decrypt(const unsigned char* Key,const unsigned char KeyLen,const unsigned char* CipherContent,unsigned char* PlainContent,const int BlockCount)
&#123;
    des_ctx dc;
    unsigned char keyEn[8];
    unsigned char keyDe[8];
    
    if((BlockCount == 0) || (Key == NULL) || (CipherContent == NULL) || (PlainContent == NULL))
    &#123;
        return -1;
    &#125;

    if((KeyLen != 8) &amp;&amp; (KeyLen != 16))
    &#123;
        return -1;
    &#125;

    memcpy(PlainContent,CipherContent,BlockCount*8);    
    
    switch (KeyLen)
    &#123;
    case 8:    // DES
        memcpy(keyEn,Key,8);               //keyEn
        des_key(&amp;dc, keyEn);
        des_dec(&amp;dc, PlainContent, BlockCount);
        break;
    case 16:
        memcpy(keyEn,Key,8);               //keyEn
        memcpy(keyDe, Key+8, 8);        //keyDe
        des_key(&amp;dc, keyEn);
        des_dec(&amp;dc, PlainContent, BlockCount);

        des_key(&amp;dc, keyDe);
        des_enc(&amp;dc, PlainContent, BlockCount);

        des_key(&amp;dc, keyEn);
        des_dec(&amp;dc, PlainContent, BlockCount);             
        break;
    default:
        return -1;          
    &#125;
    return 0;
&#125;

int main()
&#123;
    unsigned char i;
    unsigned char plain[64];
    unsigned char cipher[64]; 
    unsigned char key[16] = &#123;0x48, 0x5a, 0x4e, 0x55, 0x43, 0x54, 0x46, 0x7b&#125;;
    unsigned char data[64];
    char string[] = &quot;333936147332632923d96353321d3345636826d26314621d3349330463126348&quot;;
    for (int i = 0; i &lt; 64; i++) &#123;
        data[i] = string[i];
    &#125;
    memcpy((void*)plain, data, 64);
    des_encrypt(key, 8, plain, cipher,8);      
    
    if(des_decrypt(key, 8, cipher, plain, 8) == 0x0) &#123;
        printf(&quot;sc_des plain data: \n&quot;);
        for(i = 0; i &lt; 64; i++) &#123;
            printf(&quot;%c&quot;,plain[i]);
        &#125;
        printf((&quot;\n&quot;));       
    &#125;
    else &#123;
        printf(&quot;sc_des failed \n&quot;);
    &#125;
    return 0;
&#125;
</code></pre>
<p>拿到DES加密之前的数据</p>
<p><strong>333936147332632923d96353321d3345636826d26314621d3349330463126348</strong></p>
<p>再写个脚本每四位的中间两位交换一下位置，就可以拿到flag了</p>
<pre><code class="language-python">enc = &quot;333936147332632923d96353321d3345636826d26314621d3349330463126348&quot;
enc_list = list(enc)

# 交换字符
for i in range(1, len(enc_list), 4):
    if i + 1 &lt; len(enc_list):
        enc_list[i], enc_list[i + 1] = enc_list[i + 1], enc_list[i]

processed_str = &quot;&quot;.join(enc_list)

print(&quot;HZNUCTF&#123;&quot;, end=&quot;&quot;)
# 每两位转成字符并输出
for i in range(0, len(processed_str), 2):
    hex_str = processed_str[i:i+2]
    print(chr(int(hex_str, 16)), end=&quot;&quot;)
print(&quot;&#125;&quot;)
</code></pre>
<p><strong>HZNUCTF{391ds2b9-9e31-45f8-ba4a-4904a2d8}</strong></p>
<p>后记：有的师傅非预期了，预期解如上，但是我在出题的时候源码中忘记删掉3DES的代码了，导致可以直接patch调用3DES中的解密函数，直接解密了…</p>
<hr>
<h3 id="conforand"><a href="#conforand" class="headerlink" title="conforand"></a>conforand</h3><p>考点总结：ollvm混淆，魔改RC4，伪随机数爆破</p>
<p>题目描述：简直辣眼睛… flag格式为HZNUCTF{}</p>
<p>WP：</p>
<p>ida打开，混淆非常严重，但是函数名都没做任何混淆，可以用插件D-810进行一定程度的去混淆</p>
<p>下面是去混淆后函数部分截图，同时根据逻辑对函数名和变量名进行了重命名</p>
<p>main函数</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213125821396.png" alt="image-20250213125821396"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130010978.png" alt="image-20250213130010978"></p>
<p>init函数，sub_5s5s5s函数，这两个函数就是对rc4的密钥进行初始化以及伪随机初始化</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213125900403.png" alt="image-20250213125900403"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213125916874.png" alt="image-20250213125916874"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213125925981.png" alt="image-20250213125925981"></p>
<p>rc4函数</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130057732.png" alt="image-20250213130057732"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130126684.png" alt="image-20250213130126684"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130134256.png" alt="image-20250213130134256"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130142272.png" alt="image-20250213130142272"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130149747.png" alt="image-20250213130149747"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130158890.png" alt="image-20250213130158890"></p>
<p>init_sbox函数</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130251422.png" alt="image-20250213130251422"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130312758.png" alt="image-20250213130312758"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130319813.png" alt="image-20250213130319813"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130333765.png" alt="image-20250213130333765"></p>
<p>rc4魔改了三个地方，一个是sbox初始化时，密钥形成密钥流的时候异或了伪随机生成的一个数，然后在rc4加密函数中的swap改成了</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250213130447399.png" alt="image-20250213130447399"></p>
<p>以及加密的轮数是257</p>
<p>那么就可以写解密爆破脚本了，根据附件中的output.txt</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;
#include &lt;stdlib.h&gt;  
#include &lt;string.h&gt;

int init(unsigned char* s, char* key, unsigned long Len_k)
&#123;
    
	int i = 0, j = 0;
	unsigned k[258] = &#123; 0 &#125;;
	unsigned char tmp = 0;
	for (i = 0; i &lt; 257; i++) &#123;
		s[i] = i;
		k[i] = key[i % Len_k];
	&#125;
	for (i = 0; i &lt; 257; i++) &#123;
		j = (j + s[i] + k[i]) % 257;
		tmp = s[i];
		s[i] = s[j];
		s[j] = tmp;
	&#125;
	return 0; 
&#125;


int rc4(unsigned char* Data, unsigned long Len_D, char* key, unsigned long Len_k) 
&#123;
	
	unsigned char s[258];
	init(s, key, Len_k);
	int i = 0, j = 0, t = 0;
	unsigned long k = 0;
	unsigned char tmp;
	
	for (k = 0; k &lt; Len_D; k++) &#123;
		i = (i + 1) % 257;
		j = (j + s[i]) % 257;
		s[i] = s[j];
		s[j] = s[i];
		t = (s[i] + s[j]) % 257;
		Data[k] = Data[k] ^ s[t];
	&#125;
	return 0; 
&#125;

int main() &#123;
    char key[] = &quot;JustDoIt!&quot;;
    for (int rand_num = 0; rand_num &lt;= 365; rand_num++) &#123;
        unsigned char qw[] = &#123;0x83, 0x1e, 0x9c, 0x48, 0x7a, 0xfa, 0xe8, 0x88, 0x36, 0xd5, 
                              0x0a, 0x08, 0xf6, 0xa7, 0x70, 0x0f, 0xfd, 0x67, 0xdd, 0xd4, 
                              0x3c, 0xa7, 0xed, 0x8d, 0x51, 0x10, 0xce, 0x6a, 0x9e, 0x56, 
                              0x57, 0x83, 0x56, 0xe7, 0x67, 0x9a, 0x67, 0x22, 0x24, 0x6e, 
                              0xcd, 0x2f&#125;;
        strcpy(key, &quot;JustDoIt!&quot;);
        for (int j = 0; j &lt; 9; j++) &#123;
            key[j] ^= rand_num;
        &#125;

        unsigned long key_len = sizeof(key) - 1;
        rc4(qw, sizeof(qw), key, key_len);
        if (qw[0] == &#39;H&#39; &amp;&amp; qw[1] == &#39;Z&#39; &amp;&amp; qw[2] == &#39;N&#39; &amp;&amp; qw[3] == &#39;U&#39;) &#123;
            for (int ii = 0; ii &lt; 42; ii++) &#123;
                printf(&quot;%c&quot;, qw[ii]);
            &#125;
            printf(&quot;\nrand_num: %d&quot;, rand_num);
            return 0;
        &#125;
    &#125;

    return 0;
&#125;
</code></pre>
<p><strong>HZNUCTF{489b88-1305-411e-b1f4-88a3070a73}</strong><br>rand_num: 56</p>
<hr>
<h3 id="水果忍者"><a href="#水果忍者" class="headerlink" title="水果忍者"></a>水果忍者</h3><p>考点总结：unity游戏逆向，AES加密</p>
<p>题目描述：Just for fun…(貌似有些bug？但好像不影响…) flag格式为HZNUCTF{}</p>
<p>WP：</p>
<p>签到题，找到Assembly-CSharp.dll，然后用dnSpy打开，</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250226102346685.png" alt="image-20250226102346685"></p>
<p>找到GameManger这个类，可以看到代码没有任何混淆，分析下逻辑，就是切水果分数达到999999999就会弹flag，flag是由程序中设定好的密文经AES CBC模式进行解密得到的。key和iv都可以直接获取</p>
<pre><code class="language-c#">// Token: 0x0600001C RID: 28 RVA: 0x00002474 File Offset: 0x00000674
	public void IncreaseScore(int points)
	&#123;
		this.score += points;
		this.scoreText.text = this.score.ToString();
		if (this.score &gt;= 999999999)
		&#123;
			byte[] cipherText = this.ConvertHexStringToByteArray(GameManager.encryptedHexData);
			string text = this.Decrypt(cipherText, GameManager.encryptionKey, GameManager.iv);
			if (this.decryptedTextDisplay != null)
			&#123;
				this.decryptedTextDisplay.text = text;
			&#125;
		&#125;
		else if (this.decryptedTextDisplay != null)
		&#123;
			this.decryptedTextDisplay.text = &quot;&quot;;
		&#125;
		float num = PlayerPrefs.GetFloat(&quot;hiscore&quot;, 0f);
		if ((float)this.score &gt; num)
		&#123;
			num = (float)this.score;
			PlayerPrefs.SetFloat(&quot;hiscore&quot;, num);
		&#125;
	&#125;
</code></pre>
<pre><code class="language-c#">	// Token: 0x0600001E RID: 30 RVA: 0x0000257C File Offset: 0x0000077C
	private string Decrypt(byte[] cipherText, string key, string iv)
	&#123;
		string result;
		using (Aes aes = Aes.Create())
		&#123;
			aes.Key = Encoding.UTF8.GetBytes(key);
			aes.IV = Encoding.UTF8.GetBytes(iv);
			aes.Mode = CipherMode.CBC;
			aes.Padding = PaddingMode.PKCS7;
			ICryptoTransform transform = aes.CreateDecryptor(aes.Key, aes.IV);
			using (MemoryStream memoryStream = new MemoryStream(cipherText))
			&#123;
				using (CryptoStream cryptoStream = new CryptoStream(memoryStream, transform, CryptoStreamMode.Read))
				&#123;
					using (StreamReader streamReader = new StreamReader(cryptoStream))
					&#123;
						result = streamReader.ReadToEnd();
					&#125;
				&#125;
			&#125;
		&#125;
		return result;
	&#125;
</code></pre>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250226102715355.png" alt="image-20250226102715355"></p>
<p>赛博厨子一把梭</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250226102816918.png" alt="image-20250226102816918"></p>
<p><strong>HZNUCTF{de20-70dd-4e62-b8d0-06e}</strong></p>
<hr>
<h3 id="蛇年的本命语言"><a href="#蛇年的本命语言" class="headerlink" title="蛇年的本命语言"></a>蛇年的本命语言</h3><p>考点总结：python逆向，z3，自定义加密，变量名混淆</p>
<p>题目描述：如题…flag的格式为HZNUCTF{}</p>
<p>WP：</p>
<p>附件是个python的exe，运行的时候可能会提示缺少python38.dll，在同级目录放一个就好了</p>
<p>用pyinstxtractor解包，然后找到output.pyc，直接用uncompyle6反编译，得到伪代码</p>
<pre><code class="language-python"># uncompyle6 version 3.9.2
# Python bytecode version base 3.8.0 (3413)
# Decompiled from: Python 3.8.10 (tags/v3.8.10:3d8993a, May  3 2021, 11:48:03) [MSC v.1928 64 bit (AMD64)]
# Embedded file name: output.py
from collections import Counter
print(&quot;Welcome to HZNUCTF!!!&quot;)
print(&quot;Plz input the flag:&quot;)
ooo0oOoooOOO0 = input()
oOO0OoOoo000 = Counter(ooo0oOoooOOO0)
O0o00 = &quot;&quot;.join((str(oOO0OoOoo000[oOooo0OOO]) for oOooo0OOO in ))
print(&quot;ans1: &quot;, end=&quot;&quot;)
print(O0o00)
if O0o00 != &quot;111111116257645365477364777645752361&quot;:
    print(&quot;wrong_wrong!!!&quot;)
    exit(1)
iiIII = &quot;&quot;
for oOooo0OOO in ooo0oOoooOOO0:
    if oOO0OoOoo000[oOooo0OOO] &gt; 0:
        iiIII += oOooo0OOO + str(oOO0OoOoo000[oOooo0OOO])
        oOO0OoOoo000[oOooo0OOO] = 0
    else:
        i11i1Iii1I1 = [ord(oOooo0OOO) for oOooo0OOO in iiIII]
        ii1iIi1i11i = [
         7 * i11i1Iii1I1[0] == 504,
         9 * i11i1Iii1I1[0] - 5 * i11i1Iii1I1[1] == 403,
         2 * i11i1Iii1I1[0] - 5 * i11i1Iii1I1[1] + 10 * i11i1Iii1I1[2] == 799,
         3 * i11i1Iii1I1[0] + 8 * i11i1Iii1I1[1] + 15 * i11i1Iii1I1[2] + 20 * i11i1Iii1I1[3] == 2938,
         5 * i11i1Iii1I1[0] + 15 * i11i1Iii1I1[1] + 20 * i11i1Iii1I1[2] - 19 * i11i1Iii1I1[3] + 1 * i11i1Iii1I1[4] == 2042,
         7 * i11i1Iii1I1[0] + 1 * i11i1Iii1I1[1] + 9 * i11i1Iii1I1[2] - 11 * i11i1Iii1I1[3] + 2 * i11i1Iii1I1[4] + 5 * i11i1Iii1I1[5] == 1225,
         11 * i11i1Iii1I1[0] + 22 * i11i1Iii1I1[1] + 33 * i11i1Iii1I1[2] + 44 * i11i1Iii1I1[3] + 55 * i11i1Iii1I1[4] + 66 * i11i1Iii1I1[5] - 77 * i11i1Iii1I1[6] == 7975,
         21 * i11i1Iii1I1[0] + 23 * i11i1Iii1I1[1] + 3 * i11i1Iii1I1[2] + 24 * i11i1Iii1I1[3] - 55 * i11i1Iii1I1[4] + 6 * i11i1Iii1I1[5] - 7 * i11i1Iii1I1[6] + 15 * i11i1Iii1I1[7] == 229,
         2 * i11i1Iii1I1[0] + 26 * i11i1Iii1I1[1] + 13 * i11i1Iii1I1[2] + 0 * i11i1Iii1I1[3] - 65 * i11i1Iii1I1[4] + 15 * i11i1Iii1I1[5] + 29 * i11i1Iii1I1[6] + 1 * i11i1Iii1I1[7] + 20 * i11i1Iii1I1[8] == 2107,
         10 * i11i1Iii1I1[0] + 7 * i11i1Iii1I1[1] + -9 * i11i1Iii1I1[2] + 6 * i11i1Iii1I1[3] + 7 * i11i1Iii1I1[4] + 1 * i11i1Iii1I1[5] + 22 * i11i1Iii1I1[6] + 21 * i11i1Iii1I1[7] - 22 * i11i1Iii1I1[8] + 30 * i11i1Iii1I1[9] == 4037,
         15 * i11i1Iii1I1[0] + 59 * i11i1Iii1I1[1] + 56 * i11i1Iii1I1[2] + 66 * i11i1Iii1I1[3] + 7 * i11i1Iii1I1[4] + 1 * i11i1Iii1I1[5] - 122 * i11i1Iii1I1[6] + 21 * i11i1Iii1I1[7] + 32 * i11i1Iii1I1[8] + 3 * i11i1Iii1I1[9] - 10 * i11i1Iii1I1[10] == 4950,
         13 * i11i1Iii1I1[0] + 66 * i11i1Iii1I1[1] + 29 * i11i1Iii1I1[2] + 39 * i11i1Iii1I1[3] - 33 * i11i1Iii1I1[4] + 13 * i11i1Iii1I1[5] - 2 * i11i1Iii1I1[6] + 42 * i11i1Iii1I1[7] + 62 * i11i1Iii1I1[8] + 1 * i11i1Iii1I1[9] - 10 * i11i1Iii1I1[10] + 11 * i11i1Iii1I1[11] == 12544,
         23 * i11i1Iii1I1[0] + 6 * i11i1Iii1I1[1] + 29 * i11i1Iii1I1[2] + 3 * i11i1Iii1I1[3] - 3 * i11i1Iii1I1[4] + 63 * i11i1Iii1I1[5] - 25 * i11i1Iii1I1[6] + 2 * i11i1Iii1I1[7] + 32 * i11i1Iii1I1[8] + 1 * i11i1Iii1I1[9] - 10 * i11i1Iii1I1[10] + 11 * i11i1Iii1I1[11] - 12 * i11i1Iii1I1[12] == 6585,
         223 * i11i1Iii1I1[0] + 6 * i11i1Iii1I1[1] - 29 * i11i1Iii1I1[2] - 53 * i11i1Iii1I1[3] - 3 * i11i1Iii1I1[4] + 3 * i11i1Iii1I1[5] - 65 * i11i1Iii1I1[6] + 0 * i11i1Iii1I1[7] + 36 * i11i1Iii1I1[8] + 1 * i11i1Iii1I1[9] - 15 * i11i1Iii1I1[10] + 16 * i11i1Iii1I1[11] - 18 * i11i1Iii1I1[12] + 13 * i11i1Iii1I1[13] == 6893,
         29 * i11i1Iii1I1[0] + 13 * i11i1Iii1I1[1] - 9 * i11i1Iii1I1[2] - 93 * i11i1Iii1I1[3] + 33 * i11i1Iii1I1[4] + 6 * i11i1Iii1I1[5] + 65 * i11i1Iii1I1[6] + 1 * i11i1Iii1I1[7] - 36 * i11i1Iii1I1[8] + 0 * i11i1Iii1I1[9] - 16 * i11i1Iii1I1[10] + 96 * i11i1Iii1I1[11] - 68 * i11i1Iii1I1[12] + 33 * i11i1Iii1I1[13] - 14 * i11i1Iii1I1[14] == 1883,
         69 * i11i1Iii1I1[0] + 77 * i11i1Iii1I1[1] - 93 * i11i1Iii1I1[2] - 12 * i11i1Iii1I1[3] + 0 * i11i1Iii1I1[4] + 0 * i11i1Iii1I1[5] + 1 * i11i1Iii1I1[6] + 16 * i11i1Iii1I1[7] + 36 * i11i1Iii1I1[8] + 6 * i11i1Iii1I1[9] + 19 * i11i1Iii1I1[10] + 66 * i11i1Iii1I1[11] - 8 * i11i1Iii1I1[12] + 38 * i11i1Iii1I1[13] - 16 * i11i1Iii1I1[14] + 15 * i11i1Iii1I1[15] == 8257,
         23 * i11i1Iii1I1[0] + 2 * i11i1Iii1I1[1] - 3 * i11i1Iii1I1[2] - 11 * i11i1Iii1I1[3] + 12 * i11i1Iii1I1[4] + 24 * i11i1Iii1I1[5] + 1 * i11i1Iii1I1[6] + 6 * i11i1Iii1I1[7] + 14 * i11i1Iii1I1[8] - 0 * i11i1Iii1I1[9] + 1 * i11i1Iii1I1[10] + 68 * i11i1Iii1I1[11] - 18 * i11i1Iii1I1[12] + 68 * i11i1Iii1I1[13] - 26 * i11i1Iii1I1[14] + 15 * i11i1Iii1I1[15] - 16 * i11i1Iii1I1[16] == 5847,
         24 * i11i1Iii1I1[0] + 0 * i11i1Iii1I1[1] - 1 * i11i1Iii1I1[2] - 15 * i11i1Iii1I1[3] + 13 * i11i1Iii1I1[4] + 4 * i11i1Iii1I1[5] + 16 * i11i1Iii1I1[6] + 67 * i11i1Iii1I1[7] + 146 * i11i1Iii1I1[8] - 50 * i11i1Iii1I1[9] + 16 * i11i1Iii1I1[10] + 6 * i11i1Iii1I1[11] - 1 * i11i1Iii1I1[12] + 69 * i11i1Iii1I1[13] - 27 * i11i1Iii1I1[14] + 45 * i11i1Iii1I1[15] - 6 * i11i1Iii1I1[16] + 17 * i11i1Iii1I1[17] == 18257,
         25 * i11i1Iii1I1[0] + 26 * i11i1Iii1I1[1] - 89 * i11i1Iii1I1[2] + 16 * i11i1Iii1I1[3] + 19 * i11i1Iii1I1[4] + 44 * i11i1Iii1I1[5] + 36 * i11i1Iii1I1[6] + 66 * i11i1Iii1I1[7] - 150 * i11i1Iii1I1[8] - 250 * i11i1Iii1I1[9] + 166 * i11i1Iii1I1[10] + 126 * i11i1Iii1I1[11] - 11 * i11i1Iii1I1[12] + 690 * i11i1Iii1I1[13] - 207 * i11i1Iii1I1[14] + 46 * i11i1Iii1I1[15] + 6 * i11i1Iii1I1[16] + 7 * i11i1Iii1I1[17] - 18 * i11i1Iii1I1[18] == 12591,
         5 * i11i1Iii1I1[0] + 26 * i11i1Iii1I1[1] + 8 * i11i1Iii1I1[2] + 160 * i11i1Iii1I1[3] + 9 * i11i1Iii1I1[4] - 4 * i11i1Iii1I1[5] + 36 * i11i1Iii1I1[6] + 6 * i11i1Iii1I1[7] - 15 * i11i1Iii1I1[8] - 20 * i11i1Iii1I1[9] + 66 * i11i1Iii1I1[10] + 16 * i11i1Iii1I1[11] - 1 * i11i1Iii1I1[12] + 690 * i11i1Iii1I1[13] - 20 * i11i1Iii1I1[14] + 46 * i11i1Iii1I1[15] + 6 * i11i1Iii1I1[16] + 7 * i11i1Iii1I1[17] - 18 * i11i1Iii1I1[18] + 19 * i11i1Iii1I1[19] == 52041,
         29 * i11i1Iii1I1[0] - 26 * i11i1Iii1I1[1] + 0 * i11i1Iii1I1[2] + 60 * i11i1Iii1I1[3] + 90 * i11i1Iii1I1[4] - 4 * i11i1Iii1I1[5] + 6 * i11i1Iii1I1[6] + 6 * i11i1Iii1I1[7] - 16 * i11i1Iii1I1[8] - 21 * i11i1Iii1I1[9] + 69 * i11i1Iii1I1[10] + 6 * i11i1Iii1I1[11] - 12 * i11i1Iii1I1[12] + 69 * i11i1Iii1I1[13] - 20 * i11i1Iii1I1[14] - 46 * i11i1Iii1I1[15] + 65 * i11i1Iii1I1[16] + 0 * i11i1Iii1I1[17] - 1 * i11i1Iii1I1[18] + 39 * i11i1Iii1I1[19] - 20 * i11i1Iii1I1[20] == 20253,
         45 * i11i1Iii1I1[0] - 56 * i11i1Iii1I1[1] + 10 * i11i1Iii1I1[2] + 650 * i11i1Iii1I1[3] - 900 * i11i1Iii1I1[4] + 44 * i11i1Iii1I1[5] + 66 * i11i1Iii1I1[6] - 6 * i11i1Iii1I1[7] - 6 * i11i1Iii1I1[8] - 21 * i11i1Iii1I1[9] + 9 * i11i1Iii1I1[10] - 6 * i11i1Iii1I1[11] - 12 * i11i1Iii1I1[12] + 69 * i11i1Iii1I1[13] - 2 * i11i1Iii1I1[14] - 406 * i11i1Iii1I1[15] + 651 * i11i1Iii1I1[16] + 2 * i11i1Iii1I1[17] - 10 * i11i1Iii1I1[18] + 69 * i11i1Iii1I1[19] - 0 * i11i1Iii1I1[20] + 21 * i11i1Iii1I1[21] == 18768,
         555 * i11i1Iii1I1[0] - 6666 * i11i1Iii1I1[1] + 70 * i11i1Iii1I1[2] + 510 * i11i1Iii1I1[3] - 90 * i11i1Iii1I1[4] + 499 * i11i1Iii1I1[5] + 66 * i11i1Iii1I1[6] - 66 * i11i1Iii1I1[7] - 610 * i11i1Iii1I1[8] - 221 * i11i1Iii1I1[9] + 9 * i11i1Iii1I1[10] - 23 * i11i1Iii1I1[11] - 102 * i11i1Iii1I1[12] + 6 * i11i1Iii1I1[13] + 2050 * i11i1Iii1I1[14] - 406 * i11i1Iii1I1[15] + 665 * i11i1Iii1I1[16] + 333 * i11i1Iii1I1[17] + 100 * i11i1Iii1I1[18] + 609 * i11i1Iii1I1[19] + 777 * i11i1Iii1I1[20] + 201 * i11i1Iii1I1[21] - 22 * i11i1Iii1I1[22] == 111844,
         1 * i11i1Iii1I1[0] - 22 * i11i1Iii1I1[1] + 333 * i11i1Iii1I1[2] + 4444 * i11i1Iii1I1[3] - 5555 * i11i1Iii1I1[4] + 6666 * i11i1Iii1I1[5] - 666 * i11i1Iii1I1[6] + 676 * i11i1Iii1I1[7] - 660 * i11i1Iii1I1[8] - 22 * i11i1Iii1I1[9] + 9 * i11i1Iii1I1[10] - 73 * i11i1Iii1I1[11] - 107 * i11i1Iii1I1[12] + 6 * i11i1Iii1I1[13] + 250 * i11i1Iii1I1[14] - 6 * i11i1Iii1I1[15] + 65 * i11i1Iii1I1[16] + 39 * i11i1Iii1I1[17] + 10 * i11i1Iii1I1[18] + 69 * i11i1Iii1I1[19] + 777 * i11i1Iii1I1[20] + 201 * i11i1Iii1I1[21] - 2 * i11i1Iii1I1[22] + 23 * i11i1Iii1I1[23] == 159029,
         520 * i11i1Iii1I1[0] - 222 * i11i1Iii1I1[1] + 333 * i11i1Iii1I1[2] + 4 * i11i1Iii1I1[3] - 56655 * i11i1Iii1I1[4] + 6666 * i11i1Iii1I1[5] + 666 * i11i1Iii1I1[6] + 66 * i11i1Iii1I1[7] - 60 * i11i1Iii1I1[8] - 220 * i11i1Iii1I1[9] + 99 * i11i1Iii1I1[10] + 73 * i11i1Iii1I1[11] + 1007 * i11i1Iii1I1[12] + 7777 * i11i1Iii1I1[13] + 2500 * i11i1Iii1I1[14] + 6666 * i11i1Iii1I1[15] + 605 * i11i1Iii1I1[16] + 390 * i11i1Iii1I1[17] + 100 * i11i1Iii1I1[18] + 609 * i11i1Iii1I1[19] + 99999 * i11i1Iii1I1[20] + 210 * i11i1Iii1I1[21] + 232 * i11i1Iii1I1[22] + 23 * i11i1Iii1I1[23] - 24 * i11i1Iii1I1[24] == 2762025,
         1323 * i11i1Iii1I1[0] - 22 * i11i1Iii1I1[1] + 333 * i11i1Iii1I1[2] + 4 * i11i1Iii1I1[3] - 55 * i11i1Iii1I1[4] + 666 * i11i1Iii1I1[5] + 666 * i11i1Iii1I1[6] + 66 * i11i1Iii1I1[7] - 660 * i11i1Iii1I1[8] - 220 * i11i1Iii1I1[9] + 99 * i11i1Iii1I1[10] + 3 * i11i1Iii1I1[11] + 100 * i11i1Iii1I1[12] + 777 * i11i1Iii1I1[13] + 2500 * i11i1Iii1I1[14] + 6666 * i11i1Iii1I1[15] + 605 * i11i1Iii1I1[16] + 390 * i11i1Iii1I1[17] + 100 * i11i1Iii1I1[18] + 609 * i11i1Iii1I1[19] + 9999 * i11i1Iii1I1[20] + 210 * i11i1Iii1I1[21] + 232 * i11i1Iii1I1[22] + 23 * i11i1Iii1I1[23] - 24 * i11i1Iii1I1[24] + 25 * i11i1Iii1I1[25] == 1551621,
         777 * i11i1Iii1I1[0] - 22 * i11i1Iii1I1[1] + 6969 * i11i1Iii1I1[2] + 4 * i11i1Iii1I1[3] - 55 * i11i1Iii1I1[4] + 666 * i11i1Iii1I1[5] - 6 * i11i1Iii1I1[6] + 96 * i11i1Iii1I1[7] - 60 * i11i1Iii1I1[8] - 220 * i11i1Iii1I1[9] + 99 * i11i1Iii1I1[10] + 3 * i11i1Iii1I1[11] + 100 * i11i1Iii1I1[12] + 777 * i11i1Iii1I1[13] + 250 * i11i1Iii1I1[14] + 666 * i11i1Iii1I1[15] + 65 * i11i1Iii1I1[16] + 90 * i11i1Iii1I1[17] + 100 * i11i1Iii1I1[18] + 609 * i11i1Iii1I1[19] + 999 * i11i1Iii1I1[20] + 21 * i11i1Iii1I1[21] + 232 * i11i1Iii1I1[22] + 23 * i11i1Iii1I1[23] - 24 * i11i1Iii1I1[24] + 25 * i11i1Iii1I1[25] - 26 * i11i1Iii1I1[26] == 948348,
         97 * i11i1Iii1I1[0] - 22 * i11i1Iii1I1[1] + 6969 * i11i1Iii1I1[2] + 4 * i11i1Iii1I1[3] - 56 * i11i1Iii1I1[4] + 96 * i11i1Iii1I1[5] - 6 * i11i1Iii1I1[6] + 96 * i11i1Iii1I1[7] - 60 * i11i1Iii1I1[8] - 20 * i11i1Iii1I1[9] + 99 * i11i1Iii1I1[10] + 3 * i11i1Iii1I1[11] + 10 * i11i1Iii1I1[12] + 707 * i11i1Iii1I1[13] + 250 * i11i1Iii1I1[14] + 666 * i11i1Iii1I1[15] + -9 * i11i1Iii1I1[16] + 90 * i11i1Iii1I1[17] + -2 * i11i1Iii1I1[18] + 609 * i11i1Iii1I1[19] + 0 * i11i1Iii1I1[20] + 21 * i11i1Iii1I1[21] + 2 * i11i1Iii1I1[22] + 23 * i11i1Iii1I1[23] - 24 * i11i1Iii1I1[24] + 25 * i11i1Iii1I1[25] - 26 * i11i1Iii1I1[26] + 27 * i11i1Iii1I1[27] == 777044,
         177 * i11i1Iii1I1[0] - 22 * i11i1Iii1I1[1] + 699 * i11i1Iii1I1[2] + 64 * i11i1Iii1I1[3] - 56 * i11i1Iii1I1[4] - 96 * i11i1Iii1I1[5] - 66 * i11i1Iii1I1[6] + 96 * i11i1Iii1I1[7] - 60 * i11i1Iii1I1[8] - 20 * i11i1Iii1I1[9] + 99 * i11i1Iii1I1[10] + 3 * i11i1Iii1I1[11] + 10 * i11i1Iii1I1[12] + 707 * i11i1Iii1I1[13] + 250 * i11i1Iii1I1[14] + 666 * i11i1Iii1I1[15] + -9 * i11i1Iii1I1[16] + 0 * i11i1Iii1I1[17] + -2 * i11i1Iii1I1[18] + 69 * i11i1Iii1I1[19] + 0 * i11i1Iii1I1[20] + 21 * i11i1Iii1I1[21] + 222 * i11i1Iii1I1[22] + 23 * i11i1Iii1I1[23] - 224 * i11i1Iii1I1[24] + 25 * i11i1Iii1I1[25] - 26 * i11i1Iii1I1[26] + 27 * i11i1Iii1I1[27] - 28 * i11i1Iii1I1[28] == 185016,
         77 * i11i1Iii1I1[0] - 2 * i11i1Iii1I1[1] + 6 * i11i1Iii1I1[2] + 6 * i11i1Iii1I1[3] - 96 * i11i1Iii1I1[4] - 9 * i11i1Iii1I1[5] - 6 * i11i1Iii1I1[6] + 96 * i11i1Iii1I1[7] - 0 * i11i1Iii1I1[8] - 20 * i11i1Iii1I1[9] + 99 * i11i1Iii1I1[10] + 3 * i11i1Iii1I1[11] + 10 * i11i1Iii1I1[12] + 707 * i11i1Iii1I1[13] + 250 * i11i1Iii1I1[14] + 666 * i11i1Iii1I1[15] + -9 * i11i1Iii1I1[16] + 0 * i11i1Iii1I1[17] + -2 * i11i1Iii1I1[18] + 9 * i11i1Iii1I1[19] + 0 * i11i1Iii1I1[20] + 21 * i11i1Iii1I1[21] + 222 * i11i1Iii1I1[22] + 23 * i11i1Iii1I1[23] - 224 * i11i1Iii1I1[24] + 26 * i11i1Iii1I1[25] - -58 * i11i1Iii1I1[26] + 27 * i11i1Iii1I1[27] - 2 * i11i1Iii1I1[28] + 29 * i11i1Iii1I1[29] == 130106]
        if all(ii1iIi1i11i):
            print(&quot;Congratulation!!!&quot;)
        else:
            print(&quot;wrong_wrong!!!&quot;)
</code></pre>
<p>经过混淆的python代码，不过也就换了一些变量名啥的，自行替换一下就可以了</p>
<p>程序的整体逻辑就是先将输入的flag字符串中的每个字符的出现次数进行统计，然后将每个字符替换成其出现次数的那个数字，这是第一次check。接下来还是统计字符的出现次数，转换成特定排序的字符串，就是按顺序，每个字符后面跟的数字就是这个字符出现的次数，比如输入HZNUCTF{111}，那么就会输出H1Z1N1U1C1T1F1{113}1，最后进行方程式的约束检测</p>
<p>以下是解题脚本</p>
<pre><code class="language-python">from z3 import *

# 定义变量 enc[0] 到 enc[29]
enc = [Int(f&quot;enc_&#123;i&#125;&quot;) for i in range(30)]

# 创建求解器
solver = Solver()

# 定义方程组
equations = [
    7 * enc[0] == 504,
    9 * enc[0] - 5 * enc[1] == 403,
    2 * enc[0] - 5 * enc[1] + 10 * enc[2] == 799,
    3 * enc[0] + 8 * enc[1] + 15 * enc[2] + 20 * enc[3] == 2938,
    5 * enc[0] + 15 * enc[1] + 20 * enc[2] - 19 * enc[3] + 1 * enc[4] == 2042,
    7 * enc[0] + 1 * enc[1] + 9 * enc[2] - 11 * enc[3] + 2 * enc[4] + 5 * enc[5] == 1225,
    11 * enc[0] + 22 * enc[1] + 33 * enc[2] + 44 * enc[3] + 55 * enc[4] + 66 * enc[5] - 77 * enc[6] == 7975,
    21 * enc[0] + 23 * enc[1] + 3 * enc[2] + 24 * enc[3] - 55 * enc[4] + 6 * enc[5] - 7 * enc[6] + 15 * enc[7] == 229,
    2 * enc[0] + 26 * enc[1] + 13 * enc[2] + 0 * enc[3] - 65 * enc[4] + 15 * enc[5] + 29 * enc[6] + 1 * enc[7] + 20 *
    enc[8] == 2107,
    10 * enc[0] + 7 * enc[1] + -9 * enc[2] + 6 * enc[3] + 7 * enc[4] + 1 * enc[5] + 22 * enc[6] + 21 * enc[7] - 22 *
    enc[8] + 30 * enc[9] == 4037,
    15 * enc[0] + 59 * enc[1] + 56 * enc[2] + 66 * enc[3] + 7 * enc[4] + 1 * enc[5] - 122 * enc[6] + 21 * enc[7] + 32 *
    enc[8] + 3 * enc[9] - 10 * enc[10] == 4950,
    13 * enc[0] + 66 * enc[1] + 29 * enc[2] + 39 * enc[3] - 33 * enc[4] + 13 * enc[5] - 2 * enc[6] + 42 * enc[7] + 62 *
    enc[8] + 1 * enc[9] - 10 * enc[10] + 11 * enc[11] == 12544,
    23 * enc[0] + 6 * enc[1] + 29 * enc[2] + 3 * enc[3] - 3 * enc[4] + 63 * enc[5] - 25 * enc[6] + 2 * enc[7] + 32 *
    enc[8] + 1 * enc[9] - 10 * enc[10] + 11 * enc[11] - 12 * enc[12] == 6585,
    223 * enc[0] + 6 * enc[1] - 29 * enc[2] - 53 * enc[3] - 3 * enc[4] + 3 * enc[5] - 65 * enc[6] + 0 * enc[7] + 36 *
    enc[8] + 1 * enc[9] - 15 * enc[10] + 16 * enc[11] - 18 * enc[12] + 13 * enc[13] == 6893,
    29 * enc[0] + 13 * enc[1] - 9 * enc[2] - 93 * enc[3] + 33 * enc[4] + 6 * enc[5] + 65 * enc[6] + 1 * enc[7] - 36 *
    enc[8] + 0 * enc[9] - 16 * enc[10] + 96 * enc[11] - 68 * enc[12] + 33 * enc[13] - 14 * enc[14] == 1883,
    69 * enc[0] + 77 * enc[1] - 93 * enc[2] - 12 * enc[3] + 0 * enc[4] + 0 * enc[5] + 1 * enc[6] + 16 * enc[7] + 36 *
    enc[8] + 6 * enc[9] + 19 * enc[10] + 66 * enc[11] - 8 * enc[12] + 38 * enc[13] - 16 * enc[14] + 15 * enc[
        15] == 8257,
    23 * enc[0] + 2 * enc[1] - 3 * enc[2] - 11 * enc[3] + 12 * enc[4] + 24 * enc[5] + 1 * enc[6] + 6 * enc[7] + 14 *
    enc[8] - 0 * enc[9] + 1 * enc[10] + 68 * enc[11] - 18 * enc[12] + 68 * enc[13] - 26 * enc[14] + 15 * enc[15] - 16 *
    enc[16] == 5847,
    24 * enc[0] + 0 * enc[1] - 1 * enc[2] - 15 * enc[3] + 13 * enc[4] + 4 * enc[5] + 16 * enc[6] + 67 * enc[7] + 146 *
    enc[8] - 50 * enc[9] + 16 * enc[10] + 6 * enc[11] - 1 * enc[12] + 69 * enc[13] - 27 * enc[14] + 45 * enc[15] - 6 *
    enc[16] + 17 * enc[17] == 18257,
    25 * enc[0] + 26 * enc[1] - 89 * enc[2] + 16 * enc[3] + 19 * enc[4] + 44 * enc[5] + 36 * enc[6] + 66 * enc[
        7] - 150 * enc[8] - 250 * enc[9] + 166 * enc[10] + 126 * enc[11] - 11 * enc[12] + 690 * enc[13] - 207 * enc[
        14] + 46 * enc[15] + 6 * enc[16] + 7 * enc[17] - 18 * enc[18] == 12591,
    5 * enc[0] + 26 * enc[1] + 8 * enc[2] + 160 * enc[3] + 9 * enc[4] - 4 * enc[5] + 36 * enc[6] + 6 * enc[7] - 15 *
    enc[8] - 20 * enc[9] + 66 * enc[10] + 16 * enc[11] - 1 * enc[12] + 690 * enc[13] - 20 * enc[14] + 46 * enc[15] + 6 *
    enc[16] + 7 * enc[17] - 18 * enc[18] + 19 * enc[19] == 52041,
    29 * enc[0] - 26 * enc[1] + 0 * enc[2] + 60 * enc[3] + 90 * enc[4] - 4 * enc[5] + 6 * enc[6] + 6 * enc[7] - 16 *
    enc[8] - 21 * enc[9] + 69 * enc[10] + 6 * enc[11] - 12 * enc[12] + 69 * enc[13] - 20 * enc[14] - 46 * enc[15] + 65 *
    enc[16] + 0 * enc[17] - 1 * enc[18] + 39 * enc[19] - 20 * enc[20] == 20253,
    45 * enc[0] - 56 * enc[1] + 10 * enc[2] + 650 * enc[3] - 900 * enc[4] + 44 * enc[5] + 66 * enc[6] - 6 * enc[7] - 6 *
    enc[8] - 21 * enc[9] + 9 * enc[10] - 6 * enc[11] - 12 * enc[12] + 69 * enc[13] - 2 * enc[14] - 406 * enc[15] + 651 *
    enc[16] + 2 * enc[17] - 10 * enc[18] + 69 * enc[19] - 0 * enc[20] + 21 * enc[21] == 18768,
    555 * enc[0] - 6666 * enc[1] + 70 * enc[2] + 510 * enc[3] - 90 * enc[4] + 499 * enc[5] + 66 * enc[6] - 66 * enc[
        7] - 610 * enc[8] - 221 * enc[9] + 9 * enc[10] - 23 * enc[11] - 102 * enc[12] + 6 * enc[13] + 2050 * enc[
        14] - 406 * enc[15] + 665 * enc[16] + 333 * enc[17] + 100 * enc[18] + 609 * enc[19] + 777 * enc[20] + 201 * enc[
        21] - 22 * enc[22] == 111844,
    1 * enc[0] - 22 * enc[1] + 333 * enc[2] + 4444 * enc[3] - 5555 * enc[4] + 6666 * enc[5] - 666 * enc[6] + 676 * enc[
        7] - 660 * enc[8] - 22 * enc[9] + 9 * enc[10] - 73 * enc[11] - 107 * enc[12] + 6 * enc[13] + 250 * enc[14] - 6 *
    enc[15] + 65 * enc[16] + 39 * enc[17] + 10 * enc[18] + 69 * enc[19] + 777 * enc[20] + 201 * enc[21] - 2 * enc[
        22] + 23 * enc[23] == 159029,
    520 * enc[0] - 222 * enc[1] + 333 * enc[2] + 4 * enc[3] - 56655 * enc[4] + 6666 * enc[5] + 666 * enc[6] + 66 * enc[
        7] - 60 * enc[8] - 220 * enc[9] + 99 * enc[10] + 73 * enc[11] + 1007 * enc[12] + 7777 * enc[13] + 2500 * enc[
        14] + 6666 * enc[15] + 605 * enc[16] + 390 * enc[17] + 100 * enc[18] + 609 * enc[19] + 99999 * enc[20] + 210 *
    enc[21] + 232 * enc[22] + 23 * enc[23] - 24 * enc[24] == 2762025,
    1323 * enc[0] - 22 * enc[1] + 333 * enc[2] + 4 * enc[3] - 55 * enc[4] + 666 * enc[5] + 666 * enc[6] + 66 * enc[
        7] - 660 * enc[8] - 220 * enc[9] + 99 * enc[10] + 3 * enc[11] + 100 * enc[12] + 777 * enc[13] + 2500 * enc[
        14] + 6666 * enc[15] + 605 * enc[16] + 390 * enc[17] + 100 * enc[18] + 609 * enc[19] + 9999 * enc[20] + 210 *
    enc[21] + 232 * enc[22] + 23 * enc[23] - 24 * enc[24] + 25 * enc[25] == 1551621,
    777 * enc[0] - 22 * enc[1] + 6969 * enc[2] + 4 * enc[3] - 55 * enc[4] + 666 * enc[5] - 6 * enc[6] + 96 * enc[
        7] - 60 * enc[8] - 220 * enc[9] + 99 * enc[10] + 3 * enc[11] + 100 * enc[12] + 777 * enc[13] + 250 * enc[
        14] + 666 * enc[15] + 65 * enc[16] + 90 * enc[17] + 100 * enc[18] + 609 * enc[19] + 999 * enc[20] + 21 * enc[
        21] + 232 * enc[22] + 23 * enc[23] - 24 * enc[24] + 25 * enc[25] - 26 * enc[26] == 948348,
    97 * enc[0] - 22 * enc[1] + 6969 * enc[2] + 4 * enc[3] - 56 * enc[4] + 96 * enc[5] - 6 * enc[6] + 96 * enc[7] - 60 *
    enc[8] - 20 * enc[9] + 99 * enc[10] + 3 * enc[11] + 10 * enc[12] + 707 * enc[13] + 250 * enc[14] + 666 * enc[
        15] + -9 * enc[16] + 90 * enc[17] + -2 * enc[18] + 609 * enc[19] + 0 * enc[20] + 21 * enc[21] + 2 * enc[
        22] + 23 * enc[23] - 24 * enc[24] + 25 * enc[25] - 26 * enc[26] + 27 * enc[27] == 777044,
    177 * enc[0] - 22 * enc[1] + 699 * enc[2] + 64 * enc[3] - 56 * enc[4] - 96 * enc[5] - 66 * enc[6] + 96 * enc[
        7] - 60 * enc[8] - 20 * enc[9] + 99 * enc[10] + 3 * enc[11] + 10 * enc[12] + 707 * enc[13] + 250 * enc[
        14] + 666 * enc[15] + -9 * enc[16] + 0 * enc[17] + -2 * enc[18] + 69 * enc[19] + 0 * enc[20] + 21 * enc[
        21] + 222 * enc[22] + 23 * enc[23] - 224 * enc[24] + 25 * enc[25] - 26 * enc[26] + 27 * enc[27] - 28 * enc[
        28] == 185016,
    77 * enc[0] - 2 * enc[1] + 6 * enc[2] + 6 * enc[3] - 96 * enc[4] - 9 * enc[5] - 6 * enc[6] + 96 * enc[7] - 0 * enc[
        8] - 20 * enc[9] + 99 * enc[10] + 3 * enc[11] + 10 * enc[12] + 707 * enc[13] + 250 * enc[14] + 666 * enc[
        15] + -9 * enc[16] + 0 * enc[17] + -2 * enc[18] + 9 * enc[19] + 0 * enc[20] + 21 * enc[21] + 222 * enc[
        22] + 23 * enc[23] - 224 * enc[24] + 26 * enc[25] - -58 * enc[26] + 27 * enc[27] - 2 * enc[28] + 29 * enc[
        29] == 130106
]

# 将所有方程添加到求解器中
for eq in equations:
    solver.add(eq)

# 求解
if solver.check() == sat:
    model = solver.model()
    # 输出解
    result = [chr(model[enc[i]].as_long()) for i in range(30)]
    for i in range(30):
        print(result[i], end=&quot;&quot;)
else:
    print(&quot;没有解&quot;)
</code></pre>
<p>H1Z1N1U1C1T1F1{1a6d275f7-463}1拿到flag中所含的字符，那么就可以根据111111116257645365477364777645752361进行还原</p>
<p><strong>HZNUCTF{ad7fa-76a7-ff6a-fffa-7f7d6a}</strong></p>
<hr>
<h3 id="randomsystem"><a href="#randomsystem" class="headerlink" title="randomsystem"></a>randomsystem</h3><p>考点总结：自定义加密，伪随机，TLS回调，花指令</p>
<p>题目描述：名字乱取的…flag格式为HZNUCTF{}</p>
<p>WP：</p>
<p>题目附件无壳，直接ida64打开分析</p>
<pre><code class="language-c">__int64 sub_412370()
&#123;
  int v0; // edx
  int v1; // eax
  __int64 v3; // [esp-8h] [ebp-78Ch]
  char v4; // [esp+0h] [ebp-784h]
  char v5; // [esp+0h] [ebp-784h]
  char v6; // [esp+0h] [ebp-784h]
  char v7; // [esp+0h] [ebp-784h]
  char v8; // [esp+0h] [ebp-784h]
  int m; // [esp+250h] [ebp-534h]
  int k; // [esp+25Ch] [ebp-528h]
  unsigned int v11; // [esp+268h] [ebp-51Ch]
  int j; // [esp+274h] [ebp-510h]
  char v13; // [esp+283h] [ebp-501h]
  int i; // [esp+298h] [ebp-4ECh]
  int rand_num[34]; // [esp+2A4h] [ebp-4E0h] BYREF
  char Str[20]; // [esp+32Ch] [ebp-458h] BYREF
  int enc[66]; // [esp+340h] [ebp-444h] BYREF
  _OWORD v18[16]; // [esp+448h] [ebp-33Ch] BYREF
  char v19[264]; // [esp+550h] [ebp-234h] BYREF
  char Destination[96]; // [esp+658h] [ebp-12Ch] BYREF
  char v21; // [esp+6B8h] [ebp-CCh] BYREF
  char Source[76]; // [esp+6C0h] [ebp-C4h] BYREF
  int v23; // [esp+70Ch] [ebp-78h] BYREF
  int v24; // [esp+710h] [ebp-74h]
  int v25; // [esp+714h] [ebp-70h]
  int v26; // [esp+718h] [ebp-6Ch]
  char v27; // [esp+71Ch] [ebp-68h]
  int v28[4]; // [esp+728h] [ebp-5Ch] BYREF
  char v29[72]; // [esp+738h] [ebp-4Ch] BYREF
  int savedregs; // [esp+784h] [ebp+0h] BYREF

  sub_41137A(&amp;unk_41E0A9);
  v23 = 0;
  v24 = 0;
  v25 = 0;
  v26 = 0;
  v27 = 0;
  j_memset(v19, 0, 0x100u);
  j_memset(v18, 0, sizeof(v18));
  strcpy(Str, &quot;KeYkEy!!&quot;);
  enc[0] = 376;
  enc[1] = 356;
  enc[2] = 169;
  enc[3] = 501;
  enc[4] = 277;
  enc[5] = 329;
  enc[6] = 139;
  enc[7] = 342;
  enc[8] = 380;
  enc[9] = 365;
  enc[10] = 162;
  enc[11] = 258;
  enc[12] = 381;
  enc[13] = 339;
  enc[14] = 347;
  enc[15] = 307;
  enc[16] = 263;
  enc[17] = 359;
  enc[18] = 162;
  enc[19] = 484;
  enc[20] = 310;
  enc[21] = 333;
  enc[22] = 346;
  enc[23] = 339;
  enc[24] = 150;
  enc[25] = 194;
  enc[26] = 175;
  enc[27] = 344;
  enc[28] = 158;
  enc[29] = 250;
  enc[30] = 128;
  enc[31] = 175;
  enc[32] = 158;
  enc[33] = 173;
  enc[34] = 152;
  enc[35] = 379;
  enc[36] = 158;
  enc[37] = 292;
  enc[38] = 130;
  enc[39] = 365;
  enc[40] = 197;
  enc[41] = 20;
  enc[42] = 197;
  enc[43] = 161;
  enc[44] = 198;
  enc[45] = 10;
  enc[46] = 207;
  enc[47] = 244;
  enc[48] = 202;
  enc[49] = 14;
  enc[50] = 204;
  enc[51] = 176;
  enc[52] = 193;
  enc[53] = 255;
  enc[54] = 35;
  enc[55] = 7;
  enc[56] = 158;
  enc[57] = 181;
  enc[58] = 145;
  enc[59] = 353;
  enc[60] = 153;
  enc[61] = 357;
  enc[62] = 246;
  enc[63] = 151;
  printf(&quot;Welcome to HZNUCTF!!!\n&quot;, v4);
  printf(&quot;Enter something: \n&quot;, v5);
  scanf(&quot;%64s&quot;, (char)v29);
  sub_411339(v29, v28);                         // // 将以二进制形式输入的key先转成十六进制
  sub_41128F(v28[0], v28[1], &amp;v23);
  if ( (char)v23 == 53                          // // 对key的检查
    &amp;&amp; SBYTE1(v23) == 50
    &amp;&amp; SBYTE2(v23) == 54
    &amp;&amp; SHIBYTE(v23) == 53
    &amp;&amp; (char)v24 == 53
    &amp;&amp; SBYTE1(v24) == 54
    &amp;&amp; SBYTE2(v24) == 54
    &amp;&amp; SHIBYTE(v24) == 53
    &amp;&amp; (char)v25 == 53
    &amp;&amp; SBYTE1(v25) == 50
    &amp;&amp; SBYTE2(v25) == 54
    &amp;&amp; SHIBYTE(v25) == 53
    &amp;&amp; (char)v26 == 53
    &amp;&amp; SBYTE1(v26) == 51
    &amp;&amp; SBYTE2(v26) == 54
    &amp;&amp; SHIBYTE(v26) == 53 )
  &#123;
    printf(&quot;good_job!!!\n&quot;, v6);
    printf(&quot;So, Plz input the flag:\n&quot;, v7);
    scanf(&quot;%73s&quot;, (char)&amp;v21);
    strncpy_s(Destination, 0x41u, Source, 0x40u);
    sub_41127B();
    srand(Seed);                                // 伪随机初始化，但是这里的seed并不是看到的0，而是经过tls回调函数重新赋值的2025
    sub_41127B();
    j_memset(rand_num, 0, 0x80u);
    for ( i = 0; i &lt; 32; ++i )                  // 伪随机数组
    &#123;
      do
      &#123;
        rand();
        v1 = sub_41127B() % 32;
        v13 = 1;
        for ( j = 0; j &lt; i; ++j )
        &#123;
          if ( rand_num[j] == v1 )
          &#123;
            v13 = 0;
            break;
          &#125;
        &#125;
      &#125;
      while ( !v13 );
      rand_num[i] = v1;
    &#125;
    sub_41105F(Destination, rand_num);          // 对flag大括号里的内容进行处理，以生成的伪随机数作为下标进行打乱。但是有花指令
    sub_411307(v19, Destination);               // 将打乱后的flag大括号的内容处理为8*8的矩阵
    sub_411334(&amp;v23, Str);                      // key的再赋值
    sub_4112DA(&amp;dword_41C368, v19, v18);        // 矩阵乘法
    v11 = 0;
    for ( k = 0; k &lt; 8; ++k )
    &#123;
      for ( m = 0; m &lt; 8; ++m )
      &#123;
        *((_DWORD *)&amp;v18[2 * k] + m) ^= Str[v11 % j_strlen(Str)];
        ++v11;
      &#125;
    &#125;
    if ( sub_411078(v18, enc) == 1 )
      printf(&quot;Congratulation!!!\n&quot;, v8);
  &#125;
  else
  &#123;
    printf(&quot;wrong_wrong!!!\n&quot;, v6);
  &#125;
  sub_41120D(&amp;savedregs, &amp;dword_412D48, 0, v0);
  return v3;
&#125;
</code></pre>
<p>main函数里的各个函数的逻辑都已注释好，但是有些函数在反编译时需要去花，考查的都是一些常见的花指令</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301181238957.png" alt="image-20250301181238957"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301181306358.png" alt="image-20250301181306358"></p>
<p>sub_41105F函数</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301181412591.png" alt="image-20250301181412591"></p>
<p>sub_411334函数</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301173037500.png" alt="image-20250301173037500"></p>
<p>sub_4112DA函数</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301181720994.png" alt="image-20250301181720994"></p>
<p>sub_411307函数</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301173312623.png" alt="image-20250301173312623"></p>
<p>TLS回调函数</p>
<pre><code class="language-c">__int64 __userpurge TlsCallback_0_0@&lt;edx:eax&gt;(int a1@&lt;eax&gt;, int a2@&lt;edx&gt;, int a3, int a4, int a5)
&#123;
  __int64 v6; // [esp-8h] [ebp-200h]
  int j; // [esp+D0h] [ebp-128h]
  int i; // [esp+DCh] [ebp-11Ch]
  int v9; // [esp+E8h] [ebp-110h]
  int v10[65]; // [esp+F4h] [ebp-104h] BYREF
  int savedregs; // [esp+1F8h] [ebp+0h] BYREF

  Seed = 2025;
  v10[0] = 1;
  v10[1] = 1;
  v10[2] = 0;
  v10[3] = 1;
  v10[4] = 0;
  v10[5] = 0;
  v10[6] = 1;
  v10[7] = 0;
  v10[8] = 0;
  v10[9] = 1;
  v10[10] = 1;
  v10[11] = 0;
  v10[12] = 0;
  v10[13] = 1;
  v10[14] = 0;
  v10[15] = 1;
  v10[16] = 0;
  v10[17] = 0;
  v10[18] = 1;
  v10[19] = 1;
  v10[20] = 0;
  v10[21] = 1;
  v10[22] = 1;
  memset(&amp;v10[23], 0, 16);
  v10[27] = 1;
  v10[28] = 0;
  v10[29] = 1;
  v10[30] = 0;
  v10[31] = 1;
  v10[32] = 0;
  v10[33] = 1;
  v10[34] = 0;
  v10[35] = 0;
  v10[36] = 1;
  v10[37] = 0;
  v10[38] = 1;
  memset(&amp;v10[39], 0, 24);
  v10[45] = 1;
  v10[46] = 0;
  v10[47] = 1;
  memset(&amp;v10[48], 0, 24);
  v10[54] = 1;
  v10[55] = 1;
  v10[56] = 0;
  v10[57] = 1;
  v10[58] = 1;
  memset(&amp;v10[59], 0, 16);
  v10[63] = 1;
  v9 = 0;
  for ( i = 0; i &lt; 8; ++i )
  &#123;
    for ( j = 0; j &lt; 8; ++j )
    &#123;
      a2 = v10[v9];
      dword_41C368[8 * i + j] = a2;
      ++v9;
    &#125;
    a1 = i + 1;
  &#125;
  sub_41120D(&amp;savedregs, &amp;dword_411B50, a1, a2);
  return v6;
&#125;
</code></pre>
<p>至于key的由来，注意观察</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301182215231.png" alt="image-20250301182215231"></p>
<p>以及sub_411334函数的逻辑，可知key就是<strong>ReVeReSe</strong>，然后将其转为二进制，就是我们最开始输入程序的内容。</p>
<p>那么就可以写脚本解密了，先解异或，然后再来算矩阵</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main() &#123;
int enc[64];
    enc[0] = 376;
    enc[1] = 356;
    enc[2] = 169;
    enc[3] = 501;
    enc[4] = 277;
    enc[5] = 329;
    enc[6] = 139;
    enc[7] = 342;
    enc[8] = 380;
    enc[9] = 365;
    enc[10] = 162;
    enc[11] = 258;
    enc[12] = 381;
    enc[13] = 339;
    enc[14] = 347;
    enc[15] = 307;
    enc[16] = 263;
    enc[17] = 359;
    enc[18] = 162;
    enc[19] = 484;
    enc[20] = 310;
    enc[21] = 333;
    enc[22] = 346;
    enc[23] = 339;
    enc[24] = 150;
    enc[25] = 194;
    enc[26] = 175;
    enc[27] = 344;
    enc[28] = 158;
    enc[29] = 250;
    enc[30] = 128;
    enc[31] = 175;
    enc[32] = 158;
    enc[33] = 173;
    enc[34] = 152;
    enc[35] = 379;
    enc[36] = 158;
    enc[37] = 292;
    enc[38] = 130;
    enc[39] = 365;
    enc[40] = 197;
    enc[41] = 20;
    enc[42] = 197;
    enc[43] = 161;
    enc[44] = 198;
    enc[45] = 10;
    enc[46] = 207;
    enc[47] = 244;
    enc[48] = 202;
    enc[49] = 14;
    enc[50] = 204;
    enc[51] = 176;
    enc[52] = 193;
    enc[53] = 255;
    enc[54] = 35;
    enc[55] = 7;
    enc[56] = 158;
    enc[57] = 181;
    enc[58] = 145;
    enc[59] = 353;
    enc[60] = 153;
    enc[61] = 357;
    enc[62] = 246;
    enc[63] = 151;
    char key[9] = &quot;ReVeReSe&quot;;
    
    for (int i = 0; i &lt; 64; i++) &#123;
        enc[i] ^= key[i % 8];
        printf(&quot;%d &quot;, enc[i]);
    &#125;
    return 0;
&#125;
</code></pre>
<blockquote>
<p>298 257 255 400 327 300 216 307 302 264 244 359 303 310 264 342 341 258 244 385 356 296 265 310 196 167 249 317 204 159 211 202 204 200 206 286 204 321 209 264 151 113 147 196 148 111 156 145 152 107 154 213 147 154 112 98 204 208 199 260 203 256 165 242</p>
</blockquote>
<p>然后求与flag填充的矩阵相乘的矩阵的逆矩阵，可以使用在线网站</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301182503632.png" alt="image-20250301182503632"></p>
<p>然后将结果和脚本解出的数据进行相乘</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250301183206092.png" alt="image-20250301183206092"></p>
<p>然后将结果提出来</p>
<pre><code class="language-c">#include&lt;stdio.h&gt;

int main() &#123;
   int enc[8][8] = &#123;&#123;102,100,49,49,118,53,54,100&#125;,&#123;52,53,52,114,54,102,52,97&#125;,&#123;99,98,45,49,101,97,56,100&#125;,&#123;45,54,102,121,56,48,55,57&#125;,&#123;53,97,102,56,51,122,102,114&#125;,&#123;98,56,45,99,100,54,99,100&#125;,&#123;99,50,52,116,99,97,55,53&#125;,&#123;53,57,102,97,48,57,57,45&#125;&#125;;
   for (int i = 0; i &lt; 8; i++) &#123;
		for (int j = 0; j &lt; 8; j++) &#123;
			printf(&quot;%c&quot;, enc[i][j]);
		&#125;
   &#125;
&#125;
</code></pre>
<p>运行结果是fd11v56d454r6f4acb-1ea8d-6fy80795af83zfrb8-cd6cdc24tca7559fa099-</p>
<p>就差最后一步了，还原正确flag的次序</p>
<p>伪随机的种子是2025，根据伪代码的逻辑，生成32个不重复的伪随机数，并且都小于32，然后进行还原</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;
#include &lt;string.h&gt;
#include &lt;stdbool.h&gt;
#include &lt;time.h&gt;
#include &lt;windows.h&gt;

int main() &#123;
	int seed = 2025;
	srand(seed);
	int rand_num[32] = &#123; 0 &#125;;
	for (int i = 0; i &lt; 32; i++) &#123;
		int enc;
		bool is_unique;
		do &#123;
			enc = rand() % 32;
			is_unique = true;
			for (int j = 0; j &lt; i; j++) &#123;
				if (rand_num[j] == enc) &#123;
					is_unique = false;
					break;
				&#125;
			&#125;
		&#125; while (!is_unique); // 如果重复，重新生成随机数
		rand_num[i] = enc; // 将不重复的随机数放入数组
	&#125;
   	char enc[] = &quot;fd11v56d454r6f4acb-1ea8d-6fy80795af83zfrb8-cd6cdc24tca7559fa099-&quot;;
	size_t len = strlen(enc);
	for (int i = 0; i &lt; len / 2; i++) &#123;
			char temp = enc[i];
			enc[i] = enc[len - rand_num[i] - 1];
			enc[len - rand_num[i] - 1] = temp;
	&#125;
	printf(&quot;%s&quot;, enc);
   	return 0;
&#125;
</code></pre>
<p>拿到flag大括号的内容</p>
<p>3zfb899ac5c256d-7a8r59f0tccd-4fa6b8vfd111-a44ffy4r0-6dce5679da58</p>
<p>flag就是<strong>HZNUCTF{3zfb899ac5c256d-7a8r59f0tccd-4fa6b8vfd111-a44ffy4r0-6dce5679da58}</strong></p>
<hr>
<h3 id="index"><a href="#index" class="headerlink" title="index"></a>index</h3><p>考点总结：wasm，自定义加密，伪随机</p>
<p>题目描述：名字乱取的…flag格式为HZNUCTF{}</p>
<p>WP：</p>
<p>在出这题的时候出题人还不知道<strong>ghidra</strong>装插件之后可以很好的反编译wasm，那么现在有了的话就可以不那么痛苦的去手撕.o了。</p>
<p>并且这个题在开始的时候还是有些问题的，就是在伪随机数产生的时候，那个RAND_MAX，最开始没管这个数，结果导致我的源码和生成后的wasm中的数不一样，一个是0x7FFF，一个是0x7FFFFFFF，前者是源码中的，后者是附件中的，导致解密出问题。给受到影响的师傅磕一个了orz；同时感谢yuro orz。(下次测题得仔细点)当然，这个题最后还是有些问题，就是动态调试的时候还是有些问题，有些数据不知道被写到哪里去了…(以后不出这种不稳点的题了…)</p>
<p>插件的网址</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/nneonneo/ghidra-wasm-plugin/">https://github.com/nneonneo/ghidra-wasm-plugin/</a></p>
</blockquote>
<p>安装好之后，修一下wasm文件的文件头，附件中是大写的.ASM，标准的应该是.asm，改一下，就可以直接用ghidra分析了</p>
<p>反编译完成之后，<strong>unnamed_function_12</strong>就是主函数了，很清晰</p>
<pre><code class="language-c">undefined4 unnamed_function_12(void)

&#123;
  int iVar1;
  undefined8 *local_80 [4];
  undefined8 *local_70;
  int local_6c;
  int local_68;
  int local_64;
  byte local_60 [32];
  undefined8 local_40;
  undefined local_38;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  undefined local_10;
  undefined4 local_4;
  
  local_4 = 0;
  local_10 = 0;
  local_18 = 0;
  local_20 = 0;
  local_28 = 0;
  local_30 = 0;
  local_38 = 0;
  local_40 = 0;
  local_60[0x18] = 0;
  local_60[0x19] = 0;
  local_60[0x1a] = 0;
  local_60[0x1b] = 0;
  local_60[0x1c] = 0;
  local_60[0x1d] = 0;
  local_60[0x1e] = 0;
  local_60[0x1f] = 0;
  local_60[0x10] = 0;
  local_60[0x11] = 0;
  local_60[0x12] = 0;
  local_60[0x13] = 0;
  local_60[0x14] = 0;
  local_60[0x15] = 0;
  local_60[0x16] = 0;
  local_60[0x17] = 0;
  local_60[8] = 0;
  local_60[9] = 0;
  local_60[10] = 0;
  local_60[0xb] = 0;
  local_60[0xc] = 0;
  local_60[0xd] = 0;
  local_60[0xe] = 0;
  local_60[0xf] = 0;
  local_60[0] = 0;
  local_60[1] = 0;
  local_60[2] = 0;
  local_60[3] = 0;
  local_60[4] = 0;
  local_60[5] = 0;
  local_60[6] = 0;
  local_60[7] = 0;
  unnamed_function_14(s_Welcome_to_HZNUCTF!!!_ram_000100ae,0);
  unnamed_function_14(s_Plz_input_the_key:_ram_00010051,0);
  local_70 = &amp;local_40;
  unnamed_function_17(0x10026,&amp;local_70);
  iVar1 = unnamed_function_21(&amp;local_40,0x11020);
  if (iVar1 == 0) &#123;
    unnamed_function_7(&amp;local_40);
    unnamed_function_14(s_Ok,_let&#39;s_go!!!_ram_0001007a,0);
    unnamed_function_14(s_Plz_input_the_flag:_ram_00010065,0);
    local_80[0] = &amp;local_30;
    unnamed_function_17(0x10026,local_80);
    iVar1 = unnamed_function_22(&amp;local_30);
    if (iVar1 == 0x20) &#123;
      unnamed_function_9(&amp;local_30,local_60);
      for (local_64 = 0; local_64 &lt; 8; local_64 = local_64 + 1) &#123;
        unnamed_function_11(local_60 + local_64 * 4,&amp;local_40);
      &#125;
      for (local_68 = 0; local_68 &lt; 8; local_68 = local_68 + 1) &#123;
        for (local_6c = 0; local_6c &lt; 4; local_6c = local_6c + 1) &#123;
          if ((uint)local_60[local_6c + local_68 * 4] !=
              *(uint *)(local_68 * 0x10 + 0x10fa0 + local_6c * 4)) &#123;
            unnamed_function_14(s_wrong_wrong!!!_ram_00010042,0);
            return 0;
          &#125;
        &#125;
      &#125;
      unnamed_function_14(s_Congratulation!!!_ram_0001008b,0);
    &#125;
    else &#123;
      unnamed_function_14(s_wrong_wrong!!!_ram_00010042,0);
    &#125;
  &#125;
  else &#123;
    unnamed_function_14(s_wrong_wrong!!!_ram_0001009e,0);
  &#125;
  return 0;
&#125;
</code></pre>
<p>整体逻辑就是先输入key，然后判断key是否正确，接着对key进行异或处理，xor0x51， 完了输入flag，检查长度是否是32，接下来就是对flag字符顺序进行打乱，打乱完之后就进行异或处理。</p>
<p>接下来进行仔细分析</p>
<p><strong>unnamed_function_21</strong>函数就是cmp，将输入的key进行比较，0x11020就是正确的key的存储地址，双击跳转过去即可拿到正确的key，</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250413111916618.png" alt="image-20250413111916618"></p>
<p>然后进入<strong>unnamed_function_7</strong>进行key的异或，xor 0x51</p>
<pre><code class="language-c">void unnamed_function_7(int param1)

&#123;
  int iVar1;
  undefined4 local_c;
  
  iVar1 = unnamed_function_22(param1);
  for (local_c = 0; local_c &lt; iVar1; local_c = local_c + 1) &#123;
    *(byte *)(param1 + local_c) = *(byte *)(param1 + local_c) ^ 0x51;
  &#125;
  return;
&#125;
</code></pre>
<p>接下来输入flag，然后判断长度，然后进入<strong>unnamed_function_9</strong>函数进行打乱</p>
<pre><code class="language-c">void unnamed_function_9(int param1,int param2)

&#123;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  
  local_c = 0;
  unnamed_function_15(0x194);
  unnamed_function_8(param1,0x20);
  for (local_10 = 0; local_10 &lt; 8; local_10 = local_10 + 1) &#123;
    for (local_14 = 0; local_14 &lt; 4; local_14 = local_14 + 1) &#123;
      *(undefined *)(param2 + local_10 * 4 + local_14) = *(undefined *)(param1 + local_c);
      local_c = local_c + 1;
    &#125;
  &#125;
  return;
&#125;
</code></pre>
<p><strong>unnamed_function_15</strong>函数就是srand函数，<strong>seed</strong>就是0x194(转过来就是404)，然后进入<strong>unnamed_function_8</strong>进行打乱</p>
<pre><code class="language-c">void unnamed_function_8(int param1,int param2)

&#123;
  undefined uVar1;
  int iVar2;
  byte local_11;
  undefined4 i;
  
  if (1 &lt; param2) &#123;
    for (i = 0; i &lt; param2 + -1; i = i + 1) &#123;
      iVar2 = rand();
      iVar2 = i + iVar2 / (0x7fff / (param2 - i) + 1);
      uVar1 = *(undefined *)(param1 + iVar2);
      *(undefined *)(param1 + iVar2) = *(undefined *)(param1 + i);
      *(undefined *)(param1 + i) = uVar1;
    &#125;
  &#125;
  return;
&#125;
</code></pre>
<p>先生成一个规定范围的伪随机数，然后进行字符顺序打乱</p>
<p>回到<strong>unnamed_function_9</strong>函数，然后对字符进行分组处理</p>
<p>最后进到<strong>unnamed_function_11</strong>函数中进行异或加密，</p>
<pre><code class="language-c">void unnamed_function_11(int param1,int param2)

&#123;
  int iVar1;
  uint uVar2;
  undefined4 local_1c;
  byte local_15;
  byte local_9;
  
  iVar1 = (int)*(char *)(param2 + iRam00011200) &gt;&gt; 4;
  uVar2 = (int)*(char *)(param2 + iRam00011200) &amp; 0xf;
  iRam00011200 = iRam00011200 + 1;
  unnamed_function_10(0x10ea0,(int)*(char *)(iVar1 * 0x10 + 0x10da0 + uVar2));
  for (local_1c = 0; local_1c &lt; 4; local_1c = local_1c + 1) &#123;
    *(byte *)(param1 + local_1c) =
         *(byte *)(param1 + local_1c) ^ *(byte *)(iVar1 * 0x10 + local_1c * 0x11 + uVar2 + 0x10ea0);
    *(byte *)(param1 + local_1c) = *(byte *)(param1 + local_1c) ^ *(byte *)(local_1c + 0x11020);
  &#125;
  return;
&#125;
</code></pre>
<p>对传进来的key，分别取高四位和低四位，作为横坐标和纵坐标，在SboxAes数组中取数，给到一个新的数组，然后再将这个数组和和SboxSm4数组进行异或，得到加密之后的数组，再和flag进行第一次异或，接着flag再和未异或处理之前的key进行第二次异或加密，完成所有加密，最后和密文进行比对。</p>
<p>密文的地址是<strong>0x10fa0</strong>，</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250413113825136.png" alt="image-20250413113825136"></p>
<p>下面就是解密脚本了</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;
#include &lt;string.h&gt;
#include &lt;stdbool.h&gt;
#include &lt;time.h&gt;
#include &lt;stdlib.h&gt;
unsigned char SboxAes[16][16] = &#123;
	&#123;0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76&#125;,
	&#123;0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0&#125;,
	&#123;0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15&#125;,
	&#123;0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75&#125;,
	&#123;0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84&#125;,
	&#123;0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF&#125;,
	&#123;0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8&#125;,
	&#123;0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2&#125;,
	&#123;0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73&#125;,
	&#123;0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB&#125;,
	&#123;0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79&#125;,
	&#123;0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08&#125;,
	&#123;0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A&#125;,
	&#123;0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E&#125;,
	&#123;0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF&#125;,
	&#123;0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16&#125;
&#125;;
int SboxSm4[256] = &#123;
	0xd6,0x90,0xe9,0xfe,0xcc,0xe1,0x3d,0xb7,0x16,0xb6,0x14,0xc2,0x28,0xfb,0x2c,0x05,
	0x2b,0x67,0x9a,0x76,0x2a,0xbe,0x04,0xc3,0xaa,0x44,0x13,0x26,0x49,0x86,0x06,0x99,
	0x9c,0x42,0x50,0xf4,0x91,0xef,0x98,0x7a,0x33,0x54,0x0b,0x43,0xed,0xcf,0xac,0x62,
	0xe4,0xb3,0x1c,0xa9,0xc9,0x08,0xe8,0x95,0x80,0xdf,0x94,0xfa,0x75,0x8f,0x3f,0xa6,
	0x47,0x07,0xa7,0xfc,0xf3,0x73,0x17,0xba,0x83,0x59,0x3c,0x19,0xe6,0x85,0x4f,0xa8,
	0x68,0x6b,0x81,0xb2,0x71,0x64,0xda,0x8b,0xf8,0xeb,0x0f,0x4b,0x70,0x56,0x9d,0x35,
	0x1e,0x24,0x0e,0x5e,0x63,0x58,0xd1,0xa2,0x25,0x22,0x7c,0x3b,0x01,0x21,0x78,0x87,
	0xd4,0x00,0x46,0x57,0x9f,0xd3,0x27,0x52,0x4c,0x36,0x02,0xe7,0xa0,0xc4,0xc8,0x9e,
	0xea,0xbf,0x8a,0xd2,0x40,0xc7,0x38,0xb5,0xa3,0xf7,0xf2,0xce,0xf9,0x61,0x15,0xa1,
	0xe0,0xae,0x5d,0xa4,0x9b,0x34,0x1a,0x55,0xad,0x93,0x32,0x30,0xf5,0x8c,0xb1,0xe3,
	0x1d,0xf6,0xe2,0x2e,0x82,0x66,0xca,0x60,0xc0,0x29,0x23,0xab,0x0d,0x53,0x4e,0x6f,
	0xd5,0xdb,0x37,0x45,0xde,0xfd,0x8e,0x2f,0x03,0xff,0x6a,0x72,0x6d,0x6c,0x5b,0x51,
	0x8d,0x1b,0xaf,0x92,0xbb,0xdd,0xbc,0x7f,0x11,0xd9,0x5c,0x41,0x1f,0x10,0x5a,0xd8,
	0x0a,0xc1,0x31,0x88,0xa5,0xcd,0x7b,0xbd,0x2d,0x74,0xd0,0x12,0xb8,0xe5,0xb4,0xb0,
	0x89,0x69,0x97,0x4a,0x0c,0x96,0x77,0x7e,0x65,0xb9,0xf1,0x09,0xc5,0x6e,0xc6,0x84,
	0x18,0xf0,0x7d,0xec,0x3a,0xdc,0x4d,0x20,0x79,0xee,0x5f,0x3e,0xd7,0xcb,0x39,0x48
&#125;;

int keyIndex = 0;
char realKey[9] = &quot;TGCTF404&quot;;

void xor_box(int* sbox, char keyChar) &#123;
	for (int i = 0; i &lt; 256; i++) &#123;
		sbox[i] ^= keyChar;
        sbox[i] &amp;= 0xFF;
	&#125;
&#125;

void decode(int* group, char* key) &#123;
    char Char = key[keyIndex++];
    int r = Char &gt;&gt; 4;
    int l = (Char &amp; 0x0F);
    char keyChar = SboxAes[r][l];

    xor_box(SboxSm4, keyChar);

    for (int i = 0; i &lt; 4; i++) &#123;
        group[i] ^= SboxSm4[(r + i) * 16 + (l + i)];
        group[i] ^= realKey[i];
    &#125;
&#125;

int main() &#123;
    char flag[33] = &#123; 0 &#125;;
    char key[9] = &quot;TGCTF404&quot;;
    int index = 0;
    srand(404);
    int enc[8][4] = &#123;&#123;0x84, 0x1c, 0x6b, 0xf7&#125;,
                    &#123;0x49, 0x22, 0xd6, 0x42 &#125;,
                    &#123;0x50, 0x7b, 0x42, 0xf4 &#125;,
                    &#123;0x46, 0xa9, 0x83, 0x62 &#125;,
                    &#123;0xd1, 0x32, 0x80, 0x42 &#125;,
                    &#123;0x6a, 0x10, 0xa3, 0xf2 &#125;,
                    &#123;0xe2, 0xb8, 0x0b, 0x76 &#125;,
                    &#123;0xb0, 0xdc, 0x02, 0x51 &#125;&#125;;
    for (int i = 0; i &lt; 8; i++) &#123;
        key[i] = (key[i] ^ 0x51) &amp; 0xFF;
        printf(&quot;%02x &quot;, key[i]);
    &#125;
    printf(&quot;\n&quot;);

    for (int i = 0; i &lt; 8; i++) &#123;
        decode(enc[i], key);
    &#125;

    for (int i = 0; i &lt; 8; i++) &#123;
		for (int j = 0; j &lt; 4; j++) &#123;
            flag[index++] = enc[i][j] &amp; 0xFF;
		&#125;
	&#125;
    
    int n = 32;
    for (int i = 0; i &lt; n - 1; i++) &#123;
			int j = i + rand() / (0x7fff / (n - i) + 1);
            printf(&quot;%d &quot;, j);
	&#125;
    printf(&quot;\n&quot;);
    printf(&quot;%s&quot;, flag);
    return 0;
&#125;
</code></pre>
<pre><code class="language-python">enc = &quot;Z49H539c&#123;--6&#125;d4888bTUCf8NeFe--e9&quot;
index = [1, 24, 28, 24, 16, 25, 22, 29, 29, 12,
         17, 19, 31, 13, 18, 19, 30, 31, 27, 25,
         24, 30, 29, 25, 28, 27, 29, 27, 30, 29, 30]
enc_list = list(enc)
for i in range(len(index) - 1, -1, -1):  # 从最后一个交换开始
    j = index[i]
    enc_list[i], enc_list[j] = enc_list[j], enc_list[i]
print(&quot;&quot;.join(enc_list))
</code></pre>
<p><strong>HZNUCTF{f898-de85-46e-9e43-b9c8}</strong></p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 1621925986@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">💰</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23lif2sndX4YqUPQwk',
            clientSecret: 'c76a4c487d51bf36e4dd1496b3f44bdbea037d50',
            repo: 'NshIdE1.github.io',
            owner: 'NshIdE1',
            admin: ['NshIdE1'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2024-2025 NshIdE
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
