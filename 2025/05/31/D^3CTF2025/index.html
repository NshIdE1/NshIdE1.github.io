<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>D^3CTF2025 | NshIdE&#39;s Home</title>
  <meta name="keywords" content=" CTF , RE , WritesUp , Android ">
  <meta name="description" content="D^3CTF2025 | NshIdE&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="tags">
<meta property="og:url" content="https://nshide1.github.io/tags/">
<meta property="og:site_name" content="NshIdE&#39;s Home">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-03-04T12:20:04.979Z">
<meta property="article:modified_time" content="2025-03-04T12:20:04.979Z">
<meta property="article:author" content="NshIdE">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/logo.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/logo.jpg"/>
</a>
<div class="author">
    <span>NshIdE</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/NshIdE1/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://www.csdn.net/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=1621925986&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(40)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="其他">
            
            其他
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Android-RE">
            
            Android-RE
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Android学习">
            
            Android学习
            <small>(9)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Angr入门">
            
            Angr入门
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="CTF">
            
            CTF
            <small>(15)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Frida入门">
            
            Frida入门
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Java学习">
            
            Java学习
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Unidbg学习">
            
            Unidbg学习
            <small>(10)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="40">
<input type="hidden" id="yelog_site_word_count" value="221.9k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://bananashipsbbq.github.io/">bananaships</a></li>
            
            <li><a target="_blank" href="https://astralprisma.github.io/">AstralPrisma</a></li>
            
            <li><a target="_blank" href="https://monoceros406.github.io/">Monoceros406</a></li>
            
            <li><a target="_blank" href="https://github.com/Thir0th">Thir0th</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>抽象</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>符号执行</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>取证</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>应急响应</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Frida</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>go</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Harmony</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>il2Cpps</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>iOS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ISW</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SIMD</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unidbg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Unity</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>WritesUp</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All CTF "
           href="/2025/10/25/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%BC%BA%E7%BD%91%C2%B7%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android,il2Cpps"
           data-author="" >
            <span class="post-title" title="第八届强网·拟态防御国际精英挑战赛">第八届强网·拟态防御国际精英挑战赛</span>
            <span class="post-date" title="2025-10-25 17:31:37">2025/10/25</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/10/22/Android%20APP%20%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android APP 常见漏洞">Android APP 常见漏洞</span>
            <span class="post-date" title="2025-10-22 17:06:07">2025/10/22</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/10/10/%E4%BB%8E%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20PackageInfo%20%E5%92%8C%20LoadedApk/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="从源码分析 PackageInfo 和 LoadedApk">从源码分析 PackageInfo 和 LoadedApk</span>
            <span class="post-date" title="2025-10-10 18:15:17">2025/10/10</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/09/09/2025%E5%B9%B4%E6%B9%BE%E5%8C%BA%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%88%9D%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025年湾区杯网络安全大赛初赛">2025年湾区杯网络安全大赛初赛</span>
            <span class="post-date" title="2025-09-09 09:34:17">2025/09/09</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/09/08/Android%20SO%20%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android SO 文件加载过程">Android SO 文件加载过程</span>
            <span class="post-date" title="2025-09-08 17:18:50">2025/09/08</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/25/Dex%20%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Dex 文件结构学习">Dex 文件结构学习</span>
            <span class="post-date" title="2025-08-25 17:33:29">2025/08/25</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/19/ClassLoader%20%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="ClassLoader 机制">ClassLoader 机制</span>
            <span class="post-date" title="2025-08-19 17:42:51">2025/08/19</span>
        </a>
        
        
        <a  class="All Java学习 "
           href="/2025/08/19/Java%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"
           data-tag="Android,Java"
           data-author="" >
            <span class="post-title" title="Java学习----反射机制">Java学习----反射机制</span>
            <span class="post-date" title="2025-08-19 17:00:02">2025/08/19</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/19/Android%20%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android 应用启动流程">Android 应用启动流程</span>
            <span class="post-date" title="2025-08-19 11:14:13">2025/08/19</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/19/%E5%AE%89%E5%8D%93%E5%8A%A0%E5%9B%BA%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="安卓加固学习记录">安卓加固学习记录</span>
            <span class="post-date" title="2025-08-19 10:50:46">2025/08/19</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/14/Android%20%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94NDK%20%E5%BC%80%E5%8F%91/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android 开发--NDK 开发">Android 开发--NDK 开发</span>
            <span class="post-date" title="2025-08-14 17:56:58">2025/08/14</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/08/10/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%85%AD)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(六)">从实践中学习unidbg使用(六)</span>
            <span class="post-date" title="2025-08-10 10:25:02">2025/08/10</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/08/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%94)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(五)">从实践中学习unidbg使用(五)</span>
            <span class="post-date" title="2025-08-08 17:45:59">2025/08/08</span>
        </a>
        
        
        <a  class="All Android学习 "
           href="/2025/08/05/%E6%BC%AB%E8%B0%88%E5%94%AF%E4%B8%80%E8%AE%BE%E5%A4%87ID/"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="漫谈唯一设备 ID">漫谈唯一设备 ID</span>
            <span class="post-date" title="2025-08-05 18:00:44">2025/08/05</span>
        </a>
        
        
        <a  class="All 其他 "
           href="/2025/07/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20Linux%20%E7%B3%BB%E7%BB%9F%E4%B8%8B%20proc%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AE%B9/"
           data-tag="Android,Linux"
           data-author="" >
            <span class="post-title" title="浅谈 Linux 系统下 proc 文件系统内容">浅谈 Linux 系统下 proc 文件系统内容</span>
            <span class="post-date" title="2025-07-24 17:56:57">2025/07/24</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/24/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%BA%8C%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg 中处理文件访问(二)">Unidbg 中处理文件访问(二)</span>
            <span class="post-date" title="2025-07-24 17:00:12">2025/07/24</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/07/23/2025%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B-%E5%88%9D%E8%B5%9B-%E5%AE%89%E5%8D%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E5%85%A8/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="2025第十届游戏安全竞赛-初赛-安卓客户端安全">2025第十届游戏安全竞赛-初赛-安卓客户端安全</span>
            <span class="post-date" title="2025-07-23 15:32:11">2025/07/23</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/19/%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%92%8C%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="创建模拟器和加载模块">创建模拟器和加载模块</span>
            <span class="post-date" title="2025-07-19 15:14:29">2025/07/19</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/15/Unidbg%20%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E4%B8%80%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="Unidbg 中处理文件访问(一)">Unidbg 中处理文件访问(一)</span>
            <span class="post-date" title="2025-07-15 16:52:06">2025/07/15</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/08/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E5%9B%9B)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(四)">从实践中学习unidbg使用(四)</span>
            <span class="post-date" title="2025-07-08 11:44:49">2025/07/08</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/07/01/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%89)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(三)">从实践中学习unidbg使用(三)</span>
            <span class="post-date" title="2025-07-01 15:29:42">2025/07/01</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/06/07/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmonyCTF/"
           data-tag="CTF,RE,WritesUp,Harmony"
           data-author="" >
            <span class="post-title" title="第一届OpenHarmonyCTF">第一届OpenHarmonyCTF</span>
            <span class="post-date" title="2025-06-07 13:32:45">2025/06/07</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/06/04/%E8%A1%A5%E5%BA%93%E5%87%BD%E6%95%B0%EF%BC%88%E4%BA%94%EF%BC%89/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="补库函数(五)">补库函数(五)</span>
            <span class="post-date" title="2025-06-04 19:07:56">2025/06/04</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/06/02/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%BA%8C)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(二)">从实践中学习unidbg使用(二)</span>
            <span class="post-date" title="2025-06-02 15:33:15">2025/06/02</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/31/D%5E3CTF2025/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="D^3CTF2025">D^3CTF2025</span>
            <span class="post-date" title="2025-05-31 16:21:11">2025/05/31</span>
        </a>
        
        
        <a  class="All Unidbg学习 "
           href="/2025/05/28/%E4%BB%8E%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%AD%A6%E4%B9%A0unidbg%E4%BD%BF%E7%94%A8(%E4%B8%80)/"
           data-tag="Unidbg"
           data-author="" >
            <span class="post-title" title="从实践中学习unidbg使用(一)">从实践中学习unidbg使用(一)</span>
            <span class="post-date" title="2025-05-28 16:39:23">2025/05/28</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/05/17/Parloo2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="Parloo RE">Parloo RE</span>
            <span class="post-date" title="2025-05-17 09:34:20">2025/05/17</span>
        </a>
        
        
        <a  class="All Android-RE "
           href="/2025/05/07/%E8%AE%B0%E4%B8%80%E6%AC%A1APK%E5%88%86%E6%9E%90/"
           data-tag="RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="记一次APK分析">记一次APK分析</span>
            <span class="post-date" title="2025-05-07 21:12:00">2025/05/07</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/26/%E4%B8%80%E9%81%93%E5%BE%88%E9%80%86%E5%A4%A9%E7%9A%84RC4/"
           data-tag="CTF,RE,WritesUp,抽象"
           data-author="" >
            <span class="post-title" title="抽象RC4">抽象RC4</span>
            <span class="post-date" title="2025-04-26 22:21:19">2025/04/26</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/24/%E5%BE%88%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="很有意思的一道题">很有意思的一道题</span>
            <span class="post-date" title="2025-04-24 21:56:18">2025/04/24</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/23/%E4%BA%AC%E9%BA%92CTF2025%20%E7%83%AD%E8%BA%AB%E8%B5%9B/"
           data-tag="CTF,RE,WritesUp,iOS,SIMD"
           data-author="" >
            <span class="post-title" title="京麒CTF2025热身赛">京麒CTF2025热身赛</span>
            <span class="post-date" title="2025-04-23 13:33:59">2025/04/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/14/TGCTF2025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TGCTF2025 RE">TGCTF2025 RE</span>
            <span class="post-date" title="2025-04-14 18:51:29">2025/04/14</span>
        </a>
        
        
        <a  class="All Angr入门 "
           href="/2025/04/14/Angr%E5%85%A5%E9%97%A8/"
           data-tag="符号执行"
           data-author="" >
            <span class="post-title" title="Angr入门">Angr入门</span>
            <span class="post-date" title="2025-04-14 18:50:44">2025/04/14</span>
        </a>
        
        
        <a  class="All Frida入门 "
           href="/2025/04/14/Frida%E5%85%A5%E9%97%A8/"
           data-tag="Android,Frida"
           data-author="" >
            <span class="post-title" title="Frida入门">Frida入门</span>
            <span class="post-date" title="2025-04-14 18:47:37">2025/04/14</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/04/12/TEXSAWCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TEXSAWCTF 2025">TEXSAWCTF 2025</span>
            <span class="post-date" title="2025-04-12 15:32:31">2025/04/12</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/23/NCTF2024/"
           data-tag="CTF,RE,WritesUp,vm,go"
           data-author="" >
            <span class="post-title" title="NCTF2024">NCTF2024</span>
            <span class="post-date" title="2025-03-23 11:58:53">2025/03/23</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/18/CISCN%20x%20CCB%20%E5%8D%8A%E5%86%B3%E8%B5%9B%202025%20ISW(%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94)/"
           data-tag="ISW,应急响应,取证"
           data-author="" >
            <span class="post-title" title="CISCN x CCB 半决赛 2025 ISW(应急响应)">CISCN x CCB 半决赛 2025 ISW(应急响应)</span>
            <span class="post-date" title="2025-03-18 10:24:23">2025/03/18</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/11/TPCTF%202025/"
           data-tag="CTF,RE,WritesUp"
           data-author="" >
            <span class="post-title" title="TPCTF 2025">TPCTF 2025</span>
            <span class="post-date" title="2025-03-11 21:41:19">2025/03/11</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/06/VishwaCTF2025/"
           data-tag="CTF,RE,WritesUp,Android,Unity"
           data-author="" >
            <span class="post-title" title="VishwaCTF2025">VishwaCTF2025</span>
            <span class="post-date" title="2025-03-06 21:52:51">2025/03/06</span>
        </a>
        
        
        <a  class="All CTF "
           href="/2025/03/03/HGAME%20RE/"
           data-tag="CTF,RE,WritesUp,Android"
           data-author="" >
            <span class="post-title" title="HGAME-RE-WEEK1">HGAME-RE-WEEK1</span>
            <span class="post-date" title="2025-03-03 22:20:33">2025/03/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-D^3CTF2025" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">D^3CTF2025</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="CTF">CTF</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color4">CTF</a>
            
            <a class="color3">RE</a>
            
            <a class="color4">WritesUp</a>
            
            <a class="color3">Android</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-06-03 21:36:27'>2025-05-31 16:21</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:4.9k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#D-3CTF2025"><span class="toc-text">D^3CTF2025</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#d3rpg-revenge"><span class="toc-text">d3rpg-revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#d3piano"><span class="toc-text">d3piano</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-text">一、前言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%BC%80%E5%A7%8B"><span class="toc-text">二、开始</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%BB%93%E8%AF%AD"><span class="toc-text">三、结语</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-text">最后</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="D-3CTF2025"><a href="#D-3CTF2025" class="headerlink" title="D^3CTF2025"></a>D^3CTF2025</h1><h3 id="d3rpg-revenge"><a href="#d3rpg-revenge" class="headerlink" title="d3rpg-revenge"></a>d3rpg-revenge</h3><p>是一个游戏，并且随着在游戏中的对话，会改变程序的内存(不可恢复，除非删了重来)。然后玩了下，发现走到二楼和NPC直接对话，会问你是reverse手，misc手还是musc手，选reverse手就会直接让你输入flag，然后回车，显示checking…，再回车，就会有回显，由于附件中有exe和不少dll，并且还有一个自定义的文件，.d3ssad文件。分析结果是：脱壳后的<strong>secret_dll.dll</strong>中的check_flag函数中的字符串就是密文<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/a50912a3fc754cffe94fc13fba5a6d9b.png" alt="a50912a3fc754cffe94fc13fba5a6d9b"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/ad9c8b1f242312c34bc5bb485d49039c.png" alt="ad9c8b1f242312c34bc5bb485d49039c"></p>
<p>然后加密逻辑在<strong>d3rpg.dll</strong>文件中进行载入，载入的内容应该是<strong>d3rpg.d3ssad</strong>文件进行解密的结果(应该是这样)。那么我们知道当程序运行的时候，check flag的时候，肯定会将自定义的文件进行解密，加载到内存中，然后调用其中逻辑，进行check。既然如此，我们就可以用ce，重开游戏，直接走到二楼，和NPC对话，直接输入flag，然后回车，让程序就断在checking…这里，然后用ce去内存中找，找到加密逻辑<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250531162103708.png" alt="image-20250531162103708"></p>
<pre><code class="language-ruby">module Scene_RPG
  class Secret_Class
    DELTA = 0x1919810 | (($de1ta + 1) * 0xf0000000)
    def initialize(new_key)
      @key = str_to_longs(new_key)
      if @key.length &lt; 4
        @key.length.upto(4) &#123; |i| @key[i] = 0 &#125;
      end
    end
    def self.str_to_longs(s, include_count = false)
      s = s.dup
      length = s.length
      ((4 - s.length % 4) &amp; 3).times &#123; s &lt;&lt; &quot;\0&quot; &#125;
      unpacked = s.unpack(&#39;V*&#39;).collect &#123; |n| int32 n &#125;
      unpacked &lt;&lt; length if include_count
      unpacked
    end
    def str_to_longs(s, include_count = false)
      self.class.str_to_longs s, include_count
    end
    def self.longs_to_str(l, count_included = false)
      s = l.pack(&#39;V*&#39;)
      s = s[0...(l[-1])] if count_included
      s
    end
    def longs_to_str(l, count_included = false)
      self.class.longs_to_str l, count_included
    end
    def self.int32(n)
      n -= 4_294_967_296 while (n &gt;= 2_147_483_648)
      n += 4_294_967_296 while (n &lt;= -2_147_483_648)
      n.to_i
    end
    def int32(n)
      self.class.int32 n
    end

    def mx(z, y, sum, p, e)
      int32(
        ((z &gt;&gt; 5 &amp; 0x07FFFFFF) ^ (y &lt;&lt; 2)) +
        ((y &gt;&gt; 3 &amp; 0x1FFFFFFF) ^ (z &lt;&lt; 4))
      ) ^ int32((sum ^ y) + (@key[(p &amp; 3) ^ e] ^ z))
    end
    def self.encrypt(key, plaintext)
      self.new(key).encrypt(plaintext)
    end
    def encrypt(plaintext)
      return &#39;&#39; if plaintext.length == 0
      v = str_to_longs(plaintext, true)
      v[1] = 0 if v.length == 1
      n = v.length - 1
      z = v[n]
      y = v[0]
      q = (6 + 52 / (n + 1)).floor
      sum = $de1ta * DELTA
      p = 0
      while(0 &lt;= (q -= 1)) do
        sum = int32(sum + DELTA)
        e = sum &gt;&gt; 2 &amp; 3
        n.times do |i|
          y = v[i + 1];
          z = v[i] = int32(v[i] + mx(z, y, sum, i, e))
          p = i
        end
        p += 1
        y = v[0];
        z = v[p] = int32(v[p] + mx(z, y, sum, p, e))
      end
      longs_to_str(v).unpack(&#39;a*&#39;).pack(&#39;m&#39;).delete(&quot;\n&quot;)
    end
    def self.decrypt(key, ciphertext)
      self.new(key).decrypt(ciphertext)
    end
  end
end

def validate_flag(input_flag)
  c_flag = input_flag + &quot;\0&quot;
  result = $check_flag.call(c_flag)
  result == 1
end


def check
  flag = $game_party.actors[0].name
  key = Scene_RPG::Secret_Class.new(&#39;rpgmakerxp_D3CTF&#39;)
  cyphertext = key.encrypt(flag)
  if validate_flag(cyphertext)
    $game_variables[1] = 100
  else
    $game_variables[1] = 0
  end
end

def check1
  flag = $game_party.actors[0].name
  if flag == &quot;ImPsw&quot;
    $game_variables[2] = 100
  else
    $game_variables[2] = 0
  end
end
</code></pre>
<p>密钥也有了，delta的值，是</p>
<pre><code>0x1919810 | ((0 + 1) * 0xf0000000))
</code></pre>
<p>$delta的值是0，那么就可以写脚本解密了</p>
<pre><code class="language-python">from ctypes import *
import libnum


def MX(z, y, sum1, k, p, e):
    return c_uint32(((z.value &gt;&gt; 5 ^ y.value &lt;&lt; 2) + (y.value &gt;&gt; 3 ^ z.value &lt;&lt; 4)) ^ (
            (sum1.value ^ y.value) + (k[(p &amp; 3) ^ e.value] ^ z.value)))


def btea(v, k, n, delta):
    if n &gt; 1:
        sum1 = c_uint32(0)
        z = c_uint32(v[n - 1])
        rounds = 6 + 52 // n
        e = c_uint32(0)

        while rounds &gt; 0:
            sum1.value += delta
            e.value = ((sum1.value &gt;&gt; 2) &amp; 3)
            for p in range(n - 1):
                y = c_uint32(v[p + 1])
                v[p] = c_uint32(v[p] + MX(z, y, sum1, k, p, e).value).value
                z.value = v[p]

            y = c_uint32(v[0])
            v[n - 1] = c_uint32(v[n - 1] + MX(z, y, sum1, k, n - 1, e).value).value
            z.value = v[n - 1]
            rounds -= 1
    else:
        sum1 = c_uint32(0)
        n = -n
        rounds = 6 + 52 // n
        sum1.value = rounds * delta
        y = c_uint32(v[0])
        e = c_uint32(0)

        while rounds &gt; 0:
            e.value = ((sum1.value &gt;&gt; 2) &amp; 3)
            for p in range(n - 1, 0, -1):
                z = c_uint32(v[p - 1])
                v[p] = c_uint32(v[p] - MX(z, y, sum1, k, p, e).value).value
                y.value = v[p]

            z = c_uint32(v[n - 1])
            v[0] = c_uint32(v[0] - MX(z, y, sum1, k, 0, e).value).value
            y.value = v[0]
            sum1.value -= delta
            rounds -= 1

    return v


if __name__ == &#39;__main__&#39;:
    a = [0x2e, 0x15, 0x6f, 0x7d, 0xea, 0x72, 0xc0, 0x52, 0x2c, 0x1d,
         0xbf, 0x06, 0xf2, 0x43, 0x5d, 0xbb, 0x8f, 0x49, 0xde, 0x4d]
    a = [int.from_bytes(a[i:i + 4], &quot;little&quot;) for i in range(0, len(a), 4)]
    for i in range(4):
        print(hex(a[i]), end=&quot;, &quot;)
    print()
    k = [0x72, 0x70, 0x67, 0x6d, 0x61, 0x6b, 0x65, 0x72, 0x78, 0x70,
         0x5f, 0x44, 0x33, 0x43, 0x54, 0x46]
    k = [int.from_bytes(k[i:i + 4], &quot;little&quot;) for i in range(0, len(k), 4)]

    for i in range(4):
        print(hex(k[i]), end=&quot;, &quot;)
    print()

    n = len(a)
    delta = 0xf1919810
    res = btea(a, k, -n, delta)
    print(&#39;,&#39;.join(hex(x) for x in res))
    flag = &#39;&#39;
    for i in res:
        flag += (libnum.n2s(i)[::-1].decode())
    print(flag)
</code></pre>
<p><strong>d3ctf{Y0u_R_RPG_M4st3r}</strong></p>
<hr>
<h3 id="d3piano"><a href="#d3piano" class="headerlink" title="d3piano"></a>d3piano</h3><h4 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h4><p>有点可惜，比赛做的时候不够细心，导致很多错过关键性的一些细节处。赛后复现…</p>
<h4 id="二、开始"><a href="#二、开始" class="headerlink" title="二、开始"></a>二、开始</h4><p>是一个模拟钢琴的APK，但只包含了一个八度，7个白键5个黑键。Java层只有APK启动页面的琴键绘制的逻辑，check逻辑都在so层<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603193408723.png" alt="image-20250603193408723"></p>
<p>然后每个键所对应的琴音，根据so层的<strong>keysoundnames</strong>数组的内容来加载琴音资源<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603193635847.png" alt="image-20250603193635847"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603193723987.png" alt="image-20250603193723987"></p>
<p>但是点击的逻辑，不知道什么原因，我的jadx反编译不正常，但是使用jeb就好了<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603193833394.png" alt="image-20250603193833394"></p>
<p>完整代码</p>
<pre><code class="language-Java">@Override  // android.view.View
    public boolean onTouchEvent(MotionEvent event) &#123;
        Intrinsics.checkNotNullParameter(event, &quot;event&quot;);
        int v = event.getActionMasked();
        float f = event.getX();
        float f1 = event.getY();
        switch(v) &#123;
            case 0: 
            case 5: &#123;
                int v2 = this.keyPaths.size();
                for(int i = 0; i &lt; v2; ++i) &#123;
                    Region region = new Region();
                    RectF rectF = new RectF();
                    ((Path)this.keyPaths.get(i)).computeBounds(rectF, true);
                    region.setPath(((Path)this.keyPaths.get(i)), new Region(((int)rectF.left), ((int)rectF.top), ((int)rectF.right), ((int)rectF.bottom)));
                    if(region.contains(((int)f), ((int)f1))) &#123;
                        this.pressedKeys.add(Integer.valueOf(i));
                        SoundPool soundPool0 = this.soundPool;
                        if(soundPool0 != null) &#123;
                            soundPool0.play(((Number)this.keySounds.get(i)).intValue(), 1.0f, 1.0f, 1, 0, 1.0f);
                        &#125;

                        if(this.check(i)) &#123;
                            String s = this.getflag();
                            Toast.makeText(this.Mycontext, &quot;Congratulations, this is music exclusive to Flag&quot;, 0).show();
                            Log.i(&quot;D3CTF_FLAG&quot;, s);
                        &#125;

                        this.invalidate();
                        return true;
                    &#125;
                &#125;

                return true;
            &#125;
            case 1: 
            case 6: &#123;
                int v4 = this.keyPaths.size();
                break;
            &#125;
            default: &#123;
                return true;
            &#125;
        &#125;

        for(int i = 0; i &lt; v4; ++i) &#123;
            Region region = new Region();
            RectF rectF = new RectF();
            ((Path)this.keyPaths.get(i)).computeBounds(rectF, true);
            region.setPath(((Path)this.keyPaths.get(i)), new Region(((int)rectF.left), ((int)rectF.top), ((int)rectF.right), ((int)rectF.bottom)));
            if(region.contains(((int)f), ((int)f1))) &#123;
                this.pressedKeys.remove(Integer.valueOf(i));
                this.invalidate();
                return true;
            &#125;
        &#125;

        return true;
    &#125;
</code></pre>
<p>获取当前点击位置，判断属于哪个琴键，切换琴键，然后发出声音。如果是0号白键就使用keySound[0]，而keySound[0]的音调由keysoundnames数组决定，比如keysoundname[0] &#x3D;&#x3D; ‘C’，则0号白键就发出”C”的音调。，每次按下都会将琴键的序号传给so层的check函数进行判断，如果返回true就执行getflag的逻辑，然后log出flag。</p>
<p>接下来分析so层，从Java层分析得知apk只加载了一个libD3Piano.so。</p>
<p>先看<strong>JNI_OnLoad</strong>函数，由于ida对一些结构体无法识别，手动修复一下<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603194633065.png" alt="image-20250603194633065"></p>
<p>很显然，check方法是动态注册的<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603194714070.png" alt="image-20250603194714070"></p>
<p>跟进分析</p>
<pre><code class="language-c++">__int64 sub_29BD4()
&#123;
  __int64 v0; // x0
  size_t n; // x0
  int i; // [xsp+40h] [xbp-480h]
  unsigned __int8 v4; // [xsp+5Ch] [xbp-464h]
  _BYTE result1[16]; // [xsp+80h] [xbp-440h] BYREF
  char result2[16]; // [xsp+90h] [xbp-430h] BYREF
  char resul3[1048]; // [xsp+A0h] [xbp-420h] BYREF
  __int64 v8; // [xsp+4B8h] [xbp-8h]

  v8 = *(_ReadStatusReg(TPIDR_EL0) + 40);
  memset(resul3, 0, sizeof(resul3));
  sub_29DB0(&amp;input_str);
  if ( getlength(&amp;input_str) != 42 )
    goto LABEL_7;
  __gmpz_inits();
  WHAT(&amp;input_str);
  __gmpz_set_str(result1, v0, 12);              // 十二进制转十进制
  sub_29B44(result2, result1);                  // RSA
  __gmpz_get_str(resul3, 16, result2);
  for ( i = 0; i &lt; __strlen_chk(resul3, 0x418u); ++i )
    resul3[i] = encrypt(resul3[i]);             // 还进行一个针对除大写字母以外的其他字符处理
  n = __strlen_chk(resul3, 0x418u);
  if ( !memcmp(resul3, aC901acacbb426c, n) )    // &quot;c901acacbb426c9c447acda82513965ccc3faf6c9dc58d24ed34b62c7fb1548f9ad06b9355c7d20704cfdfdfc89a3f893801e31719564683fdc7de26d807ed27f898edb3efd51b6e8e2a192d6a0929554342adfed541cd8399da0fbacfeaa5b608b887fd74f4f0e31f9bb5816c54163b8e46d27553798233bef6eaf848c64e&quot;
  &#123;
    __android_log_print(4, &quot;D3PianoLog&quot;, &quot;YOooou are Right??!&quot;);
    v4 = 1;
  &#125;
  else
  &#123;
LABEL_7:
    v4 = 0;
  &#125;
  _ReadStatusReg(TPIDR_EL0);
  return v4;
&#125;
</code></pre>
<p>根据具体逻辑的分析，对函数进行了一些重命名和注释</p>
<p>跟进RSA加密函数</p>
<pre><code class="language-c++">__int64 __fastcall RSA_part(__int64 a1, __int64 a2, __int64 a3)
&#123;
  __int64 result; // x0
  int v4; // [xsp+3Ch] [xbp-84h]
  int n11; // [xsp+44h] [xbp-7Ch]
  unsigned int v6; // [xsp+48h] [xbp-78h]
  _BYTE v10[32]; // [xsp+68h] [xbp-58h] BYREF
  _BYTE v11[16]; // [xsp+88h] [xbp-38h] BYREF
  _BYTE v12[16]; // [xsp+98h] [xbp-28h] BYREF
  _BYTE v13[16]; // [xsp+A8h] [xbp-18h] BYREF
  __int64 v14; // [xsp+B8h] [xbp-8h]

  v14 = *(_ReadStatusReg(TPIDR_EL0) + 40);
  v6 = 0;
  srand(0x221221u);                             // 伪随机
  for ( n11 = 0; n11 &lt;= 11; ++n11 )
  &#123;
    v4 = *(key + 4LL * n11);
    v6 += v4 * rand();
  &#125;
  __gmpz_inits();
  __gmp_randinit_mt();
  __gmp_randseed_ui(v10, v6);
  sub_29940(v13, v10, 512);
  sub_29940(v12, v10, 512);
  __gmpz_mul(a1, v13, v12);
  __gmpz_sub_ui(v13);
  __gmpz_sub_ui(v12);
  __gmpz_mul(v11, v13, v12);
  __gmpz_set_ui(a2, 65537);
  __gmpz_invert(a3, a2, v11);
  __gmpz_clears(v13, v12, v11, 0);
  result = __gmp_randclear(v10);
  _ReadStatusReg(TPIDR_EL0);
  return result;
&#125;
</code></pre>
<p>for循环中有一个数组，交叉引用后发现是在<strong>Java_com_d3ctf2025_D3piano_PianoLayout_getkeysoundnames</strong>中进行初始化的，也就是琴键的琴音的索引组成的数组，然后根据index生成soundnames数组<br>对部分数组进行重命名</p>
<pre><code class="language-c++">__int64 __fastcall Java_com_d3ctf2025_D3piano_PianoLayout_getkeysoundnames(JNIEnv *a1, __int64 a2, signed int a3)
&#123;
  __int64 v4; // [xsp+10h] [xbp-50h]
  signed int i; // [xsp+1Ch] [xbp-44h]
  __int64 v6; // [xsp+20h] [xbp-40h]
  jclass Class_w; // [xsp+28h] [xbp-38h]
  __int64 v10; // [xsp+48h] [xbp-18h]
  _BYTE v11[4]; // [xsp+54h] [xbp-Ch] BYREF
  __int64 v12; // [xsp+58h] [xbp-8h]

  v12 = *(_ReadStatusReg(TPIDR_EL0) + 40);
  keysoundindex = getkeysoundindex(a3);
  Class_w = FindClass_w(a1, &quot;java/lang/String&quot;);
  if ( Class_w )
  &#123;
    v6 = sub_293D4(a1, a3, Class_w, 0);
    if ( v6 )
    &#123;
      for ( i = 0; i &lt; a3; ++i )
      &#123;
        v11[0] = aCdefgabdegab[*(keysoundindex + 4LL * i)];
        v11[1] = 0;
        v4 = sub_29418(a1, v11);
        if ( !v4 )
        &#123;
          v10 = 0;
          goto LABEL_11;
        &#125;
        sub_2944C(a1, v6, i, v4);
        sub_29490(a1, v4);
      &#125;
      v10 = v6;
    &#125;
    else
    &#123;
      v10 = 0;
    &#125;
  &#125;
  else
  &#123;
    v10 = 0;
  &#125;
LABEL_11:
  _ReadStatusReg(TPIDR_EL0);
  return v10;
&#125;
</code></pre>
<p>再跟进分析<strong>getkeysoundindex</strong>函数，</p>
<pre><code class="language-c++">std::chrono::system_clock *__fastcall getkeysoundindex(int a1)
&#123;
  unsigned __int64 v1; // x0
  std::chrono::system_clock *v2; // x0
  int j; // [xsp+3Ch] [xbp-74h]
  __int64 v5; // [xsp+40h] [xbp-70h]
  __int64 v6; // [xsp+48h] [xbp-68h]
  unsigned int v7; // [xsp+54h] [xbp-5Ch]
  int i; // [xsp+58h] [xbp-58h]
  std::chrono::system_clock *v9; // [xsp+68h] [xbp-48h]
  char v11[8]; // [xsp+78h] [xbp-38h] BYREF
  __int64 v12; // [xsp+80h] [xbp-30h] BYREF
  __int64 v13; // [xsp+88h] [xbp-28h] BYREF
  _QWORD v14[4]; // [xsp+90h] [xbp-20h] BYREF

  v14[3] = *(_ReadStatusReg(TPIDR_EL0) + 40);
  sub_294C4(v14, a1);
  if ( a1 &gt;&gt; 62 )
    v1 = -1;
  else
    v1 = 4LL * a1;
  v2 = operator new[](v1);
  v9 = v2;
  for ( i = 0; i &lt; a1; ++i )
  &#123;
    v2 = sub_295E4(v14, i);
    *v2 = i;
  &#125;
  v12 = std::chrono::system_clock::now(v2);
  v13 = sub_29608(&amp;v12);
  v7 = sub_29660(&amp;v13);
  sub_29678(v11, v7);
  v6 = sub_29718(v14);
  v5 = sub_29748(v14);
  sub_296A4(v6, v5, v11);
  for ( j = 0; j &lt; a1; ++j )
    *(v9 + j) = *sub_295E4(v14, j);
  sub_29778(v14);
  _ReadStatusReg(TPIDR_EL0);
  return v9;
&#125;
</code></pre>
<p>静态分析的时候，结合ai的分析结果，误以为是打乱随机的，没有把注意具体点击的时候发出的声音，其实根本没有打乱，琴键的音调是完全正确的。这里的生成乱序keysoundindex没有生效，<strong>keysoundindex</strong>就是0-11的顺序…(比赛的时候通过Frida hook的时候确实发现每个琴键所对应的index是固定的，但是没注意每个index和每个音调也是一一对应的)</p>
<p>动态注册的check函数里使用的GMP大数库，看官方wp说很多函数的符号ida分析错误，但貌似影响也不大。check函数的逻辑就是把琴键的index拼接成一个12进制的字符串然后作为大数值，完了进行加密，再转换成十六进制字符串，进行比较。</p>
<p>比赛的时候一直以为keysoundindex是随机的，所以RSA一直解不出来…</p>
<p>官方wp中的解密脚本</p>
<pre><code class="language-python">from Crypto.Util.number import long_to_bytes
p = 0xcd88775691357147eea5dc584718edab9ca314cdd52a8c1cf847dbbb8371798f15e9bdca2bfaa4595d47eecae21bea38691a26e1c707867b5ea2f6f2f03bf4c+1
q = 0x565c0138487b57e4b76d0924163f67facb17a77f83e354cc3c8432879dab4611c2442cdd73f71c9e6cb4e56a7c45a403148e6d558f986ec6505882ae095c34d2+1
d = 0x2e4f4254c529f4ef40d28a6595e60bb28b1d11ab13328000fb63cf77836a423259af8a8881d73e1868cd66bbd78920f38033f9f1e0e406b82f0aee50fdbe2567e0ac329e80e9abbb7075f4711157844e9fcb666200b1c4ef05b3cc66278221c9e6bd7250caf2be2a3793cf1f2dd43918d6ead0ee851eccf43e48750b6fab2f9
e = 65537
c = 0xc901acacbb426c9c447acda82513965ccc3faf6c9dc58d24ed34b62c7fb1548f9ad06b9355c7d20704cfdfdfc89a3f893801e31719564683fdc7de26d807ed27f898edb3efd51b6e8e2a192d6a0929554342adfed541cd8399da0fbacfeaa5b608b887fd74f4f0e31f9bb5816c54163b8e46d27553798233bef6eaf848c64e
n = p * q
mm = pow(c,e,n)
print(&quot;解密后的flag（字符串）:&quot;, long_to_bytes(mm).decode())
</code></pre>
<p>确实，如同check函数中的log提示，这是fake flag。</p>
<p>回顾前面的分析过程，getkeysoundindex并没有生成打乱的0-11，并且在尝试调试或者frida hook的时候发现有检测，想hook只能通过附加进程调试，但是在这个so文件里并没有看到很明显的检测逻辑，同时lib目录里还有一个so文件，并且是可以在libD3Piano.so中验证另一个so文件的可疑点<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603201006676.png" alt="image-20250603201006676"></p>
<p>libD3Piano.so链接了另外的两个库，但是很明显使用了libgmp.so，没有使用另一个所以 这个libMediaPlayer.so肯定在 init_array里面藏了东西。因为在链接时会调用 init_array 的内容。<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603201326760.png" alt="image-20250603201326760"></p>
<p>这其中可疑的函数只有<strong>sub_8938CC()</strong><br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603201354366.png" alt="image-20250603201354366"></p>
<p>初始化了三个信号量，创建了四个线程，每个线程都执行不同的函数</p>
<ul>
<li>从 unk_BBBF04 到 unk_BBBF34，每间隔 16 字节初始化一个信号量（sem_init），初值为 0。</li>
<li>4 个线程，每个线程执行的函数来自 <code>off_BBAD20</code> 表中的函数指针（共 4 个）。</li>
</ul>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603202622501.png" alt="image-20250603202622501"></p>
<p>依次进行分析<br>fun1是Frida检测的逻辑</p>
<pre><code class="language-c++">__int64 fun1()
&#123;
  __int64 v0; // x0
  __int64 *v2; // [xsp+48h] [xbp-388h]
  __int64 *i; // [xsp+D0h] [xbp-300h]
  __int64 v4; // [xsp+E0h] [xbp-2F0h]
  _QWORD v5[3]; // [xsp+118h] [xbp-2B8h] BYREF
  _QWORD v6[3]; // [xsp+130h] [xbp-2A0h] BYREF
  _BYTE v7[16]; // [xsp+148h] [xbp-288h] BYREF
  _QWORD v8[2]; // [xsp+158h] [xbp-278h] BYREF
  _BYTE v9[16]; // [xsp+168h] [xbp-268h] BYREF
  _QWORD v10[2]; // [xsp+178h] [xbp-258h] BYREF
  _BYTE v11[16]; // [xsp+188h] [xbp-248h] BYREF
  _BYTE v12[24]; // [xsp+198h] [xbp-238h] BYREF
  _BYTE v13[24]; // [xsp+1B0h] [xbp-220h] BYREF
  _BYTE v14[24]; // [xsp+1C8h] [xbp-208h] BYREF
  _BYTE v15[344]; // [xsp+1E0h] [xbp-1F0h] BYREF
  _BYTE v16[144]; // [xsp+338h] [xbp-98h] BYREF
  __int64 v17; // [xsp+3C8h] [xbp-8h] BYREF

  v17 = *(_QWORD *)(_ReadStatusReg(TPIDR_EL0) + 40);
  sub_892D64(v14, &quot;/proc/self/task&quot;, 0);
  sub_892DC8(v13);
  sub_892DEC(v12);
  sub_892E68();
  sub_892E68();
  sub_892E68();
  sub_892E68();
  sub_892E68();
  sub_892E68();
  sub_892EEC(v11, v14);
  sub_892F50();
  sub_892F20(v10, v9);
  sub_892F7C(v9);
  sub_892F50();
  sub_892FA0(v8, v7);
  sub_892F7C(v7);
  while ( (sub_892FC8(v10, v8) &amp; 1) != 0 )
  &#123;
    v4 = sub_892FFC(v10);
    v0 = sub_893060(v4);
    sub_893074(v5, v0);
    sub_893020(v6, v5, &quot;/comm&quot;);
    sub_8930AC();
    sub_9E4E94(v6);
    sub_9E4E94(v5);
    sub_8930E0(v15, v13, 24);
    if ( (sub_893124(v15) &amp; 1) != 0 )
    &#123;
      sub_893150(v15, v12);
      for ( i = (__int64 *)v16; i != &amp;v17; i += 3 )
      &#123;
        if ( sub_8931A8(v12, i, 0) != -1 )
        &#123;
          _ReadStatusReg(TPIDR_EL0);
          exit(0);
        &#125;
      &#125;
    &#125;
    sub_893220(v15);
    sub_89325C(v10);
  &#125;
  sub_892F7C(v8);
  sub_892F7C(v10);
  sub_892F7C(v11);
  sleep(5u);
  v2 = &amp;v17;
  do
  &#123;
    sub_9E4E94(v2 - 3);
    v2 -= 3;
  &#125;
  while ( v2 != (__int64 *)v16 );
  sub_9E4E94(v12);
  sub_893284(v13);
  sub_893284(v14);
  _ReadStatusReg(TPIDR_EL0);
  return 0;
&#125;
</code></pre>
<p>通过检测线程名称来检测是否处于调试&#x2F;hook状态。检测到就直接exit退出，绕过检测直接nop掉exit函数。</p>
<p>剩下三个fun涉及到了信号量。执行顺序为fun3 -&gt; fun2 -&gt;fun4</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603203312384.png" alt="image-20250603203312384"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603203324671.png" alt="image-20250603203324671"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603203332915.png" alt="image-20250603203332915"></p>
<p>从fun3开始分析。</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603203937195.png" alt="image-20250603203937195"></p>
<p>并且官方wp中还进行了如何进行hook的补充。<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603204448926.png" alt="image-20250603204448926"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603204709478.png" alt="image-20250603204709478"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603204950110.png" alt="image-20250603204950110"></p>
<p>也可以进入**sub_893630()**函数里找一下，就是进去的第一个结构体。<br>func3→MyListener1、func2→MyListener2、func4→MyListener3。</p>
<p>func3 函数hook函数sub291B4。修改了返回值，然后func2运行。sub_896A28就是on_enter，sub_896A3C就是on_leave</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603205457465.png" alt="image-20250603205457465"></p>
<p>fun2 hook了基地址+0x29BD4地址的函数，就是check函数<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603205621847.png" alt="image-20250603205621847"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603205838316.png" alt="image-20250603205838316"></p>
<pre><code class="language-c++">__int64 __fastcall fun2_on_enter(__int64 a1, __int64 a2)
&#123;
  _BYTE *v2; // x0
  unsigned __int8 *v3; // x0
  __int64 v4; // x0
  size_t n; // x0
  __int64 result; // x0
  char v7; // [xsp+14h] [xbp-ACh]
  int n90_1; // [xsp+28h] [xbp-98h]
  int n90; // [xsp+2Ch] [xbp-94h]
  __int64 v12; // [xsp+30h] [xbp-90h]
  int n11; // [xsp+4Ch] [xbp-74h] BYREF
  _OWORD s2_[6]; // [xsp+50h] [xbp-70h] BYREF
  int v15; // [xsp+B0h] [xbp-10h]
  __int64 v16; // [xsp+B8h] [xbp-8h]

  v16 = *(_ReadStatusReg(TPIDR_EL0) + 40);
  v12 = (*(*a2 + 24LL))(a2, 2);
  v15 = 0;
  memset(s2_, 0, sizeof(s2_));
  if ( sub_897580(a1 + 8) &lt; 0x5B )              // 检测长度
  &#123;
    result = sub_897630(a1 + 8, &amp;aCdefgabdegab[v12]);// &quot;CDEFGABdegab&quot;
  &#125;
  else
  &#123;
    for ( n90 = 0; n90 &lt;= 90; ++n90 )           // 长度大于90，先异或
    &#123;
      v7 = byte_BBACC2[n90];
      v2 = sub_8975A0(a1 + 8, n90);
      *v2 ^= v7;
    &#125;
    for ( n90_1 = 0; n90_1 &lt;= 90; ++n90_1 )     // 然后根据异或后的字符串，获取到对应的音调的下标保存到_obj
    &#123;
      for ( n11 = 0; n11 &lt;= 11; ++n11 )
      &#123;
        v3 = sub_8975A0(a1 + 8, n90_1);
        if ( *v3 == aCdefgabdegab[n11] )        // &quot;CDEFGABdegab&quot;
          sub_8975C4(&amp;obj_, &amp;n11);
      &#125;
    &#125;
    (*(*a1 + 32LL))(a1);                        // 调用虚表函数1
    v4 = sub_897580(a1 + 8);
    (*(*a1 + 40LL))(a1, s2_, v4, a1 + 32, aCdefgabdegab, 2232865);// 调用虚表函数2
    n = sub_897580(a1 + 8);
    result = memcmp(&amp;s1_, s2_, n);              // cmp
    if ( !result )
      byte_BBBF00 = 1;
  &#125;
  _ReadStatusReg(TPIDR_EL0);
  return result;
&#125;
</code></pre>
<p>on_leave修改返回值<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603210355580.png" alt="image-20250603210355580"></p>
<p>在func2 attach上函数后，func4执行。func4 hook 偏移0x28E80，也就是get_flag 函数的tostr。<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603210458277.png" alt="image-20250603210458277"></p>
<p>其实就是把func2_on_enter函数里面根据异或加密后的音调在转换成12进制数，丢 给tostr。</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603210700057.png" alt="image-20250603210700057"></p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603210717852.png" alt="image-20250603210717852"></p>
<p>那么现在就需要分析两个虚表函数加密，然后写出解密获取到输入的音调数组转换成 12 进制再转换成字符串输出就可以。那么来分析 enc1 与 enc2，enc1 函数有点抽象， 先分析enc2函数。很明显的salsa20加密。<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603210808508.png" alt="image-20250603210808508"></p>
<p>可以尝试先解密enc2函数，key是类成员，找到类的构造函数。<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603211101417.png" alt="image-20250603211101417"></p>
<p>这就是key，被加密了，解密一下。<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603211427066.png" alt="image-20250603211427066"></p>
<pre><code class="language-python"># 模拟 .rodata 段中的两个 xmmword 数据（共32字节）
xmmword_252578 = [
    0x88, 0x9A, 0x93, 0xBC, 0x90, 0xB2, 0xBA, 0xA0, 0xC8,
    0xCF, 0xA0, 0xBB, 0xCC, 0x9C, 0xC8, 0xB9
]
xmmword_252588 = [
    0xA0, 0xCD, 0xCF, 0xCD, 0xCA, 0xD2, 0x8D, 0xCC, 0xA9,
    0xBA, 0xAD, 0xAC, 0xBA, 0xDE, 0xDE, 0xDE
]

# 拼接两个 xmmword 成为 32 字节原始数据
combined = xmmword_252578 + xmmword_252588

# 对这 32 字节做按位取反（模仿 ~data 的行为）
inverted = [~b &amp; 0xFF for b in combined]

# 模拟 a1：前32字节占位，后32字节是结果
a1 = [0] * 32 + inverted

# 打印可见字符
for byte in a1:
    if 0x20 &lt;= byte &lt;= 0x7E:
        print(chr(byte), end=&#39;&#39;)

print()
</code></pre>
<p>key： <strong>welCoME_70_D3c7F_2025-r3VERSE!!!</strong></p>
<p>解密代码</p>
<pre><code class="language-c++">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;format&gt;
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;cstdint&gt;
#include &lt;vector&gt;

#define ROTL(a, b) ((((uint32_t)(a)) &lt;&lt; ((uint32_t)(b))) | (((uint32_t)(a)) &gt;&gt; (32 - ((uint32_t)(b)))))
#define QUARTERROUND(a, b, c, d) \
    a += b;                      \
    d ^= a;                      \
    d = ROTL(d, 16);             \
    c += d;                      \
    b ^= c;                      \
    b = ROTL(b, 12);             \
    a += b;                      \
    d ^= a;                      \
    d = ROTL(d, 8);              \
    c += d;                      \
    b ^= c;                      \
    b = ROTL(b, 7);

unsigned char flag_enc[74] = &#123;
    0x2E, 0xD2, 0xDF, 0x53, 0x41, 0xE6, 0x51, 0xA2, 0xD0, 0x8E,
    0x43, 0x59, 0x6F, 0xC4, 0x15, 0xAD,
    0x97, 0xC2, 0x98, 0xBD, 0x11, 0x05, 0xFE, 0xFF, 0x96, 0x4C,
    0xE8, 0x06, 0x50, 0x0E, 0x1D, 0xCA,
    0x0E, 0xB2, 0x18, 0xCA, 0x06, 0x54, 0x2E, 0xFA, 0xCD, 0x19,
    0xD2, 0x9E, 0xDB, 0x9E, 0x33, 0xCC,
    0x5D, 0xAF, 0xED, 0x69, 0x4A, 0xEF, 0x17, 0xB8, 0xD8, 0x40,
    0x14, 0x48, 0xCD, 0x37, 0xFC, 0xD0,
    0x14, 0x5C, 0x3C, 0x31, 0xC9, 0x15, 0xE6, 0xCF, 0x77, 0x28
&#125;;

void salsa20_core(uint32_t out[16], const uint32_t in[16]) &#123;
    uint32_t x[16];
    int i;

    for (i = 0; i &lt; 16; ++i) &#123;
        x[i] = in[i];
    &#125;

    for (i = 0; i &lt; 10; ++i) &#123;
        // 列轮
        QUARTERROUND(x[0], x[4], x[8], x[12])
        QUARTERROUND(x[5], x[9], x[13], x[1])
        QUARTERROUND(x[10], x[14], x[2], x[6])
        QUARTERROUND(x[15], x[3], x[7], x[11])

        // 行轮
        QUARTERROUND(x[0], x[1], x[2], x[3])
        QUARTERROUND(x[5], x[6], x[7], x[4])
        QUARTERROUND(x[10], x[11], x[8], x[9])
        QUARTERROUND(x[15], x[12], x[13], x[14])
    &#125;

    for (i = 0; i &lt; 16; ++i) &#123;
        out[i] = x[i] + in[i];
    &#125;
&#125;

void salsa20_encrypt(uint8_t *ciphertext, size_t length, const uint8_t *key, const uint8_t *nonce, uint64_t counter) &#123;
    uint32_t state[16];
    uint32_t block[16];
    size_t i, j;
    uint8_t *keystream = (uint8_t *)block;
    uint8_t *plaintext = (uint8_t *)malloc(74);

    for (int n = 0; n &lt; 74; n++) &#123;
        plaintext[n] = flag_enc[n];
    &#125;

    // 初始化状态
    state[0] = 0x61707865;
    state[1] = *(uint32_t *)&amp;key[0];
    state[2] = *(uint32_t *)&amp;key[4];
    state[3] = *(uint32_t *)&amp;key[8];
    state[4] = *(uint32_t *)&amp;key[12];
    state[5] = 0x3320646e;
    state[6] = *(uint32_t *)&amp;nonce[0];
    state[7] = *(uint32_t *)&amp;nonce[4];
    state[8] = (uint32_t)(counter &amp; 0xFFFFFFFF);
    state[9] = (uint32_t)(counter &gt;&gt; 32);
    state[10] = 0x79622d32;
    state[11] = *(uint32_t *)&amp;key[16];
    state[12] = *(uint32_t *)&amp;key[20];
    state[13] = *(uint32_t *)&amp;key[24];
    state[14] = *(uint32_t *)&amp;key[28];
    state[15] = 0x6b206574;

    for (i = 0; i &lt; length; i += 64) &#123;
        salsa20_core(block, state);
        for (j = 0; j &lt; 64 &amp;&amp; i + j &lt; length; ++j) &#123;
            ciphertext[i + j] = plaintext[i + j] ^ keystream[j];
        &#125;
        // 更新计数器
        if (++state[8] == 0) &#123;
            ++state[9];
        &#125;
    &#125;
&#125;

int main() &#123;
    uint8_t key[] = &quot;welCoME_70_D3c7F_2025-r3VERSE!!!&quot;;
    uint8_t nonce[] = &quot;CDEFGABdegab&quot;;
    uint64_t counter = (uint64_t)0x221221;
    uint8_t ciphertext[74];

    salsa20_encrypt(ciphertext, sizeof(flag_enc), key, nonce, counter);

    for (int i = sizeof(flag_enc) - sizeof(ciphertext); i &lt; sizeof(flag_enc); i++) &#123;
        printf(&quot;%c&quot;, ciphertext[i]);
    &#125;

    return 0;
&#125;
</code></pre>
<p>后面的题解参考官方wp</p>
<p><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603212432087.png" alt="image-20250603212432087"></p>
<pre><code class="language-c++">void LZW_decode(std::vector&lt;uint8_t&gt; &amp;compressed)
&#123;
    std::unordered_map&lt;int, std::vector&lt;uint8_t&gt;&gt; dictionary;
    for (int i = 0; i &lt; 256; ++i)
    &#123;
        dictionary[i] = &#123;static_cast&lt;uint8_t&gt;(i)&#125;;
    &#125;

    std::vector&lt;uint8_t&gt; codes;
    for (uint8_t byte : compressed)
    &#123;
        codes.push_back(static_cast&lt;int&gt;(byte));
    &#125;

    std::vector&lt;uint8_t&gt; result;
    uint8_t next_code = 0;

    if (codes.empty())
        return;

    uint8_t prev_code = codes[0];
    result.insert(result.end(), dictionary[prev_code].begin(), dictionary[prev_code].end());

    for (size_t i = 1; i &lt; codes.size(); ++i)
    &#123;
        uint8_t curr_code = codes[i];
        std::vector&lt;uint8_t&gt; entry;

        if (curr_code == next_code)
        &#123;
            entry = dictionary[prev_code];
            entry.push_back(dictionary[prev_code][0]);
        &#125;
        else if (dictionary.count(curr_code))
        &#123;
            entry = dictionary[curr_code];
        &#125;
        else
        &#123;
            std::cerr &lt;&lt; &quot;Error: Invalid code &quot; &lt;&lt; curr_code &lt;&lt; std::endl;
            return;
        &#125;

        result.insert(result.end(), entry.begin(), entry.end());

        std::vector&lt;uint8_t&gt; new_entry = dictionary[prev_code];
        new_entry.push_back(entry[0]);
        dictionary[next_code++] = new_entry;

        prev_code = curr_code;
    &#125;

    std::string decoded_string(result.begin(), result.end());
    std::cout &lt;&lt; decoded_string &lt;&lt; std::endl;
&#125;

int main()
&#123;
    uint8_t key[] = &quot;welCoME_70_D3c7F_2025-r3VERSE!!!&quot;;
    uint8_t nonce[] = &quot;CDEFGABdegab&quot;;
    uint64_t counter = (uint64_t)0x221221;
    uint8_t ciphertext[74];

    salsa20_encrypt(ciphertext, sizeof(flag_enc), key, nonce, counter);

    std::vector&lt;uint8_t&gt; inputkeysname;

    for (int i = 0; i &lt; sizeof(ciphertext); i++)
    &#123;
        inputkeysname.push_back(ciphertext[i]);
    &#125;

    LZW_decode(inputkeysname);
    return 0;
&#125;
</code></pre>
<p>得到：</p>
<p><strong>bEbAACEBCGGGBdBECECbdaECCGGBAaAaedBEeDdGAdDaBgededFFBFeEaFGdFEbAFEAF gdgDBDBgeggbAeFagaEedbA</strong></p>
<pre><code class="language-python">from Crypto.Util.number import long_to_bytes

enc = &quot;bEbAACEBCGGGBdBECECbdaECCGGBAaAaedBEeDdGAdDaBgededFFBFeEaFGdFEbAFEAFgdgDBDBgeggbAeFagaEedbA&quot;
keys = &quot;CDEFGABdegab&quot;
twelve = &quot;0123456789AB&quot;
tmp = &quot;&quot;

for i in enc:
    tmp += twelve[keys.index(i)]

tmp = int(tmp, 12)
print(long_to_bytes(tmp).decode())
</code></pre>
<p><strong>d3ctf{Fly1ng_Pi@n0_Key$_play_4_6e@utiful~melody}</strong></p>
<h4 id="三、结语"><a href="#三、结语" class="headerlink" title="三、结语"></a>三、结语</h4><p>好题，但感觉像像套着apk的PC题<br><img src="https://nshide.oss-cn-hangzhou.aliyuncs.com/img_temp/image-20250603213245716.png" alt="image-20250603213245716"></p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>一次蛮不错体验的比赛，就是比赛时间不太友好(端午假期+周五晚八点-周六晚九点[因开赛时平台卡顿延迟了一小时])。其他题目就没复现啦，详见<a target="_blank" rel="noopener" href="https://github.com/D-3CTF/D3CTF-2025-Official-Writeup">https://github.com/D-3CTF/D3CTF-2025-Official-Writeup</a></p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 1621925986@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">💰</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23lif2sndX4YqUPQwk',
            clientSecret: 'c76a4c487d51bf36e4dd1496b3f44bdbea037d50',
            repo: 'NshIdE1.github.io',
            owner: 'NshIdE1',
            admin: ['NshIdE1'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2024-2025 NshIdE
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
